!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).eSheet=t()}(this,(function(){"use strict";function e(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,l)}return o}function t(t){for(var o=1;o<arguments.length;o++){var l=null!=arguments[o]?arguments[o]:{};o%2?e(Object(l),!0).forEach((function(e){i(t,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):e(Object(l)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(l,e))}))}return t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,f(l.key),l)}}function n(e,t,o){return t&&l(e.prototype,t),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t,o){return(t=f(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function h(e,t,o){return h=c()?Reflect.construct.bind():function(e,t,o){var l=[null];l.push.apply(l,t);var n=new(Function.bind.apply(e,l));return o&&a(n,o.prototype),n},h.apply(null,arguments)}function d(e){var t="function"==typeof Map?new Map:void 0;return d=function(e){if(null===e||(o=e,-1===Function.toString.call(o).indexOf("[native code]")))return e;var o;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,l)}function l(){return h(e,arguments,s(this).constructor)}return l.prototype=Object.create(e.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),a(l,e)},d(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){var t=c();return function(){var o,l=s(e);if(t){var n=s(this).constructor;o=Reflect.construct(l,arguments,n)}else o=l.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,o)}}function p(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}function f(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var l=o.call(e,t||"default");if("object"!=typeof l)return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C={cell:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTkgMTd2LTVoLTJ2NWgtNXYyaDV2NWgydi01aDV2LTJoLTV6IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9Ii44OCIvPjxwYXRoIGQ9Ik0xMiAxOS41aDQuNXY1aDN2LTVoNXYtM2gtNXYtNWgtM3Y1aC01djNoLjV6IiBzdHJva2U9IiMxNzFBMUQiLz48L2c+PGRlZnM+PGZpbHRlciBpZD0iZmlsdGVyMF9kIiB4PSI4IiB5PSI5IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==","col-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxtYXNrIGlkPSJhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSI3IiB5PSI5IiB3aWR0aD0iMjIiIGhlaWdodD0iMTgiIGZpbGw9IiMwMDAiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik03IDloMjJ2MThIN3oiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE5IDEwaC0ydjdoLTR2Mmg0djdoMnYtN2g0di0yaC00di03ek05IDE4bDQtM3Y2bC00LTN6bTE4IDBsLTQgM3YtNmw0IDN6Ii8+PC9tYXNrPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTkgMTBoLTJ2N2gtNHYyaDR2N2gydi03aDR2LTJoLTR2LTd6TTkgMThsNC0zdjZsLTQtM3ptMTggMGwtNCAzdi02bDQgM3oiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMTkgMTBoMVY5aC0xdjF6bS0yIDBWOWgtMXYxaDF6bTAgN3YxaDF2LTFoLTF6bS00IDB2LTFoLTF2MWgxem0wIDJoLTF2MWgxdi0xem00IDBoMXYtMWgtMXYxem0wIDdoLTF2MWgxdi0xem0yIDB2MWgxdi0xaC0xem0wLTd2LTFoLTF2MWgxem00IDB2MWgxdi0xaC0xem0wLTJoMXYtMWgtMXYxem0tNCAwaC0xdjFoMXYtMXpNOSAxOGwtLjYtLjgtMS4wNjcuOCAxLjA2Ny44LjYtLjh6bTQtM2gxdi0ybC0xLjYgMS4yLjYuOHptMCA2bC0uNi44TDE0IDIzdi0yaC0xem0xNC0zbC42LjggMS4wNjctLjgtMS4wNjctLjgtLjYuOHptLTQgM2gtMXYybDEuNi0xLjItLjYtLjh6bTAtNmwuNi0uOEwyMiAxM3YyaDF6bS00LTZoLTJ2MmgyVjl6bS0zIDF2N2gydi03aC0yem0xIDZoLTR2Mmg0di0yem0tNSAxdjJoMnYtMmgtMnptMSAzaDR2LTJoLTR2MnptMy0xdjdoMnYtN2gtMnptMSA4aDJ2LTJoLTJ2MnptMy0xdi03aC0ydjdoMnptLTEtNmg0di0yaC00djJ6bTUtMXYtMmgtMnYyaDJ6bS0xLTNoLTR2Mmg0di0yem0tMyAxdi03aC0ydjdoMnpNOS42IDE4LjhsNC0zLTEuMi0xLjYtNCAzIDEuMiAxLjZ6TTEyIDE1djZoMnYtNmgtMnptMS42IDUuMmwtNC0zLTEuMiAxLjYgNCAzIDEuMi0xLjZ6bTEyLjgtM2wtNCAzIDEuMiAxLjYgNC0zLTEuMi0xLjZ6TTI0IDIxdi02aC0ydjZoMnptLTEuNi01LjJsNCAzIDEuMi0xLjYtNC0zLTEuMiAxLjZ6IiBmaWxsPSIjZmZmIiBtYXNrPSJ1cmwoI2EpIi8+PC9nPjxkZWZzPjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iNC4zMzMiIHk9IjciIHdpZHRoPSIyNy4zMzMiIGhlaWdodD0iMjQiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==","row-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxtYXNrIGlkPSJhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSI5IiB5PSI3IiB3aWR0aD0iMTgiIGhlaWdodD0iMjIiIGZpbGw9IiMwMDAiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik05IDdoMTh2MjJIOXoiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTI2IDE5di0yaC03di00aC0ydjRoLTd2Mmg3djRoMnYtNGg3ek0xOCA5bDMgNGgtNmwzLTR6bTAgMThsLTMtNGg2bC0zIDR6Ii8+PC9tYXNrPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjYgMTl2LTJoLTd2LTRoLTJ2NGgtN3YyaDd2NGgydi00aDd6TTE4IDlsMyA0aC02bDMtNHptMCAxOGwtMy00aDZsLTMgNHoiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMjYgMTl2MWgxdi0xaC0xem0wLTJoMXYtMWgtMXYxem0tNyAwaC0xdjFoMXYtMXptMC00aDF2LTFoLTF2MXptLTIgMHYtMWgtMXYxaDF6bTAgNHYxaDF2LTFoLTF6bS03IDB2LTFIOXYxaDF6bTAgMkg5djFoMXYtMXptNyAwaDF2LTFoLTF2MXptMCA0aC0xdjFoMXYtMXptMiAwdjFoMXYtMWgtMXptMC00di0xaC0xdjFoMXpNMTggOWwuOC0uNi0uOC0xLjA2Ny0uOCAxLjA2Ny44LjZ6bTMgNHYxaDJsLTEuMi0xLjYtLjguNnptLTYgMGwtLjgtLjZMMTMgMTRoMnYtMXptMyAxNGwtLjguNi44IDEuMDY3LjgtMS4wNjctLjgtLjZ6bS0zLTR2LTFoLTJsMS4yIDEuNi44LS42em02IDBsLjguNkwyMyAyMmgtMnYxem02LTR2LTJoLTJ2Mmgyem0tMS0zaC03djJoN3YtMnptLTYgMXYtNGgtMnY0aDJ6bS0xLTVoLTJ2Mmgydi0yem0tMyAxdjRoMnYtNGgtMnptMSAzaC03djJoN3YtMnptLTggMXYyaDJ2LTJIOXptMSAzaDd2LTJoLTd2MnptNi0xdjRoMnYtNGgtMnptMSA1aDJ2LTJoLTJ2MnptMy0xdi00aC0ydjRoMnptLTEtM2g3di0yaC03djJ6TTE3LjIgOS42bDMgNCAxLjYtMS4yLTMtNC0xLjYgMS4yek0yMSAxMmgtNnYyaDZ2LTJ6bS01LjIgMS42bDMtNC0xLjYtMS4yLTMgNCAxLjYgMS4yem0zIDEyLjhsLTMtNC0xLjYgMS4yIDMgNCAxLjYtMS4yek0xNSAyNGg2di0yaC02djJ6bTUuMi0xLjZsLTMgNCAxLjYgMS4yIDMtNC0xLjYtMS4yeiIgZmlsbD0iI2ZmZiIgbWFzaz0idXJsKCNhKSIvPjwvZz48ZGVmcz48ZmlsdGVyIGlkPSJmaWx0ZXIwX2QiIHg9IjYiIHk9IjUuMzMzIiB3aWR0aD0iMjQiIGhlaWdodD0iMjcuMzMzIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+PGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz48ZmVPZmZzZXQgZHk9IjEiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPjxmZUJsZW5kIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPjwvZmlsdGVyPjwvZGVmcz48L3N2Zz4=","s-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTcgMTl2LThoM3Y4aDNsLTQuNSA1LjVMMTQgMTloM3oiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMjMgMTguNWgtMi41di04aC00djhoLTMuNTU1bC42NjguODE3IDQuNSA1LjUuMzg3LjQ3My4zODctLjQ3MyA0LjUtNS41LjY2OC0uODE3SDIzeiIgc3Ryb2tlPSIjZmZmIi8+PC9nPjxkZWZzPjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iOC44OSIgeT0iOCIgd2lkdGg9IjE5LjIyMSIgaGVpZ2h0PSIyMi4wNzkiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==","e-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjAgMTloLTh2LTNoOHYtM2w1IDQuNS01IDQuNXYtM3oiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMTkuNSAxM3YyLjVoLTh2NGg4djMuNjIzbC44MzQtLjc1MSA1LTQuNS40MTMtLjM3Mi0uNDEzLS4zNzItNS00LjUtLjgzNC0uNzVWMTN6IiBzdHJva2U9IiNmZmYiLz48L2c+PGRlZnM+PGZpbHRlciBpZD0iZmlsdGVyMF9kIiB4PSI4IiB5PSI4Ljc1NSIgd2lkdGg9IjIxLjQ5NSIgaGVpZ2h0PSIxOS40OTEiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==",crosshair:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTggMTh2LTZoLTF2NmgtNnYxaDZ2Nmgxdi02aDZ2LTFoLTZ6IiBmaWxsPSIjMTcxQTFEIi8+PHBhdGggZD0iTTE4LjUgMTJ2LS41aC0ydjZoLTZ2Mmg2djZoMnYtNmg2di0yaC02VjEyeiIgc3Ryb2tlPSIjZmZmIi8+PC9nPjxkZWZzPjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iNyIgeT0iOSIgd2lkdGg9IjIxIiBoZWlnaHQ9IjIxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+PGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz48ZmVPZmZzZXQgZHk9IjEiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPjxmZUJsZW5kIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPjwvZmlsdGVyPjwvZGVmcz48L3N2Zz4="},v=function(){function e(t){var l=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),i(this,"canvasDom",null),i(this,"ctx",null),i(this,"cellWidth",0),i(this,"cellHeight",0),this.ctx=t.getContext("2d"),this.cellWidth=n.cellWidth,this.cellHeight=n.cellHeight,this.canvasDom=t,t.addEventListener("mousemove",(function(e){l.setCursor("cell")}))}return n(e,[{key:"setCursor",value:function(e){this.canvasDom.style.cursor="url(".concat(C[e],") 18 18, ").concat(e)}},{key:"setCursorDefault",value:function(){this.canvasDom.style.cursor="default"}},{key:"drawLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"source-over",o=arguments.length>2?arguments[2]:void 0;if(this.ctx.strokeStyle=null!=o?o:"black",this.ctx.lineWidth=1,this.ctx.globalCompositeOperation=t,this.ctx.beginPath(),e.length%2!=0)throw new Error("points is error");var l=e.length/2;this.ctx.moveTo(e[0],e[1]);for(var n=2;n<l+1;n+=2)this.ctx.lineTo(e[n],e[n+1]);this.ctx.closePath(),this.ctx.stroke()}},{key:"drawText",value:function(e,t,o,l,n,i,r){var s,a,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"center",h=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,u=this.ctx,g=this.cellWidth,p=this.cellHeight;u.globalCompositeOperation=null!=i?i:"source-over",l=null!==(s=l)&&void 0!==s?s:g,n=null!==(a=n)&&void 0!==a?a:p,u.font=h?"".concat(h.fontWeight+" ").concat(h.fontItalic+" ").concat(h.fontSize,"px ").concat(h.fontFamily):"12px Calibre",u.fillStyle=r||"black";var m=e+l/2,f=t+n/2;u.textBaseline=d||"middle",u.textAlign=c||"center";var C="";if(u.measureText(o).width>l){var v=(l/h.fontSize).toFixed(0)-1;C=o.slice(0,v-1)+"..."}else C=o;var y=0,w=0;y="left"===c?e:"right"===c?e+l:m,w="top"===d?t+2:"bottom"===d?t+n:f,u.fillText(C,y,w,l)}},{key:"clearRect",value:function(e,t,o,l){this.ctx.clearRect(e,t,o,l)}},{key:"drawStrokeRect",value:function(e,t,o,l,n,i){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;this.ctx.lineWidth=r,this.ctx.globalCompositeOperation=null!=i?i:"source-over",this.ctx.strokeStyle=null!=n?n:"black",this.ctx.strokeRect(e,t,o,l)}},{key:"drawFillRect",value:function(e,t,o,l,n,i){this.ctx.fillStyle=null!=n?n:"black",this.ctx.globalCompositeOperation=null!=i?i:"source-over",this.ctx.fillRect(e,t,o,l)}},{key:"drawDashStrokeRect",value:function(e,t,o,l,n,i){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;this.ctx.lineWidth=r,this.ctx.globalCompositeOperation=null!=i?i:"source-over",this.ctx.strokeStyle=null!=n?n:"black",this.ctx.setLineDash([5,5]),this.ctx.strokeRect(e,t,o,l),this.ctx.setLineDash([])}},{key:"drawTriangleRect",value:function(e,t,o,l){this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.x,t.y),this.ctx.lineTo(o.x,o.y),this.ctx.closePath(),this.ctx.fillStyle=null!=l?l:"black",this.ctx.fill()}}]),e}();function y(e){return e>26?e%26==0?String.fromCharCode(64+parseInt((Math.floor(e/26)-1).toFixed(0)))+String.fromCharCode(90):String.fromCharCode(64+parseInt(Math.floor(e/26).toFixed(0)))+String.fromCharCode(64+e%26):String.fromCharCode(64+e)}var w=function(){function e(t){var l=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};o(this,e),i(this,"mulPersonSelected",[]),i(this,"userId",(new Date).valueOf()),i(this,"userName",(new Date).valueOf().toString()),i(this,"userColor",this.getRandomColor()),i(this,"stepCallbackArr",[]),i(this,"scale",1),i(this,"ws",void 0),i(this,"fontSize",12),i(this,"workBook",{}),i(this,"eSheetWorkBook",[]),i(this,"row",60),i(this,"col",26),i(this,"cellWidth",120),i(this,"cellHeight",40),i(this,"width",600),i(this,"height",600),i(this,"sheetWidth",0),i(this,"sheetHeight",0),i(this,"selectorDom",null),i(this,"canvasDom",null),i(this,"canvasWrapperDom",null),i(this,"layer",null),i(this,"components",{}),i(this,"plugins",{}),i(this,"copyKey",!1),i(this,"copyCellDash",[]),i(this,"shiftKey",!1),i(this,"ctrlKey",!1),i(this,"dragSign",!1),i(this,"lockDrag",!1),i(this,"dragSignDirectionIsHor",!1),i(this,"offsetYLock",!1),i(this,"offsetXLock",!1),i(this,"isScrollBottomBound",!1),i(this,"isScrollRightBound",!1),i(this,"nonSelectBgColor","#FFFFFF"),i(this,"selectedBorderBgColor","#0089FF"),i(this,"selectedBgColor","#EBF4FF"),i(this,"borderColor","#ECEDEE"),i(this,"borderCellBgColor","#F9FBFD"),i(this,"currentSheetIndex",0),i(this,"getType",(function(e){return Object.prototype.toString.call(e)})),i(this,"h",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.attr,n=t.style,i=t.attribute,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=document.createElement(e);for(var a in o)s[a]=o[a];for(var c in i)s.setAttribute(c,i[c]);for(var h in n)s.style[h]=n[h];r&&("[object Array]"===l.getType(r)?r.forEach((function(e){s.appendChild(e)})):s.appendChild(r));return s})),i(this,"fps",0),i(this,"lastTime",0),i(this,"draw",(function(){var e=performance.now(),t=e-l.lastTime;l.lastTime=e,l.fps=Math.round(1e3/t),requestAnimationFrame(l.draw)})),n.width=n.width&&!isNaN(n.width)&&n.width>0?n.width:this.width,n.height=n.height&&!isNaN(n.height)&&n.height>0?n.height:this.width,n.row=n.row&&n.row>this.row?n.row:this.row,n.col=n.col&&n.col>this.col?n.col:this.col,n.cellWidth=this.cellWidth,n.cellHeight=this.cellHeight,this.selectorDom=t;var a=document.createElement("canvas");a.width=n.width,a.height=n.height;var c=this.h("div",{attr:{className:"e-sheet-canvas-wrapper"}});c.appendChild(a),this.canvasWrapperDom=c,this.selectorDom.style.width=n.width+"px",this.canvasWrapperDom.style.width=n.width+"px",this.canvasWrapperDom.style.height=n.height+"px",this.selectorDom.appendChild(c),this.canvasDom=a,this.layer=new v(a,n,this),this.options=n,this.createNewSheet(),this.installComponents(r),this.installPlugins(s),this.plugins.SettingPlugin.changeFirstSelectedCell("A1"),this.ws=this.plugins.WebsocketPlugin}return n(e,[{key:"getRandomColor",value:function(){var e=Math.floor(16777215*Math.random()).toString(16);return 6===e.length?"#"+e:this.getRandomColor()}},{key:"stepCallbackHandle",value:function(e){this.stepCallbackArr.push(e)}},{key:"exportXlsxData",value:function(){var e=[];return this.eSheetWorkBook.forEach((function(t){var o=t.sheet.filter((function(e){return e.isMerge})),l=o.filter((function(e){return e.mergeStartLabel===e.label})).map((function(e){var t=o.findIndex((function(t){return t.label===e.mergeEndLabel})),l=o[t];return{s:{c:e.col-1,r:e.row-1},e:{c:l.col-1,r:l.row-1}}})),n=t.sheet.filter((function(e){return!!e.text})).filter((function(e){return e.isMerge&&e.label===e.mergeStartLabel||!e.isMerge})),i={};n.forEach((function(e){i[e.label]={t:"s",v:e.text}})),n.length>1?i["!ref"]=n[0].label+":"+n[n.length-1].label:1===n.length&&(i["!ref"]=n[0].label);var r={label:t.label,sheet:i};l.length>0&&(i["!merges"]=l),e.push(r)})),e}},{key:"connectWebSocket",value:function(e){this.ws.connect(e)}},{key:"setUserName",value:function(e){this.userName=e}},{key:"switchSheet",value:function(e){this.saveHandle();var t=this.eSheetWorkBook[e];if(this.currentSheetIndex=e,this.components.ContentComponent.installContentDataByData(t.sheet),t.clickCell)this.components.ContentComponent.showClickRect(t.clickCell),this.plugins.SettingPlugin.setLabelCon(t.clickCell.label),this.plugins.SettingPlugin.setCellCon(t.clickCell.text);else{var o=this.components.ContentComponent.searchRectByLabel("A1");this.components.ContentComponent.showClickRect(o),this.plugins.SettingPlugin.setLabelCon(o.label),this.plugins.SettingPlugin.setCellCon(o.text)}this.fresh()}},{key:"saveHandle",value:function(){(this.copyKey=!1,this.copyCellDash=[],this.components.ContentComponent&&this.components.ContentComponent.clickCell)&&(this.eSheetWorkBook[this.currentSheetIndex].clickCell=this.components.ContentComponent.clickCell,this.components.ContentComponent.hideClickRect())}},{key:"getCurrentSheet",value:function(){return this.eSheetWorkBook[this.currentSheetIndex]}},{key:"createNewSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet";this.saveHandle();var t=this.options,o=t.row,l=t.col,n=t.cellWidth,i=t.cellHeight,r=0,s=0,a=0,c=i;this.sheetWidth=0,this.sheetHeight=0;for(var h=1,d=e+h,u=this.eSheetWorkBook.findIndex((function(e){return e.label===d}));-1!==u;)h++,d=e+h,u=this.eSheetWorkBook.findIndex((function(e){return e.label===d}));this.eSheetWorkBook.push({id:(new Date).valueOf(),label:d,sheet:[],clickCell:null,stepArr:[],stepNum:-1}),this.currentSheetIndex=this.eSheetWorkBook.length-1;for(var g=this.eSheetWorkBook[this.eSheetWorkBook.length-1].sheet,p=0;p<o;p++){r=0,s=i,this.sheetHeight+=i;for(var m=0;m<l;m++){0===p&&(this.sheetWidth+=n);var f=y(m+1)+(p+1);g.push({row:p+1,col:m+1,text:"",textAsNumber:NaN,width:n,height:i,x:r,y:a,ltX:s,ltY:c,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:"#ffffff",fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",label:f}),r+=n,s+=n}a+=i,c+=i}}},{key:"initExcelData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet1",t=this.options,o=t.row,l=t.col,n=t.cellWidth,i=t.cellHeight,r=0,s=0,a=0,c=i;this.sheetWidth=0,this.sheetHeight=0;var h=this.eSheetWorkBook.findIndex((function(t){return t.label===e})),d=0;-1===h?(this.eSheetWorkBook.push({label:e,sheet:[]}),d=this.eSheetWorkBook.length-1):d=h,this.eSheetWorkBook[d].sheet=[];for(var u=0;u<o;u++){r=0,s=i,this.sheetHeight+=i;for(var g=0;g<l;g++){var p,m;0===u&&(this.sheetWidth+=n);var f=y(g+1)+(u+1);this.eSheetWorkBook[d].sheet.push({row:u+1,col:g+1,text:this.workBook[e]&&null!==(p=null===(m=this.workBook[e][String.fromCharCode(65+g)+(u+1)])||void 0===m?void 0:m.v)&&void 0!==p?p:"",textAsNumber:NaN,width:n,height:i,x:r,y:a,ltX:s,ltY:c,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:"#ffffff",fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",label:f}),r+=n,s+=n}a+=i,c+=i}}},{key:"installXlsxData",value:function(e){if(this.workBook=e,0===Object.keys(e).length)throw new Error("data is error");this.initExcelData(Object.keys(e)[0]),this.components.ContentComponent.installContentDataByName(Object.keys(e)[0]),this.components.ContentComponent.hideClickRect(),this.fresh()}},{key:"installComponents",value:function(e){for(var t in e)this.components[t]=new e[t](this.layer,this.options,this)}},{key:"installPlugins",value:function(e){for(var t in e)this.plugins[t]=new e[t](this.selectorDom,this.layer,this.options,this.components,this)}},{key:"fresh",value:function(){var e=this.plugins.ScrollPlugin,t=e.offsetX,o=e.offsetY,l=this.components,n=l.ContentComponent,i=l.HeaderComponent,r=l.SideComponent,s=l.WholeComponent;n.trendsDraw(t,o),i.trendsDraw(t),r.trendsDraw(o),s.draw()}},{key:"freshContent",value:function(){var e=this.plugins.ScrollPlugin,t=e.offsetX,o=e.offsetY;this.components.ContentComponent.trendsDraw(t,o)}},{key:"freshScrollBar",value:function(){this.plugins.ScrollPlugin.changeHorBarWidth(),this.plugins.ScrollPlugin.changeVerBarHeight()}}]),e}(),b=function(){function e(t){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"options",{}),i(this,"layer",null),i(this,"core",null),this.layer=t,this.options=l,this.core=n,this.draw()}return n(e,[{key:"draw",value:function(){var e=this.core,t=e.borderCellBgColor,o=e.borderColor,l=this.options.cellHeight;this.layer.clearRect(0,0,l,l),this.layer.drawTriangleRect({x:l-6,y:6},{x:l-6,y:l-6},{x:6,y:l-6},"#DCDCDC"),this.layer.drawLine([0,0,l,0],null,o),this.layer.drawLine([0,0,0,l],null,o),this.layer.drawFillRect(0,0,l,l,t,"destination-over")}},{key:"addEvent",value:function(){}}]),e}(),S=function(){function e(t){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"options",{}),i(this,"layer",null),i(this,"headerRectGroup",[]),this.options=l,this.layer=t,this.core=n,this.trendsDraw(0)}return n(e,[{key:"initDraw",value:function(){for(var e=this.options.col,t=this.options.cellWidth,o=this.options.cellHeight,l=0;l<e;l++){var n=String.fromCharCode(65+l),i=new Konva.Rect({x:l*t+40,y:0,width:t,height:o,fill:"#c0c4cc",stroke:"#606266",strokeWidth:1,attrs:{headerLabel:n,col:l,row:0}}),r=new Konva.Text({x:l*t+40,y:0,width:t,height:o,align:"center",verticalAlign:"middle",text:n,fontSize:20,fontFamily:"Calibri",fill:"black",attrs:{headerLabel:n,col:l,row:0}});i.hide(),r.hide(),this.headerBackGroup.add(i),this.headerTextGroup.add(r)}var s=new Konva.Line({points:[0,0,0,0],stroke:"blue",strokeWidth:1,lineCap:"round",lineJoin:"round"});this.headerBorderGroup.add(s)}},{key:"trendsDraw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=this.options,l=o.width,n=o.cellHeight,i=this.core,r=i.borderCellBgColor,s=i.nonSelectBgColor,a=i.borderColor,c=i.selectedBgColor,h=this.core.components.ContentComponent,d=h.contentGroup,u=h.clickCell,g=h.clickRectShow,p=h.isRowSelect,m=h.secondClickCell,f=h.attrSecond,C=h.attrFirst,v=h.startAndEndRect,y=this.searchScreenAddr(t,0),w=this.searchScreenAddr(t+l-n,n),b=d.filter((function(e){return e.col>=y.col&&1===e.row&&e.col<=w.col}));this.headerRectGroup=b,this.layer.clearRect(n,0,l,n),this.layer.drawLine([n,0,l,0],null,a),this.layer.drawLine([n,n,l,n],null,a);for(var S=function(){var o=b[x];if(e.layer.drawText(o.x+n-t,0,o.label.slice(0,o.label.length-1),o.width,n,"destination-over",null,null,{fontSize:12,fontFamily:"",fontWeight:"",fontItalic:""}),e.layer.drawLine([o.x+n-t,0,o.x+n-t,n],"destination-over",a),g&&!p){var l=v?C.col:(null==m?void 0:m.col)>u.col?u.col:null==m?void 0:m.col,i=v?f.col:(null==m?void 0:m.col)>u.col?null==m?void 0:m.col:u.col;if(m&&o.col>=l&&o.col<=i)e.layer.drawFillRect(o.x+n-t,0,o.width,n,c,"destination-over");else if(o.col!==u.col||u.isMerge)if(u.isMerge){-1!==e.findClickCellRowArr(u).findIndex((function(e){return e===o.col}))&&e.layer.drawFillRect(o.x+n-t,0,o.width,n,c,"destination-over")}else e.layer.drawFillRect(o.x+n-t,0,o.width,n,r,"destination-over");else e.layer.drawFillRect(o.x+n-t,0,o.width,n,c,"destination-over")}else e.layer.drawFillRect(o.x+n-t,0,o.width,n,r,"destination-over");e.layer.drawFillRect(o.x+n-t,0,o.width,n,s,"destination-over")},x=0;x<b.length;x++)S()}},{key:"findClickCellRowArr",value:function(e){for(var t=[],o=e.col+e.mergeCol-1,l=e.col;l<=o;l++)t.push(l);return t}},{key:"searchScreenAddr",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.core.components.ContentComponent.contentGroup.filter((function(e){return 1===e.row})),l=0,n=0,i=0,r=0,s=0;s<o.length;s++){var a=o[s];if(n=(l=a.x)+a.width,r=(i=a.y)+a.height,l<=e&&e<=n&&i<=t&&t<=r&&1===a.row)return a}return o[o.length-1]}}]),e}(),x=function(){function e(t){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"options",{}),i(this,"layer",null),i(this,"sideRectGroup",[]),this.options=l,this.layer=t,this.core=n,this.trendsDraw(0)}return n(e,[{key:"initDraw",value:function(){for(var e=this.options,t=e.row,o=e.cellHeight,l=0;l<t;l++){var n=new Konva.Rect({x:0,y:l*o+40,width:o,height:o,fill:"#fff",stroke:"#606266",strokeWidth:1,attrs:{uniPos:"header"+l,exHeaderCell:!0,col:0,row:l,zIndex:99}}),i=new Konva.Text({x:0,y:l*o+40,width:o,height:o,text:l+1,fontSize:20,align:"center",verticalAlign:"middle",fontFamily:"Calibri",fill:"black",attrs:{col:0,row:l,label:l}});n.hide(),i.hide(),this.sideBackGroup.add(n),this.sideTextGroup.add(i)}var r=new Konva.Line({points:[0,0,0,0],stroke:"blue",strokeWidth:1,lineCap:"round",lineJoin:"round"});this.sideBorderGroup.add(r)}},{key:"trendsDraw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=this.options,l=o.height,n=o.cellHeight,i=this.core.components.ContentComponent,r=i.contentGroup,s=i.clickCell,a=i.clickRectShow,c=i.isColSelect,h=i.secondClickCell,d=i.attrSecond,u=i.attrFirst,g=i.startAndEndRect,p=this.core,m=p.borderCellBgColor;p.selectedBorderBgColor;var f=p.borderColor,C=p.selectedBgColor,v=p.nonSelectBgColor,y=this.searchScreenAddr(0,t),w=this.searchScreenAddr(n,l-n+t),b=r.filter((function(e){return e.row>=y.row&&1===e.col&&e.row<=w.row}));this.sideRectGroup=b,this.layer.clearRect(0,n,n,l),this.layer.drawLine([0,n,0,l],null,f),this.layer.drawLine([n,n,n,l],null,f);for(var S=function(){var o=b[x];if(e.layer.drawText(0,o.y+n-t,o.row,n,o.height,"destination-over"),e.layer.drawLine([0,o.y+n-t,n,o.y+n-t],"destination-over",f),a&&!c){var l=g?u.row:(null==h?void 0:h.row)>s.row?s.row:null==h?void 0:h.row,i=g?d.row:(null==h?void 0:h.row)>s.row?null==h?void 0:h.row:s.row;if(h&&o.row>=l&&o.row<=i)e.layer.drawFillRect(0,o.y+n-t,n,o.height,C,"destination-over");else if(s.row!==o.row||s.isMerge)if(s.isMerge){-1!==e.findClickCellRowArr(s).findIndex((function(e){return e===o.row}))&&e.layer.drawFillRect(0,o.y+n-t,n,o.height,C,"destination-over")}else e.layer.drawFillRect(0,o.y+n-t,n,o.height,m,"destination-over");else e.layer.drawFillRect(0,o.y+n-t,n,o.height,C,"destination-over")}else e.layer.drawFillRect(0,o.y+n-t,n,o.height,m,"destination-over");e.layer.drawFillRect(0,o.y+n-t,n,o.height,v,"destination-over")},x=0;x<b.length;x++)S()}},{key:"findClickCellRowArr",value:function(e){for(var t=[],o=e.row+e.mergeRow-1,l=e.row;l<=o;l++)t.push(l);return t}},{key:"searchScreenAddr",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.core.components.ContentComponent.contentGroup.filter((function(e){return 1===e.col})),l=0,n=0,i=0,r=0,s=0;s<o.length;s++){var a=o[s];if(n=(l=a.x)+a.width,r=(i=a.y)+a.height,l<=e&&e<=n&&i<=t&&t<=r&&1===a.col)return a}return o[o.length-1]}}]),e}(),k=function(){function e(t){var l=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"selectedCellTopBorderDom",null),i(this,"selectedCellBottomBorderDom",null),i(this,"selectedCellLeftBorderDom",null),i(this,"selectedCellRightBorderDom",null),i(this,"selectedCellWidth",0),i(this,"selectedCellHeight",0),i(this,"canvasDom",null),i(this,"options",{}),i(this,"offsetX",0),i(this,"offsetY",0),i(this,"clickRectShow",!1),i(this,"moveClickCell",null),i(this,"clickCell",null),i(this,"secondClickCell",null),i(this,"isColSelect",!1),i(this,"isRowSelect",!1),i(this,"moreSelectedCell",[]),i(this,"mergeSelectedCell",[]),i(this,"startAndEndRect",null),i(this,"attrFirst",null),i(this,"attrSecond",null),i(this,"layer",null),i(this,"contentGroup",[]),i(this,"moveCell",(function(e){var t=l.options.cellHeight,o=l.core.plugins.ScrollPlugin,n=o.offsetX,i=o.offsetY,r=l.core.plugins.SelectPlugin.searchRectAddr(e.offsetX+n-t,e.offsetY+i-t);l.moveClickCell=r,l.showSelectedCellDom(r.x+t-n,r.y-i+t,r.isMerge?r.mergeWidth:r.width,r.isMerge?r.mergeHeight:r.height)})),i(this,"cellPainterDom",null),i(this,"cellPainterTopBorderDom",null),i(this,"cellPainterBottomBorderDom",null),i(this,"cellPainterLeftBorderDom",null),i(this,"cellPainterRightBorderDom",null),this.options=n,this.layer=t,this.core=r,this.canvasDom=r.canvasDom,this.selectorDom=r.selectorDom,this.canvasWrapperDom=r.canvasWrapperDom;var s=this.core.eSheetWorkBook[this.core.currentSheetIndex];this.registrySelectedCellDom(),this.registryCellPainterDom(),this.installContentDataByData(s.sheet),s.clickCell&&this.showClickRect(s.clickCell),this.trendsDraw(0,0)}return n(e,[{key:"installContentDataByName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet1",t=this.core.eSheetWorkBook.findIndex((function(t){return t.label===e}));this.contentGroup=this.core.eSheetWorkBook[t].sheet}},{key:"installContentDataByData",value:function(e){this.contentGroup=e}},{key:"showClickRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.clickCell=e,this.clickRectShow=!0,this.isColSelect=t,this.isRowSelect=o,this.core.ws&&this.core.ws.wsSend(0,e)}},{key:"setSecondClickCell",value:function(e){this.secondClickCell=e}},{key:"hideClickRect",value:function(){this.clickRectShow=!1,this.isColSelect=!1,this.isRowSelect=!1,this.secondClickCell=null,this.clickCell=null,this.moreSelectedCell=[],this.hideSelectedCellDom()}},{key:"drawMulPersonSelected",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=this.options.cellHeight;this.core.mulPersonSelected.forEach((function(n){var i=n.command;if(i.isMerge){var r=i.mergeWidth,s=i.mergeHeight;e.layer.drawStrokeRect(i.x+l-t,i.y-o+l,r,s,n.userColor,"destination-over",2)}else e.layer.drawStrokeRect(i.x+l-t,i.y-o+l,i.width,i.height,n.userColor,"destination-over",2);e.layer.drawText(i.x+l-t+6,i.y-o+l-16,n.userName,i.width,20,"destination-over","#ffffff","left",{},"top"),e.layer.drawFillRect(i.x+l-t,i.y-o+l-20,i.width,20,n.userColor,"destination-over")}))}},{key:"initDraw",value:function(){for(var e=this.options.col,t=this.options.row,o=this.options.cellWidth,l=this.options.cellHeight,n=0;n<t;n++)for(var i=0;i<e;i++){var r=String.fromCharCode(65+i),s=new Konva.Rect({x:i*o+40,y:n*l+40,width:o,height:l,stroke:"#dcdfe6",strokeWidth:1,listening:!1,attrs:{row:n,col:i,name:r+(n+1)}}),a=new Konva.Text({x:i*o+40,y:n*l+40,width:o,height:l,align:"center",verticalAlign:"middle",padding:6,ellipsis:!0,fontSize:12,fontFamily:"Calibri",fill:"black",attrs:{row:n,col:i,name:r+(n+1)}});s.hide(),a.hide(),this.contentBackGroup.add(s),this.contentTextGroup.add(a)}var c=new Konva.Rect({x:0,y:0,width:0,height:0});this.contentBorderGroup.add(c)}},{key:"showSelectedCellDom",value:function(e,t,o,l){var n,i;o=null!==(n=o)&&void 0!==n?n:this.selectedCellWidth,l=null!==(i=l)&&void 0!==i?i:this.selectedCellHeight,this.selectedCellWidth=o,this.selectedCellHeight=l,t<this.core.cellHeight||e<this.core.cellHeight?this.hideSelectedCellDom():(this.selectedCellTopBorderDom.style.display="block",this.selectedCellTopBorderDom.style.left=e+"px",this.selectedCellTopBorderDom.style.top=t+"px",this.selectedCellTopBorderDom.style.width=o+"px",this.selectedCellBottomBorderDom.style.display="block",this.selectedCellBottomBorderDom.style.left=e+"px",this.selectedCellBottomBorderDom.style.top=t+l-4+"px",this.selectedCellBottomBorderDom.style.width=o+"px",this.selectedCellLeftBorderDom.style.display="block",this.selectedCellLeftBorderDom.style.left=e+"px",this.selectedCellLeftBorderDom.style.top=t+"px",this.selectedCellLeftBorderDom.style.height=l+"px",this.selectedCellRightBorderDom.style.display="block",this.selectedCellRightBorderDom.style.left=e+o-4+"px",this.selectedCellRightBorderDom.style.top=t+"px",this.selectedCellRightBorderDom.style.height=l+"px"),this.showSelectedCellPainterDom(e+o,t+l)}},{key:"setSelectedCellBorderDomBgColor",value:function(e){var t=this.core.selectedBorderBgColor,o=null!=e?e:t;this.selectedCellTopBorderDom.style.backgroundColor=o,this.selectedCellBottomBorderDom.style.backgroundColor=o,this.selectedCellLeftBorderDom.style.backgroundColor=o,this.selectedCellRightBorderDom.style.backgroundColor=o}},{key:"hideSelectedCellDom",value:function(){this.selectedCellTopBorderDom.style.display="none",this.selectedCellBottomBorderDom.style.display="none",this.selectedCellLeftBorderDom.style.display="none",this.selectedCellRightBorderDom.style.display="none",this.cellPainterDom.style.display="none"}},{key:"searchAllCellInMergeCell",value:function(e){if(e||!e.isMerge)return[];for(var t=e.row+e.mergeRow,o=e.col+e.mergeCol,l=[],n=e.row;n<t;n++)for(var i=e.col;i<o;i++)l.push(this.searchRectByColAndRow(i,n));return l}},{key:"initMoreSelectedCell",value:function(){var e=this.moreSelectedCell,t=this.clickCell,o="",l="";if(e.length>0)o=JSON.stringify(e),e.forEach((function(e){e.text="",e.fontColor="",e.bgColor="",e.font="",e.textAlign="",e.mergeWidth=0,e.mergeHeight=0,e.mergeRow=1,e.mergeCol=1,e.isMerge=!1,e.fontSize=12,e.fontFamily=""})),l=JSON.stringify(e);else if(t.isMerge){o=JSON.stringify(this.searchAllCellInMergeCell(t));for(var n=t.row+t.mergeRow,i=t.col+t.mergeCol,r=[],s=t.row;s<n;s++)for(var a=t.col;a<i;a++){var c=this.searchRectByColAndRow(a,s);c.text="",c.fontSize=12,c.fontFamily="",c.fontColor="",c.bgColor="",c.font="",c.textAlign="",c.mergeWidth=0,c.mergeHeight=0,c.mergeRow=1,c.mergeCol=1,c.isMerge=!1,r.push(c)}l=JSON.stringify(r)}else o=JSON.stringify([t]),t.text="",t.fontColor="",t.bgColor="",t.font="",t.textAlign="",t.mergeWidth=0,t.mergeHeight=0,t.mergeRow=1,t.mergeCol=1,t.isMerge=!1,t.fontSize=12,t.fontFamily="",l=JSON.stringify([t]);return{preCellStr:o,lastCellStr:l}}},{key:"searchAllCellsByMoreSelectedCellAndTargetCell",value:function(e,t){var o=[];if(!(t.length>1))return[e];for(var l=t[0],n=t[t.length-1],i=n.col-l.col,r=n.row-l.row,s=e.row,a=e.row+r;s<=a;s++)for(var c=e.col,h=e.col+i;c<=h;c++)o.push(this.searchRectByColAndRow(c,s));return o}},{key:"moveSelectedCellDom",value:function(){var e=this;this.setSelectedCellBorderDomBgColor(),this.canvasDom.onmousemove=function(t){e.moveCell(t)},this.canvasWrapperDom.onmouseup=function(t){if(e.setSelectedCellBorderDomBgColor("transparent"),e.moveClickCell&&!e.moveClickCell.isMerge){var o=e.core.plugins,l=o.SelectPlugin,n=o.SettingPlugin,i=l.transformCanvasCellToTableDomStr(),r=e.initMoreSelectedCell(),s=r.preCellStr,a=r.lastCellStr,c=e.searchAllCellsByMoreSelectedCellAndTargetCell(e.moveClickCell,JSON.parse(s));n.changeStepArr({type:16,pre:{beforeStr:s,lastStr:a},next:{beforeStr:JSON.stringify(c),lastStr:i,label:e.moveClickCell.label}}),e.core.ws.wsSend(16,{pre:a,next:i,label:e.moveClickCell.label}),l.transformTableDomStrToCanvasCell(i,e.moveClickCell),e.setSecondClickCell(null),e.moveClickCell=null,e.canvasDom.onmousemove=null,e.canvasWrapperDom.onmouseup=null}}}},{key:"registrySelectedCellDom",value:function(){var e=this,o=this.core,l=o.h,n=o.canvasWrapperDom,i={onmousedown:function(t){e.moveSelectedCellDom()},oncontextmenu:function(e){e.preventDefault()}},r={left:0,top:0,display:"none"},s=l("div",{attr:t({className:"e-sheet-hor-cell-border"},i),style:t(t({},r),{},{width:0})}),a=l("div",{attr:t({className:"e-sheet-hor-cell-border"},i),style:t(t({},r),{},{width:0})}),c=l("div",{attr:t({className:"e-sheet-ver-cell-border"},i),style:t(t({},r),{},{height:0})}),h=l("div",{attr:t({className:"e-sheet-ver-cell-border"},i),style:t(t({},r),{},{height:0})});this.selectedCellTopBorderDom=s,this.selectedCellBottomBorderDom=a,this.selectedCellLeftBorderDom=c,this.selectedCellRightBorderDom=h,n.appendChild(s),n.appendChild(a),n.appendChild(c),n.appendChild(h)}},{key:"registryCellPainterDom",value:function(){var e=this,t=this.core,o=t.h,l=t.canvasWrapperDom;this.cellPainterDom=o("div",{attr:{className:"e-sheet-cell-painter",onmouseup:function(t){e.canvasDom.onmousemove=null}}}),this.cellPainterTopBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{height:"4px",display:"none"}}),this.cellPainterBottomBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{height:"4px",display:"none"}}),this.cellPainterLeftBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{width:"4px",display:"none"}}),this.cellPainterRightBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{width:"4px",display:"none"}}),l.appendChild(this.cellPainterTopBorderDom),l.appendChild(this.cellPainterBottomBorderDom),l.appendChild(this.cellPainterLeftBorderDom),l.appendChild(this.cellPainterRightBorderDom),this.cellPainterDom.oncontextmenu=function(e){e.preventDefault()},this.cellPainterDom.onmousedown=function(t){t.stopImmediatePropagation();var o=parseInt(e.cellPainterDom.style.left),l=parseInt(e.cellPainterDom.style.top),n=0,i=0,r=0,s=0,a=0,c=0,h=null,d=null,u="";e.canvasDom.onmousemove=function(t){var g=e.options.cellHeight,p=e.clickCell,m=e.moreSelectedCell,f=e.core.plugins.ScrollPlugin,C=f.offsetX,v=f.offsetY,y=e.core.plugins.SelectPlugin.searchRectAddr(t.offsetX+C-g,t.offsetY+v-g),w=Math.abs(t.offsetX-o),b=Math.abs(t.offsetY-l);if(m.length>0){var S=m.filter((function(e){return e.row===p.row}));d=S[S.length-1],n=d.col-p.col+1,r=d.x-p.x+d.width;var x=m.filter((function(e){return e.col===p.col}));h=x[x.length-1],i=h.row-p.row+1,s=h.y-p.y+h.height,m[m.length-1]}else p.isMerge?(d=e.searchRectByColAndRow(p.col+p.mergeCol-1,p.row),h=e.searchRectByColAndRow(p.col,p.row+p.mergeRow-1),e.searchRectByLabel(p.mergeEndLabel),r=p.mergeWidth,s=p.mergeHeight):(d=h=p,r=p.width,s=p.height),n=p.mergeCol,i=p.mergeRow;if(t.offsetX>=p.ltX-C&&t.offsetX<=p.ltX-C+r&&t.offsetY>=p.ltY-v&&t.offsetY<=p.ltY-v+s)return e.hidePainterBorderDom(),u=null,e.canvasWrapperDom.onmouseup=null,void(e.canvasDom.onmouseup=null);if(w>b){var k=e.searchRectByColAndRow(y.col,p.row);t.offsetX>o?(u="right",a=Math.ceil(Math.abs(k.col-d.col)/n),e.showPainterBorderDom(p.ltX+r-C,p.ltY-v,r*a,s)):t.offsetX<o&&(u="left",a=Math.ceil(Math.abs(k.col-p.col)/n),e.showPainterBorderDom(p.ltX-r*a-C,p.ltY-v,r*a,s))}else{var D=e.searchRectByColAndRow(p.col,y.row);t.offsetY>l?(u="bottom",c=Math.ceil(Math.abs(D.row-h.row)/i),e.showPainterBorderDom(p.ltX,p.ltY+s-v,r,s*c)):t.offsetY<l&&(u="top",c=Math.ceil(Math.abs(D.row-p.row)/i),e.showPainterBorderDom(p.ltX,p.ltY-s*c-v,r,s*c))}e.canvasWrapperDom.onmouseup=function(t){if(t.stopImmediatePropagation(),null!==u){var o=e.core.plugins,l=o.SelectPlugin,r=o.SettingPlugin,s=l.transformCanvasCellToTableDomStr(),h=[];if("right"===u)for(var d=1;d<=a;d++)h.push(e.searchRectByColAndRow(p.col+d*n,p.row));else if("left"===u)for(var g=1;g<=a;g++)h.push(e.searchRectByColAndRow(p.col-g*n,p.row));else if("bottom"===u)for(var f=1;f<=c;f++)h.push(e.searchRectByColAndRow(p.col,p.row+f*i));else if("top"===u)for(var C=1;C<=c;C++)h.push(e.searchRectByColAndRow(p.col,p.row-C*i));var v=[];h.forEach((function(t){v.push(JSON.stringify(e.searchAllCellsByMoreSelectedCellAndTargetCell(t,m)))}));var y=[];h.forEach((function(e){y.push({tableDomStr:s,label:e.label}),l.transformTableDomStrToCanvasCell(s,e)})),r.changeStepArr({type:17,pre:v,next:y}),e.core.ws.wsSend(17,{next:y}),e.setSecondClickCell(null),e.canvasDom.onmousemove=null,e.canvasWrapperDom.onmouseup=null,e.hidePainterBorderDom()}}}},l.appendChild(this.cellPainterDom)}},{key:"hidePainterBorderDom",value:function(){this.cellPainterTopBorderDom.style.display="none",this.cellPainterBottomBorderDom.style.display="none",this.cellPainterLeftBorderDom.style.display="none",this.cellPainterRightBorderDom.style.display="none"}},{key:"showPainterBorderDom",value:function(e,t,o,l){this.cellPainterTopBorderDom.style.left=e+"px",this.cellPainterTopBorderDom.style.top=t+"px",this.cellPainterTopBorderDom.style.width=o+"px",this.cellPainterTopBorderDom.style.display="block",this.cellPainterBottomBorderDom.style.left=e+"px",this.cellPainterBottomBorderDom.style.top=t+l-4+"px",this.cellPainterBottomBorderDom.style.width=o+"px",this.cellPainterBottomBorderDom.style.display="block",this.cellPainterLeftBorderDom.style.left=e+"px",this.cellPainterLeftBorderDom.style.top=t+"px",this.cellPainterLeftBorderDom.style.height=l+"px",this.cellPainterLeftBorderDom.style.display="block",this.cellPainterRightBorderDom.style.left=e+o-4+"px",this.cellPainterRightBorderDom.style.top=t+"px",this.cellPainterRightBorderDom.style.height=l+"px",this.cellPainterRightBorderDom.style.display="block"}},{key:"showSelectedCellPainterDom",value:function(e,t){t<this.core.cellHeight||e<this.core.cellHeight||e>this.options.width||t>this.options.height?this.cellPainterDom.style.display="none":this.cellPainterDom.style.display="block",this.cellPainterDom.style.left=e-3+"px",this.cellPainterDom.style.top=t-3+"px",this.cellPainterDom.style.cursor="url(".concat(C.crosshair,") 18 18, crosshair")}},{key:"hideCellPainterDom",value:function(){this.cellPainterDom.style.display="none"}},{key:"trendsDraw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=this.options,n=l.width,i=l.height,r=l.cellHeight;l.cellWidth;var s=this.core,a=s.nonSelectBgColor,c=s.selectedBorderBgColor,h=s.borderColor,d=s.selectedBgColor,u=s.copyKey,g=this.searchScreenAddr(t,o),p=this.searchScreenAddr(t+n-r,o+i-r);this.layer.clearRect(r,r,n,i);var m=this.core.copyCellDash;if(u)if(m.length>1){var f=m[0],C=m[m.length-1];this.layer.drawDashStrokeRect(f.ltX-t+2,f.ltY-o+2,C.ltX-f.ltX+C.width-4,C.ltY-f.ltY+C.height-4,c,"destination-over")}else if(1===m.length){var v=m[0];v.isMerge?this.layer.drawDashStrokeRect(v.ltX-t+2,v.ltY-o+2,v.mergeWidth-4,v.mergeHeight-4,c,"destination-over"):this.layer.drawDashStrokeRect(v.ltX-t+2,v.ltY-o+2,v.width-4,v.height-4,c,"destination-over")}var y=null,w=null,b=null;if(this.secondClickCell){y=this.clickCell;var S=(w=this.secondClickCell).x>y.x,x=w.y>y.y;if(b=S&&!x?this.searchRectIsMerge(y.x,w.y,w.x,y.y,y,w):S&&x?this.searchRectIsMerge(y.x,y.y,w.x,w.y,y,w):!S&&x?this.searchRectIsMerge(w.x,y.y,y.x,w.y,y,w):this.searchRectIsMerge(w.x,w.y,y.x,y.y,y,w),this.startAndEndRect=b,b){var k=[],D=[];b.forEach((function(t){k.push(e.searchRectByLabel(t.mergeStartLabel)),D.push(e.searchRectByLabel(t.mergeEndLabel))}));var M=k.concat([y,w]),I=D.concat([y,w]),A=M.sort((function(e,t){return e.x-t.x}))[0].col,L=M.sort((function(e,t){return e.y-t.y}))[0].row,B=I.sort((function(e,t){return e.x-t.x}))[I.length-1].col,R=I.sort((function(e,t){return e.y-t.y}))[I.length-1].row;y=this.searchRectByColAndRow(A,L),w=this.searchRectByColAndRow(B,R),this.attrFirst=y,this.attrSecond=w}}var T=g.col,N=p.col,P=g.row,Z=p.row,W=this.contentGroup;if(this.clickRectShow)if(this.isColSelect&&!this.isRowSelect)this.layer.drawStrokeRect(this.clickCell.x+r-t,r,this.clickCell.width,this.core.isScrollBottomBound?i-r:i,c,"destination-over",2);else if(this.isRowSelect&&!this.isColSelect)this.layer.drawStrokeRect(r,this.clickCell.y-o+r,this.core.isScrollRightBound?n-r:n,r,c,"destination-over",2);else if(this.isRowSelect&&this.isColSelect)this.layer.drawStrokeRect(r,r,this.core.isScrollRightBound?n-r:n,this.core.isScrollBottomBound?i-r:i,c,"destination-over",2);else if(this.secondClickCell)if(b)b&&(this.layer.drawStrokeRect(y.x+r-t,y.y-o+r,w.x-y.x+w.width,w.y-y.y+w.height,c,"destination-over",2),this.showSelectedCellDom(y.x+r-t,y.y-o+r,w.x-y.x+w.width,w.y-y.y+w.height));else if(this.secondClickCell.x>=this.clickCell.x){var H=this.secondClickCell.y>this.clickCell.y;this.layer.drawStrokeRect(this.clickCell.x+r-t,(H?this.clickCell.y:this.secondClickCell.y)-o+r,this.secondClickCell.x-this.clickCell.x+this.secondClickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height,c,"destination-over",2),this.showSelectedCellDom(this.clickCell.x+r-t,(H?this.clickCell.y:this.secondClickCell.y)-o+r,this.secondClickCell.x-this.clickCell.x+this.secondClickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height)}else{var j=this.secondClickCell.y>this.clickCell.y;this.layer.drawStrokeRect(this.secondClickCell.x+r-t,(j?this.clickCell.y:this.secondClickCell.y)-o+r,this.clickCell.x-this.secondClickCell.x+this.clickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height,c,"destination-over",2),this.showSelectedCellDom(this.secondClickCell.x+r-t,(j?this.clickCell.y:this.secondClickCell.y)-o+r,this.clickCell.x-this.secondClickCell.x+this.clickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height)}else if(this.clickCell.isMerge){var G=this.clickCell,E=G.mergeWidth,Y=G.mergeHeight;this.layer.drawStrokeRect(this.clickCell.x+r-t,this.clickCell.y-o+r,E,Y,c,"destination-over",2),this.showSelectedCellDom(this.clickCell.x+r-t,this.clickCell.y-o+r,E,Y)}else this.layer.drawStrokeRect(this.clickCell.x+r-t,this.clickCell.y-o+r,this.clickCell.width,this.clickCell.height,c,"destination-over",2),this.showSelectedCellDom(this.clickCell.x+r-t,this.clickCell.y-o+r,this.clickCell.width,this.clickCell.height);this.drawMulPersonSelected(t,o),this.moreSelectedCell=[],this.mergeSelectedCell=[];for(var X=0;X<W.length;X++){var z=W[X],F=z.row,V=z.col,J=z.text,O=z.x,_=z.y,U=z.width,Q=z.height;if(V>=T&&V<=N&&F>=P&&F<=Z)if(z.isMerge)if(z.label===z.mergeStartLabel){var K=z.mergeWidth,q=z.mergeHeight;this.layer.drawStrokeRect(O-t+r,_-o+r,K,q,h,"destination-over",1),this.layer.drawText(O-t+r,_-o+r,J,K,q,"destination-over",z.fontColor,z.textAlign,{fontSize:z.fontsize,fontFamily:z.fontFamily,fontWeight:z.fontWeight,fontItalic:z.fontItalic},z.textBaseline),this.layer.drawFillRect(O-t+r,_-o+r,K,q,z.bgColor?z.bgColor:a,"destination-over",1)}else{var $=this.searchRectByLabel(z.mergeStartLabel);$.col>=T&&$.col<=N&&$.row>=P&&$.row<=Z||(this.layer.drawStrokeRect($.x-t+r,$.y-o+r,$.mergeWidth,$.mergeHeight,h,"destination-over",1),this.layer.drawText($.x-t+r,$.y-o+r,$.text,$.mergeWidth,$.mergeHeight,"destination-over",$.fontColor,$.textAlign,{fontsize:$.fontSize,fontFamily:$.fontFamily,fontWeight:$.fontWeight,fontItalic:$.fontItalic},$.textBaseline),this.layer.drawFillRect($.x-t+r,$.y-o+r,$.mergeWidth,$.mergeHeight,$.bgColor?$.bgColor:a,"destination-over",1))}else z.isMerge||(this.layer.drawStrokeRect(O-t+r,_-o+r,U,Q,h,"destination-over",1),this.layer.drawText(O-t+r,_-o+r,J,U,Q,"destination-over",z.fontColor,z.textAlign,{fontSize:z.fontSize,fontFamily:z.fontFamily,fontWeight:z.fontWeight,fontItalic:z.fontItalic},z.textBaseline),this.layer.drawFillRect(O-t+r,_-o+r,U,Q,z.bgColor?z.bgColor:a,"destination-over",1));if(this.secondClickCell){var ee=b?w.col>y.col?y.col:w.col:this.secondClickCell.col>this.clickCell.col?this.clickCell.col:this.secondClickCell.col,te=b?w.row>y.row?y.row:w.row:this.secondClickCell.row>this.clickCell.row?this.clickCell.row:this.secondClickCell.row,oe=b?w.col>y.col?w.col:y.col:this.secondClickCell.col>this.clickCell.col?this.secondClickCell.col:this.clickCell.col,le=b?w.row>y.row?w.row:y.row:this.secondClickCell.row>this.clickCell.row?this.secondClickCell.row:this.clickCell.row;V>=ee&&V<=oe&&F>=te&&F<=le&&(this.layer.drawFillRect(O+r-t,_-o+r,U,Q,d,"destination-over"),z.col===this.clickCell.col&&z.row===this.clickCell.row||this.mergeSelectedCell.push(z),this.moreSelectedCell.push(z))}this.isRowSelect&&this.isColSelect&&this.layer.drawFillRect(O-t+r,_-o+r,U,Q,d,"destination-over")}}},{key:"searchScreenAddr",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.contentGroup,l=0,n=0,i=0,r=0,s=0;s<o.length;s++){var a=o[s];if(n=(l=a.x)+a.width,r=(i=a.y)+a.height,l<=e&&e<=n&&i<=t&&t<=r)return a}return o[o.length-1]}},{key:"countMergeWidthAndHeight",value:function(e){var t=e.width,o=e.height;return e.mergeLabelGroup.forEach((function(l){e.row===l.row&&(t+=l.width),e.col===l.col&&(o+=l.height)})),{mergeWidth:t,mergeHeight:o}}},{key:"searchRectIsMerge",value:function(e,t,o,l,n,i){var r=this.contentGroup.filter((function(r){return r.x>=e&&r.x<=o&&r.y>=t&&r.y<=l&&r.isMerge&&([n.row,i.row].includes(r.row)||[n.col,i.col].includes(r.col))}));return r.length>0?r:null}},{key:"searchRectByLabel",value:function(e){var t=this.contentGroup,o=t.findIndex((function(t){return t.label===e}));return-1!==o?t[o]:null}},{key:"searchRectByColAndRow",value:function(e,t){var o=this.contentGroup,l=o.findIndex((function(o){return o.col===e&&o.row===t}));return-1!==l?o[l]:null}},{key:"searchRectIndexByColAndRow",value:function(e,t){return this.contentGroup.findIndex((function(o){return o.col===e&&o.row===t}))}},{key:"changeRectTextByLabel",value:function(e){var t=this.searchRectByLabel(e.label);t&&(t.text=e.text)}},{key:"changeRectAttrByLabel",value:function(e,t){var o=this.searchRectByLabel(e.label);o&&(o[t]=e[t])}},{key:"searchRectArrByCol",value:function(e){return this.contentGroup.filter((function(t){return t.col===e}))}},{key:"searchRectArrByRow",value:function(e){return this.contentGroup.filter((function(t){return t.row===e}))}},{key:"isHasMergerInRectArrByCol",value:function(e){return this.searchRectArrByCol(e).some((function(e){return e.isMerge}))}},{key:"isHasMergerInRectArrByRow",value:function(e){return this.searchRectArrByRow(e).some((function(e){return e.isMerge}))}},{key:"initContentGroupRowAndColByCol",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=this.contentGroup,n=this.options.cellHeight;o?this.core.col+=t:this.core.col-=t;for(var i=this.core.col,r=1,s=0,a=0,c=l.length;a<c;a++){var h=l[a];if((a+1)%i==1&&(r=1,s=0),h.col>=e&&(h.col=r,h.x=s,h.ltX=s+n,h.col>=27?h.label=String.fromCharCode(65+h.col-27)+String.fromCharCode(65+h.col-27)+h.row:h.label=String.fromCharCode(65+h.col-1)+h.row,h.isMerge)){for(var d=0,u=0,g=h.mergeStartLabel.replace(/[0-9]/,""),p=h.mergeEndLabel.replace(/[0-9]/,""),m=h.mergeStartLabel.replace(/[A-Z]/,""),f=h.mergeEndLabel.replace(/[A-Z]/,""),C=0;C<g.length;C++)d+=h.mergeStartLabel.charCodeAt(C)-65+t;for(var v=0;v<p.length;v++)u+=h.mergeEndLabel.charCodeAt(v)-65+t;d>=27?(h.mergeStartLabel=String.fromCharCode(65+d-26)+String.fromCharCode(65+d-26)+m,h.mergeEndLabel=String.fromCharCode(65+u-26)+String.fromCharCode(65+u-26)+f):(h.mergeStartLabel=String.fromCharCode(65+d)+m,h.mergeEndLabel=String.fromCharCode(65+u)+f)}r+=1,s+=h.width}}},{key:"initContentGroupRowAndColByRow",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=this.contentGroup,n=this.options.cellHeight;o?this.core.row+=t:this.core.row-=t;for(var i=this.core.col,r=0,s=0,a=0,c=0,h=l.length;c<h;c++){var d=l[c];if((c+1)%i==1&&((r+=1)>1&&(s+=d.height),a=0),d.row>=e&&(d.row=r,d.y=s,d.ltY=s+n,d.x=a,d.ltX=a+n,"insert"===d.label?d.col>=27?d.label=String.fromCharCode(65+d.col-27)+String.fromCharCode(65+d.col-27)+d.row:d.label=String.fromCharCode(65+d.col-1)+d.row:d.label=d.label.replace(/[0-9]/,r),d.isMerge)){var u=d.mergeStartLabel.replace(/[0-9]/,""),g=d.mergeEndLabel.replace(/[0-9]/,""),p=parseInt(d.mergeStartLabel.replace(/[A-Z]/,"")),m=parseInt(d.mergeEndLabel.replace(/[A-Z]/,""));d.mergeStartLabel=u+(p+t),d.mergeEndLabel=g+(m+t)}a+=d.width}}}]),e}(),D=function(){function e(t,l){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"clientHorX",0),i(this,"clientVerY",0),i(this,"recordDeltaY",0),i(this,"barTopDis",0),i(this,"barLeftDis",0),i(this,"wheelStep",10),i(this,"selectorDom",null),i(this,"barVerContainerDom",null),i(this,"barHorContainerDom",null),i(this,"layer",null),i(this,"options",{}),i(this,"components",[]),i(this,"barHeight",10),i(this,"contentComponent",null),i(this,"headerComponent",null),i(this,"sideComponent",null),i(this,"horBarDom",null),i(this,"verBarDom",null),i(this,"core",null),i(this,"leftDis",0),i(this,"topDis",0),i(this,"offsetX",0),i(this,"offsetY",0),this.selectorDom=t,this.canvasWrapperDom=a.canvasWrapperDom,this.layer=l,this.core=a,this.options=r,this.components=s,this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.wholeComponent=s.WholeComponent,this.registryHorScroll(),this.registryVerScroll(),document.onmouseup=function(){document.onmousemove=null,n.horBarDom.style.backgroundColor="rgb(201, 201, 201)",n.verBarDom.style.backgroundColor="rgb(201, 201, 201)",n.core.canvasDom.onmousemove=null,n.core.dragSign=!1,n.core.lockDrag=!1}}return n(e,[{key:"contentMoveX",value:function(){this.headerComponent.trendsDraw(this.offsetX),this.contentComponent.trendsDraw(this.offsetX,this.offsetY)}},{key:"contentMoveY",value:function(){this.sideComponent.trendsDraw(this.offsetY),this.contentComponent.trendsDraw(this.offsetX,this.offsetY)}},{key:"registryWheel",value:function(e){var t=this;this.canvasWrapperDom.onmouseover=function(){t.canvasWrapperDom.onwheel=function(e){e.preventDefault(),t.recordDeltaY=Math.abs(t.barTopDis),t.recordDeltaY+=e.deltaY>0?t.wheelStep:-t.wheelStep,requestAnimationFrame((function(){var e=t.recordDeltaY;t.verMoveFunc(e)}))}}}},{key:"unRegistryHorScroll",value:function(){this.barHorContainerDom.remove(),this.horBarDom.remove()}},{key:"changeHorBarWidth",value:function(){var e=(this.options.width-this.options.cellHeight-10)/this.core.sheetWidth;this.horBarDom.style.width=(this.options.width-this.options.cellHeight-10)*e+"px"}},{key:"changeVerBarHeight",value:function(){var e=(this.options.height-this.options.cellHeight-10)/this.core.sheetHeight;this.verBarDom.style.height=(this.options.height-this.options.cellHeight-10)*e+"px"}},{key:"registryHorScroll",value:function(){var e=this,t=document.createElement("div");t.style.height=this.barHeight+"px",t.style.width=this.options.width-this.options.cellHeight-10+"px",t.style.left=this.options.cellHeight+"px",t.style.bottom=0,t.style.position="absolute",this.canvasWrapperDom.appendChild(t),this.barHorContainerDom=t;var o=document.createElement("div");this.horBarDom=o;var l=this.core.sheetWidth>this.options.width?(this.options.width-this.options.cellHeight-10)/this.core.sheetWidth:1;o.style.width=(this.options.width-this.options.cellHeight-10)*l+"px",o.style.height=this.barHeight+"px",o.style.transformOrigin="left",o.style.userSelect="none",o.style.borderRadius=this.barHeight+"px",o.style.backgroundColor="rgb(201, 201, 201)",o.style.transform="translateX(".concat(this.barLeftDis+"px",")"),t.appendChild(o),o.onmouseover=function(e){o.style.backgroundColor="rgb(150, 150, 150)"},o.onmouseleave=function(e){o.style.backgroundColor="rgb(201, 201, 201)"},o.onmousedown=function(t){t.preventDefault(),document.onmousemove=function(l){o.style.backgroundColor="rgb(150, 150, 150)",e.layer.setCursorDefault(),requestAnimationFrame((function(){var o=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,n=l.pageX-o-(e.canvasWrapperDom.getBoundingClientRect().x+e.options.cellHeight)-t.offsetX;e.horMoveFunc(n)}))}}}},{key:"registryVerScroll",value:function(){var e=this,t=document.createElement("div");t.style.height=this.options.height-this.options.cellHeight-10+"px",t.style.width=this.barHeight+"px",t.style.right=0,t.style.top=this.options.cellHeight+"px",t.style.position="absolute",this.canvasWrapperDom.appendChild(t),this.barVerContainerDom=t;var o=document.createElement("div");this.verBarDom=o;var l=this.core.sheetHeight>this.options.height?(this.options.height-this.options.cellHeight-10)/this.core.sheetHeight:1;o.style.width=this.barHeight+"px",o.style.height=(this.options.height-this.options.cellHeight-10)*l+"px",o.style.transformOrigin="top",o.style.userSelect="none",o.style.backgroundColor="rgb(201, 201, 201)",o.style.borderRadius=this.barHeight+"px",o.onmouseover=function(e){o.style.backgroundColor="rgb(150, 150, 150)"},o.onmouseleave=function(e){o.style.backgroundColor="rgb(201, 201, 201)"},t.appendChild(o),this.registryWheel(o),o.onmousedown=function(t){t.preventDefault(),document.onmousemove=function(l){o.style.backgroundColor="rgb(150, 150, 150)",e.layer.setCursorDefault(),requestAnimationFrame((function(){var o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=l.pageY-o-(e.canvasWrapperDom.getBoundingClientRect().y+e.options.cellHeight)-t.offsetY;e.verMoveFunc(n)}))}}}},{key:"horMoveFunc",value:function(e){this.core.plugins.InputPlugin.hideInput();var t=this.core.sheetWidth>this.options.width?(this.options.width-this.options.cellHeight-10)/this.core.sheetWidth:1,o=1===t?0:this.options.width-this.options.cellHeight-10-(this.options.width-this.options.cellHeight)*t;e<=0?(this.horBarDom.style.transform="translateX(0px)",this.barLeftDis=0,this.leftDis=0,this.core.isScrollRightBound=!1):e>=o?(this.horBarDom.style.transform="translateX(".concat(o+"px",")"),this.barLeftDis=o,this.leftDis=-(this.core.sheetWidth-(this.options.width-this.options.cellHeight)),this.core.isScrollRightBound=!0):(this.horBarDom.style.transform="translateX(".concat(e+"px",")"),this.barLeftDis=Math.abs(e),this.leftDis=-e/t,this.core.offsetXLock=!1,this.core.isScrollRightBound=!1),this.core.offsetXLock||(1!==t&&(this.offsetX=Math.abs(this.leftDis),this.contentMoveX()),(e<=0||e>=o)&&(this.core.offsetXLock=!0))}},{key:"verMoveFunc",value:function(e){this.core.plugins.InputPlugin.hideInput();var t=this.core.sheetHeight>this.options.height?(this.options.height-this.options.cellHeight-10)/this.core.sheetHeight:1,o=1===t?0:this.options.height-this.options.cellHeight-10-(this.options.height-this.options.cellHeight)*t;e<=0?(this.verBarDom.style.transform="translateY(0px)",this.barTopDis=0,this.topDis=0,this.core.isScrollBottomBound=!1):e>=o?(this.verBarDom.style.transform="translateY(".concat(o+"px",")"),this.barTopDis=o,this.topDis=-(this.core.sheetHeight-(this.options.height-this.options.cellHeight)),this.core.isScrollBottomBound=!0):(this.verBarDom.style.transform="translateY(".concat(e+"px",")"),this.barTopDis=e,this.topDis=-e/t,this.core.offsetYLock=!1,this.core.isScrollBottomBound=!1),this.core.offsetYLock||(1!==t&&(this.offsetY=Math.abs(this.topDis),this.contentMoveY()),(e<=0||e>=o)&&(this.core.offsetYLock=!0))}}]),e}(),M=function(){function e(t,l){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"options",{}),i(this,"core",null),i(this,"selectorDom",null),i(this,"contentComponent",null),i(this,"headerComponent",null),i(this,"sideBorderLine",null),i(this,"dblClickContext",null),i(this,"clickContext",null),i(this,"inputDom",null),i(this,"rectContext",null),i(this,"headerBorderLine",null),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.wholeComponent=s.WholeComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.canvasWrapperDom=a.canvasWrapperDom,this.options=r,this.layer=l,this.core=a,this.appendInput(),a.plugins.ScrollPlugin.horBarDom.addEventListener("mousedown",(function(){n.inputDom.style.display="none"})),a.plugins.ScrollPlugin.verBarDom.addEventListener("mousedown",(function(){n.inputDom.style.display="none"}))}return n(e,[{key:"hideInput",value:function(){this.inputDom.style.display="none",this.inputDom.value="",this.inputDom.oninput=null}},{key:"setCellText",value:function(){this.contentComponent.clickCell.text=this.inputDom.value}},{key:"showInput",value:function(e){var t=this,o=this.inputDom,l=this.core.plugins.ScrollPlugin,n=l.offsetX,i=l.offsetY,r=this.options.cellHeight,s=e.x,a=e.y,c=e.width,h=e.height,d=e.text,u=e.isMerge,g=e.mergeWidth,p=e.mergeHeight,m=e.bgColor,f=e.fontColor,C=d.length*this.core.fontSize,v=u?g:c;o.style.opacity=1,o.style.top=a+r-i+"px",o.style.left=s+r-n+"px",o.style.display="inline-block",o.style.textAlign="center",o.style.width=(v>C?v:C)+"px",o.style.height=(u?p:h)+"px",o.style.borderRadius="6px",o.style.backgroundColor=null!=m?m:"",o.style.color=null!=f?f:"",o.value=d,o.oninput=function(e){t.core.plugins.SettingPlugin.setCellCon(e.target.value)},this.contentComponent.hideCellPainterDom()}},{key:"appendInput",value:function(){var e=this,t=document.createElement("input");this.inputDom=t,t.style.display="none",t.style.position="absolute",t.style.outline="none",t.style.border="2px solid "+this.core.selectedBorderBgColor,t.style.boxSizing="border-box",this.canvasWrapperDom.appendChild(t),this.canvasDom.addEventListener("dblclick",(function(o){e.contentComponent.hideSelectedCellDom();var l=e.options.cellHeight;if(!(o.offsetX<=l||o.offsetY<=l)){e.core.plugins.SelectPlugin.clearCopyDash();var n=e.core.plugins.ScrollPlugin,i=n.offsetX,r=n.offsetY,s=e.contentComponent.clickCell,a=s.x,c=s.y,h=s.width,d=s.height,u=s.text,g=s.isMerge,p=s.mergeWidth,m=s.mergeHeight,f=s.bgColor,C=s.fontColor;e.core.fresh();var v=g?p:h,y=u.length*e.core.fontSize;t.style.opacity=1,t.style.top=c+l-r+"px",t.style.left=a+l-i+"px",t.style.display="inline-block",t.style.textAlign="center",t.style.width=(v>y?v:y)+"px",t.style.height=(g?m:d)+"px",t.style.borderRadius="6px",t.style.backgroundColor=null!=f?f:"",t.style.color=null!=C?C:"",t.value=u,t.focus(),t.onblur=function(o){t.value?(o.relatedTarget&&e.selectorDom.contains(o.relatedTarget)||e.core.plugins.SettingPlugin.changeStepArr({type:1,label:s.label,pre:s.text,next:t.value}),s.text=t.value,e.core.ws.wsSend(1,s),e.inputDom.value="",e.core.fresh(),e.hideInput()):e.hideInput()},t.oninput=function(t){e.core.plugins.SettingPlugin.setCellCon(t.target.value)},e.contentComponent.hideCellPainterDom()}}))}}]),e}(),I=function(){function e(t,l){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"options",{}),i(this,"core",null),i(this,"selectorDom",null),i(this,"contentComponent",null),i(this,"headerComponent",null),i(this,"sideBorderLine",null),i(this,"clickContext",null),i(this,"inputDom",null),i(this,"copyKey",["text","mergeWidth","mergeHeight","mergeRow","mergeCol","isMerge","bgColor","fontColor"]),i(this,"moreShiftSelectClick",(function(e){if(n.core.shiftKey){var t=n.options.cellHeight,o=n.core.plugins.ScrollPlugin,l=o.offsetX,i=o.offsetY,r=n.contentComponent.clickCell,s=n.searchRectAddr(e.offsetX+l-t,e.offsetY+i-t);if(s.isMerge){var a=s.x>r.x,c=s.y>r.y;a&&!c?s=n.searchRectByColAndRow(s.col+s.mergeCol-1,s.row):a&&c?s=n.searchRectByColAndRow(s.col+s.mergeCol-1,s.row+s.mergeRow-1):!a&&c&&(s=n.searchRectByColAndRow(s.col,s.row+s.mergeRow-1))}n.contentComponent.setSecondClickCell(s),n.core.fresh()}})),i(this,"moreCtrlSelectClick",(function(e){if(n.core.shiftKey){var t=n.options.cellHeight,o=n.core.plugins.ScrollPlugin,l=o.offsetX,i=o.offsetY,r=n.searchRectAddr(e.offsetX+l-t,e.offsetY+i-t);n.contentComponent.setSecondClickCell(r),n.core.fresh()}})),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.settingPlugin=a.plugins.SettingPlugin,this.options=r,this.layer=l,this.core=a,this.showClickHandler(),this.moreSelect(),this.displayColTextRegister()}return n(e,[{key:"searchRectIsMergeInTwoCell",value:function(e,t){var o=this.contentComponent.contentGroup;return null===t?e.isMerge:o.filter((function(o){return o.col>=e.col&&o.row>=e.row&&o.col<=t.col&&o.row<=t.row})).some((function(e){return e.isMerge}))}},{key:"displayAllTextByCol",value:function(e,t){var o=this,l=this.options.cellHeight,n=this.contentComponent.contentGroup.filter((function(t){return t.col===e})).map((function(e){return o.layer.ctx.measureText(e.text).width+l}));n.push(t);var i=n.sort((function(e,t){return e-t}))[n.length-1];this.core.plugins.DragPlugin.expandWidthNoDrag(e,i-t)}},{key:"displayColTextRegister",value:function(){var e=this;this.canvasDom.addEventListener("dblclick",(function(t){var o=e.options.cellHeight,l=e.core.plugins.ScrollPlugin,n=l.offsetX;l.offsetY;var i=t.offsetX+n;if(t.offsetY<=o){for(var r=null,s=e.headerComponent.headerRectGroup,a=0;a<s.length;a++){var c=s[a];if(i>c.ltX&&i<c.ltX+c.width){r=c;break}}e.displayAllTextByCol(r.col,r.width)}}))}},{key:"copyText",value:function(e){navigator.clipboard&&navigator.clipboard.writeText(e)}},{key:"searchMergeArr",value:function(e,t,o,l){var n=[];return this.contentComponent.contentGroup.forEach((function(i){i.col>=e&&i.col<=o&&i.row>=t&&i.row<=l&&n.push(i)})),n.splice(1,n.length)}},{key:"copyRect",value:function(e,t){var o=e.width,l=e.height,n=this.searchMergeArr(e.col,e.row,e.col+t.mergeCol-1,e.row+t.mergeRow-1);e.mergeEndLabel=n[n.length-1].label,e.mergeStartLabel=e.label,e.isMerge=!0,n.forEach((function(t){t.isMerge=!0,t.mergeStartLabel=e.label,t.mergeEndLabel=n[n.length-1].label,e.row===t.row&&e.label!==t.label&&(o+=t.width),e.col===t.col&&e.label!==t.label&&(l+=t.height)})),e.mergeWidth=o,e.mergeHeight=l}},{key:"setCellAttr",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["row","col","x","y","ltX","ltY","mergeStartLabel","mergeEndLabel","label","isFromExcel","width","height"];for(var l in t)o.includes(l)||(e[l]=t[l]);t.isMerge&&(e.mergeStartLabel=String.fromCharCode(65+e.col-1)+e.row,e.mergeEndLabel=String.fromCharCode(65+e.col+e.mergeCol-2)+(e.row+e.mergeRow-1))}},{key:"copyCellAttr",value:function(e,t){for(var o in t)e[o]=t[o]}},{key:"tableDomToArr",value:function(e){for(var t=[],o=e.querySelectorAll("tr"),l=0;l<o.length;l++){t[l]=[];for(var n=o[l].querySelectorAll("td"),i=0;i<n.length;i++)t[l].push(n[i])}return t}},{key:"transformTableDomStrToDom",value:function(e){var t=this.core.h,o=(new DOMParser).parseFromString(e,"text/html");!o.querySelector("style")||o.querySelector("style").sheet.cssRules;var l=o.querySelector("table");if(!l)return null;for(var n=this.tableDomToArr(l),i=t("td"),r=function(e){for(var t=n[e],o=function(o){var l=t[o];if(l||n[e].push(i.cloneNode()),l.rowSpan>1)for(var r=1,s=l.rowSpan;r<s;r++)n[e+r].splice(o,0,i.cloneNode());l.colSpan>1&&new Array(l.colSpan-1).fill(0).forEach((function(t){n[e].splice(o+1,0,i.cloneNode())}))},l=0;l<t.length;l++)o(l)},s=0;s<n.length;s++)r(s);return n}},{key:"transformTableDomStrToCanvasCell",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=this.core.h,n=(new DOMParser).parseFromString(e,"text/html"),i=n.querySelector("style")?n.querySelector("style").sheet.cssRules:[],r=n.querySelector("table");if(r){for(var s=r.querySelectorAll("tr"),a=this.tableDomToArr(r),c=l("td"),h=function(e){for(var t=a[e],o=function(o){var l=t[o];if(l||a[e].push(c.cloneNode()),l.rowSpan>1)for(var n=1,i=l.rowSpan;n<i;n++)a[e+n].splice(o,0,c.cloneNode());l.colSpan>1&&new Array(l.colSpan-1).fill(0).forEach((function(t){a[e].splice(o+1,0,c.cloneNode())}))},l=0;l<t.length;l++)o(l)},d=0;d<a.length;d++)h(d);a.length;for(var u=0;u<a.length;u++)for(var g=a[u],p=0;p<g.length;p++){var m=g[p],f={};if(g[p].getAttribute("data-json"))f=JSON.parse(g[p].getAttribute("data-json"));else{for(var C,v,y="",w="",b=null,S="",x=0,k=i.length;x<k;x++)m.className===i[x].selectorText.replace(".","")&&(y=""!==i[x].style.backgroundColor?i[x].style.backgroundColor:null,w=""!==i[x].style.color?i[x].style.color:null,""===i[x].style.textAlign||i[x].style.textAlign,b=""!==i[x].style.fontSize?i[x].style.fontSize.replace("pt",""):12,S=""!==i[x].style.fontFamily?i[x].style.fontFamily:null);v=b+" "+S,f={mergeRow:m.rowSpan>1?m.rowSpan:m.colSpan>1?1:0,mergeCol:m.colSpan>1?m.colSpan:m.rowSpan>1?1:0,isMerge:m.colSpan&&m.colSpan>1||m.rowSpan&&m.rowSpan>1,text:m.innerText,isFromExcel:!0,bgColor:y,fontColor:w,font:v,fontSize:null!==(C=b)&&void 0!==C?C:12,fontFamily:S}}var D=this.searchRectByColAndRow(t.col+p,t.row+u);if(u===s.length-1&&g.length,f.isMerge)for(var M=D.row+f.mergeRow,I=D.col+f.mergeCol,A=D.row;A<M;A++)for(var L=D.col;L<I;L++)if(A===D.row&&L===D.col)this.setCellAttr(D,f),f.isFromExcel&&(D.mergeWidth=D.width,D.mergeHeight=D.height);else{var B=this.searchRectByColAndRow(L,A);B.isMerge=!0,B.mergeStartLabel=D.mergeStartLabel,B.mergeEndLabel=D.mergeEndLabel,f.isFromExcel&&(B.col===D.col&&(D.mergeHeight+=B.height),B.row===D.row&&(D.mergeWidth+=B.width))}else D.isMerge||this.setCellAttr(D,f)}o&&this.contentComponent.showClickRect(t),this.core.fresh()}}},{key:"transformCanvasCellToTableDomStr",value:function(){var e=this.contentComponent,t=e.clickCell,o=e.secondClickCell,l=e.clickRectShow,n=e.moreSelectedCell,i=this.core.h;if(l){var r=i("table"),s=i("tr"),a=i("td");if(t&&!o)if(t.isMerge)for(var c=t.row+t.mergeRow,h=t.row;h<c;h++){var d=s.cloneNode();if(h===t.row){var u=a.cloneNode();this.setTdAttrs(u,t),d.appendChild(u)}r.appendChild(d)}else{var g=s.cloneNode(),p=a.cloneNode();this.setTdAttrs(p,t),g.appendChild(p),r.appendChild(g)}else if(o)for(var m=0,f=null,C=0;C<n.length;C++){var v=n[C];if(m!==v.row&&(m=v.row,f=s.cloneNode(),r.appendChild(f)),v.isMerge&&v.label===v.mergeStartLabel||!v.isMerge){var y=a.cloneNode();this.setTdAttrs(y,v),f.appendChild(y)}}var w=r.outerHTML;return s.remove(),a.remove(),w}}},{key:"transformCanvasCellToTableDomStrByParams",value:function(e,t,o,l){var n=this.core.h;if(o){var i=n("table"),r=n("tr"),s=n("td");if(e&&!t)if(e.isMerge)for(var a=e.row+e.mergeRow,c=e.row;c<a;c++){var h=r.cloneNode();if(c===e.row){var d=s.cloneNode();this.setTdAttrs(d,e),h.appendChild(d)}i.appendChild(h)}else{var u=r.cloneNode(),g=s.cloneNode();this.setTdAttrs(g,e),u.appendChild(g),i.appendChild(u)}else if(t)for(var p=0,m=null,f=0;f<l.length;f++){var C=l[f];if(p!==C.row&&(p=C.row,m=r.cloneNode(),i.appendChild(m)),C.isMerge&&C.label===C.mergeStartLabel||!C.isMerge){var v=s.cloneNode();this.setTdAttrs(v,C),m.appendChild(v)}}var y=i.outerHTML;return r.remove(),s.remove(),y}}},{key:"searchPastePositionCells",value:function(e,t,o){for(var l=[],n=e+o.col,i=t+o.row,r=o.row;r<=i;r++)for(var s=o.col;s<=n;s++)l.push(this.contentComponent.searchRectByColAndRow(s,r));return l}},{key:"forcePasteCellToNewCell",value:function(e){var t=this;e.forEach((function(e){var o=t.contentComponent.searchRectByLabel(e.label);t.copyCellAttr(o,e)}))}},{key:"forcePasteCellToNewCellByTargetCell",value:function(e,t){var o=this,l=e[0];e.forEach((function(e){var n=o.contentComponent.searchRectByColAndRow(e.col-l.col+t.col,e.row-l.row+t.row);o.copyCellAttr(n,e)}))}},{key:"clearCopyDash",value:function(){this.copyText(""),this.core.copyKey=!1,this.core.copyCellDash=[],this.core.freshContent()}},{key:"moreSelect",value:function(){var e=this;document.addEventListener("paste",(function(t){var o=e.contentComponent,l=o.clickRectShow,n=o.clickCell,i=t.clipboardData.getData("text/html"),r=e.transformTableDomStrToDom(i);if(Array.isArray(r)&&!r[0][0].getAttribute("data-json")){var s,a=r.length,c=r[0].length;return s=JSON.stringify(e.searchPastePositionCells(c-1,a-1,n)),e.core.plugins.SettingPlugin.changeStepArr({type:15,pre:{label:n.label,pasteStr:s},next:{label:n.label,pasteStr:i}}),e.core.ws.wsSend(15,{pasteStr:i,label:n.label}),e.transformTableDomStrToCanvasCell(i,n),void e.contentComponent.setSecondClickCell(null)}if(1===e.core.copyCellDash.length){if(e.searchRectIsMergeInTwoCell(n,null))return void e.settingPlugin.showDialog("提示","合并的单元格无法粘贴内容");var h=e.core.copyCellDash[0];if(h.isMerge){var d=e.contentComponent.searchRectByColAndRow(n.col+h.mergeCol-1,n.row+h.mergeRow-1);if(e.searchRectIsMergeInTwoCell(n,d))return void e.settingPlugin.showDialog("提示","合并的单元格无法粘贴内容")}}else if(e.core.copyCellDash.length>1){var u=e.core.copyCellDash[0],g=e.core.copyCellDash[e.core.copyCellDash.length-1],p=e.contentComponent.searchRectByColAndRow(n.col+g.col-u.col,n.row+g.row-u.row);if(e.searchRectIsMergeInTwoCell(n,p))return void e.settingPlugin.showDialog("提示","合并的单元格无法粘贴内容")}if(l&&e.core.copyCellDash.length>0){var m="",f=e.core.copyCellDash[0],C=e.core.copyCellDash[e.core.copyCellDash.length-1];m=1===e.core.copyCellDash.length?JSON.stringify(e.searchPastePositionCells(f.mergeCol-1,f.mergeRow-1,n)):JSON.stringify(e.searchPastePositionCells(C.col-f.col,C.row-f.row,n)),e.core.plugins.SettingPlugin.changeStepArr({type:15,pre:{label:n.label,pasteStr:m},next:{label:n.label,pasteStr:i}}),e.core.ws.wsSend(15,{pasteStr:i,label:n.label}),e.transformTableDomStrToCanvasCell(i,n),e.contentComponent.setSecondClickCell(null)}})),document.addEventListener("copy",(function(t){t.preventDefault(),e.core.copyCellDash=[];var o=e.transformCanvasCellToTableDomStr();t.clipboardData.setData("text/html",o);var l=e.contentComponent,n=l.clickCell,i=l.moreSelectedCell;if(e.core.copyKey=!0,i.length>0)e.core.copyCellDash=i;else{if(!n)return;e.core.copyCellDash=[n]}e.core.freshContent()})),document.addEventListener("keydown",(function(t){e.core.shiftKey=t.shiftKey,e.core.ctrlKey=t.ctrlKey,t.shiftKey&&t.ctrlKey&&"KeyZ"===t.code||t.ctrlKey&&"z"===t.code||"Escape"===t.code&&e.clearCopyDash()})),document.addEventListener("keyup",(function(t){e.core.shiftKey=t.shiftKey,e.core.ctrlKey=t.ctrlKey})),this.canvasDom.addEventListener("mousedown",this.moreShiftSelectClick)}},{key:"setTdAttrs",value:function(e,t){t.isMerge&&(e.rowSpan=t.mergeRow,e.colSpan=t.mergeCol),e.innerText=t.text,e.style.backgroundColor=t.bgColor,e.style.color=t.fontColor,e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.textAlign=t.textAlign,e.setAttribute("data-json",JSON.stringify(t))}},{key:"showClickHandler",value:function(){var e=this;this.canvasDom.addEventListener("mousedown",(function(t){if(!(2===t.button&&e.contentComponent.secondClickCell||(e.core.plugins.ContextmenuPlugin.hideContextMenu(),e.core.plugins.BookPlugin.hideContextMenu(),e.core.shiftKey||e.core.ctrlKey||e.core.dragSign))){var o=e.options,l=o.cellHeight;o.cellWidth;var n=e.core.plugins.ScrollPlugin,i=n.offsetX,r=n.offsetY;if(n.topDis,n.barVerContainerDom,n.barHorContainerDom,t.offsetY<=l&&t.offsetX<=l)e.contentComponent.setSecondClickCell(null),e.contentComponent.showClickRect({},!0,!0),e.contentComponent.hideSelectedCellDom();else if(t.offsetY<=l&&t.offsetX>l){var s=e.searchHeaderRectAddr(t.offsetX+i-l);s&&(e.contentComponent.setSecondClickCell(null),e.contentComponent.showClickRect(s,!0)),e.contentComponent.hideSelectedCellDom()}else if(t.offsetY>l&&t.offsetX<=l){var a=e.searchSideRectAddr(t.offsetY+r-l);a&&(e.contentComponent.setSecondClickCell(null),e.contentComponent.showClickRect(a,!1,!0)),e.contentComponent.hideSelectedCellDom()}else{var c=e.searchRectAddr(t.offsetX+i-l,t.offsetY+r-l);c&&(e.contentComponent.showClickRect(c),e.core.plugins.SettingPlugin.setCellAttrInHeader(c),e.contentComponent.setSecondClickCell(null),e.canvasDom.onmousemove=function(t){var o,n=e.core.plugins.ScrollPlugin,i=n.offsetX,r=n.offsetY,s=e.searchRectAddr(t.offsetX+i-l,t.offsetY+r-l);if(s&&c.label===s.label)e.contentComponent.setSecondClickCell(null);else if(s&&s.label!==(null===(o=e.contentComponent.secondClickCell)||void 0===o?void 0:o.label)){var a=s.x>c.x,h=s.y>c.y;s.isMerge&&(a&&!h?s=e.searchRectByColAndRow(s.col+s.mergeCol-1,s.row):a&&h?s=e.searchRectByColAndRow(s.col+s.mergeCol-1,s.row+s.mergeRow-1):!a&&h&&(s=e.searchRectByColAndRow(s.col,s.row+s.mergeRow-1))),e.contentComponent.setSecondClickCell(s),e.core.fresh()}})}e.core.fresh()}}))}},{key:"searchRectIsMerge",value:function(e,t,o,l){var n=this.contentComponent.contentGroup.find((function(n){return n.x>=e&&n.x<=o&&n.y>=t&&n.y<=l&&n.isMerge}));return n?{startRect:this.searchRectByLabel(n.mergeStartLabel),endRect:this.searchRectByLabel(n.mergeEndLabel)}:null}},{key:"searchRectByLabel",value:function(e){var t=this.contentComponent.contentGroup,o=t.findIndex((function(t){return t.label===e}));return-1!==o?t[o]:null}},{key:"searchRectByColAndRow",value:function(e,t){var o=this.contentComponent.contentGroup,l=o.findIndex((function(o){return o.col===e&&o.row===t}));return-1!==l?o[l]:null}},{key:"searchRectAddr",value:function(e,t){for(var o,l=this.contentComponent.contentGroup,n=function(){var o=l[i];if(e>=o.x&&e<=o.x+o.width&&t>=o.y&&t<=o.y+o.height){if(o.isMerge){if(o.label===o.mergeStartLabel)return{v:o};var n=l.findIndex((function(e){return e.label===o.mergeStartLabel}));return{v:l[n]}}return{v:o}}},i=0;i<l.length;i++)if(o=n())return o.v}},{key:"searchHeaderRectAddr",value:function(e){for(var t=this.headerComponent.headerRectGroup,o=0;o<t.length;o++){var l=t[o];if(e>=l.x&&e<=l.x+l.width)return l}}},{key:"searchSideRectAddr",value:function(e){for(var t=this.sideComponent.sideRectGroup,o=0;o<t.length;o++){var l=t[o];if(e>=l.y&&e<=l.y+l.height)return l}}}]),e}(),A=function(){function e(t,l){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"dragShowDis",6),i(this,"dragCell",null),i(this,"stepObj",{}),this.contentComponent=r.ContentComponent,this.headerComponent=r.HeaderComponent,this.sideComponent=r.SideComponent,this.selectorDom=t,this.canvasDom=s.canvasDom,this.options=n,this.layer=l,this.core=s,this.registerDragEvent()}return n(e,[{key:"expandWidthNoDrag",value:function(e,t){for(var o=this.contentComponent.contentGroup,l=0;l<o.length;l++){var n=o[l];if(!(n.col<e)&&(n.col===e?n.width+=t:n.col>e&&(n.x+=t,n.ltX+=t),n.col===e&&1===n.row&&(this.core.sheetWidth+=t),n.isMerge&&n.mergeStartLabel===n.label&&n.col===e&&(n.mergeWidth+=t),n.isMerge&&n.mergeStartLabel!==n.label&&n.col===e)){var i=this.contentComponent.searchRectByLabel(n.mergeStartLabel);i.row===n.row&&(i.mergeWidth+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"expandHeightNoDrag",value:function(e,t){for(var o=this.contentComponent.contentGroup,l=0;l<o.length;l++){var n=o[l];if(n.row===e?n.height+=t:n.row>e&&(n.y+=t,n.ltY+=t),n.row===e&&1===n.col&&(this.core.sheetHeight+=t),n.isMerge&&n.mergeStartLabel===n.label&&n.row===e&&(n.mergeHeight+=t),n.isMerge&&n.mergeStartLabel!==n.label&&n.row===e){var i=this.contentComponent.searchRectByLabel(n.mergeStartLabel);i.col===n.col&&(i.mergeHeight+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"expandWidth",value:function(e,t){var o=this.contentComponent.contentGroup,l=this.options.cellHeight;if(this.layer.setCursor("col-resize"),!this.dragCell||this.dragCell.width+t<l&&t<0)return this.stepObj.next={width:l},void(this.dragCell=null);for(var n=0;n<o.length;n++){var i=o[n];if(!(i.col<e)&&(i.col===e?i.width+=t:i.col>e&&(i.x+=t,i.ltX+=t),i.col===e&&1===i.row&&(this.core.sheetWidth+=t),i.isMerge&&i.mergeStartLabel===i.label&&i.col===e&&(i.mergeWidth+=t),i.isMerge&&i.mergeStartLabel!==i.label&&i.col===e)){var r=this.contentComponent.searchRectByLabel(i.mergeStartLabel);r.row===i.row&&(r.mergeWidth+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"expandHeight",value:function(e,t){var o=this.contentComponent.contentGroup,l=this.options.cellHeight;if(this.layer.setCursor("col-resize"),!this.dragCell||this.dragCell.height+t<l&&t<0)return this.stepObj.next={height:l},void(this.dragCell=null);for(var n=0;n<o.length;n++){var i=o[n];if(i.row===e?i.height+=t:i.row>e&&(i.y+=t,i.ltY+=t),i.row===e&&1===i.col&&(this.core.sheetHeight+=t),i.isMerge&&i.mergeStartLabel===i.label&&i.row===e&&(i.mergeHeight+=t),i.isMerge&&i.mergeStartLabel!==i.label&&i.row===e){var r=this.contentComponent.searchRectByLabel(i.mergeStartLabel);r.col===i.col&&(r.mergeHeight+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"registerDragEvent",value:function(){var e=this;this.canvasDom.addEventListener("mouseup",(function(o){if(e.core.lockDrag=!1,e.dragCell){e.stepObj.next={width:e.dragCell.width,height:e.dragCell.height};var l=0;11===e.stepObj.type&&(l=e.stepObj.next.width-e.stepObj.pre.width),12===e.stepObj.type&&(l=e.stepObj.next.height-e.stepObj.pre.height),e.core.plugins.SettingPlugin.changeStepArr(JSON.parse(JSON.stringify(e.stepObj))),e.core.ws.wsSend(e.stepObj.type,t({dis:l},e.stepObj))}})),this.canvasDom.addEventListener("mousedown",(function(t){if(e.core.lockDrag=!0,e.dragCell&&e.core.dragSign){e.stepObj.pre={},e.stepObj.label=e.dragCell.label,e.stepObj.pre.width=e.dragCell.width,e.stepObj.pre.height=e.dragCell.height;var o=0,l=t.pageX,n=0,i=t.pageY;e.canvasDom.onmousemove=function(t){if(!e.dragCell)return!1;e.core.dragSignDirectionIsHor?(o=t.pageX,e.stepObj.type=11,e.expandWidth(e.dragCell.col,o-l),l=o):(n=t.pageY,e.stepObj.type=12,e.expandHeight(e.dragCell.row,n-i),i=n)}}})),this.canvasDom.addEventListener("mousemove",(function(t){if(e.core.lockDrag)return!1;var o=e.headerComponent.headerRectGroup,l=e.sideComponent.sideRectGroup,n=e.core.plugins.ScrollPlugin,i=n.offsetX,r=n.offsetY,s=e.options.cellHeight,a=e.dragShowDis,c=t.offsetX+i,h=t.offsetY+r;if(e.dragCell&&(c<e.dragCell.ltX+e.dragCell.width-a||c>e.dragCell.ltX+e.dragCell.width+a+1)&&(e.core.dragSign=!1,e.dragCell=null),e.dragCell&&(h<e.dragCell.ltY+e.dragCell.height-a||c>e.dragCell.ltY+e.dragCell.height+a+1)&&(e.core.dragSign=!1,e.dragCell=null),!e.core.lockDrag){if(t.offsetY<=s){t.offsetX>s&&e.layer.setCursor("s-resize");for(var d=0;d<o.length;d++){var u=o[d];c>u.ltX+u.width-a&&c<u.ltX+u.width+a+1&&(e.core.dragSign||(e.dragCell=u),e.layer.setCursor("col-resize"),e.core.dragSign=!0,e.core.dragSignDirectionIsHor=!0)}}if(t.offsetX<=s){t.offsetY>s&&e.layer.setCursor("e-resize");for(var g=0;g<l.length;g++){var p=l[g];h>p.ltY+p.height-a&&h<p.ltY+p.height+a+1&&(e.core.dragSign||(e.dragCell=p),e.layer.setCursor("row-resize"),e.core.dragSign=!0,e.core.dragSignDirectionIsHor=!1)}}}}))}}]),e}(),L=function(){function e(t,l){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"containerDom",null),i(this,"hideContextMenu",(function(){n.containerDom.style.display="none"})),i(this,"insertRow",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var l=n.core.col,i=n.options,r=i.cellWidth,s=i.cellHeight,a=n.contentComponent.contentGroup;n.core.sheetHeight+=t*s;for(var c=n.contentComponent.searchRectIndexByColAndRow(1,o?e:e+1),h=function(){var t=a[c];new Array(l).fill(void 0).forEach((function(o,n){a.splice(c,0,{row:e,col:l-n,text:"",width:r,height:s,x:t.x,y:t.y,ltX:t.ltX,ltY:t.ltY,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:null,fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",label:"insert"})}))},d=1;d<=t;d++)h();n.contentComponent.initContentGroupRowAndColByRow(e,t),n.core.fresh(),n.core.plugins.ScrollPlugin.changeVerBarHeight()}})),i(this,"insertCol",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var l=n.core.row,i=n.options,r=i.cellWidth,s=i.cellHeight,a=n.contentComponent.contentGroup;n.core.sheetWidth+=t*r;for(var c=function(l){var i=n.contentComponent.searchRectIndexByColAndRow(e,l),c=a[i];new Array(t).fill(void 0).forEach((function(t){a.splice(o?i:i+1,0,{row:l,col:e,text:"",width:r,height:s,x:c.x,y:c.y,ltX:c.ltX,ltY:c.ltY,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:null,fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",label:"insert"})}))},h=1;h<=l;h++)c(h);n.contentComponent.initContentGroupRowAndColByCol(e,t),n.core.fresh(),n.core.plugins.ScrollPlugin.changeHorBarWidth()}})),i(this,"removeCol",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var l=n.core.row,i=n.options,r=i.cellWidth;i.cellHeight;var s=n.contentComponent.contentGroup;n.core.sheetWidth-=t*r;for(var a=1;a<=l;a++)for(var c=0;c<t;c++){var h=n.contentComponent.searchRectIndexByColAndRow(o?e+c:e+1+c,a);s.splice(h,1)}n.contentComponent.initContentGroupRowAndColByCol(e,t,!1),n.core.fresh(),n.core.plugins.ScrollPlugin.changeHorBarWidth()}})),i(this,"removeRow",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var l=n.core.col,i=n.options;i.cellWidth;var r=i.cellHeight,s=n.contentComponent.contentGroup;n.core.sheetHeight-=t*r;for(var a=n.contentComponent.searchRectIndexByColAndRow(1,o?e:e+1),c=1;c<=t;c++)s.splice(a,l);n.contentComponent.initContentGroupRowAndColByRow(e,t,!1),n.core.fresh(),n.core.plugins.ScrollPlugin.changeVerBarHeight()}})),i(this,"splitCell",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.isMerge){e.mergeEndLabel="",e.mergeStartLabel="",e.isMerge=!1;for(var o=e.row,l=e.row+e.mergeRow;o<l;o++)for(var i=e.col,r=e.col+e.mergeCol;i<r;i++)if(o===e.row&&i===e.col);else{var s=n.contentComponent.searchRectByColAndRow(i,o);s.mergeEndLabel="",s.mergeStartLabel="",s.isMerge=!1}e.mergeRow=1,e.mergeCol=1,t&&n.contentComponent.showClickRect(e),n.core.fresh(),n.hideContextMenu()}else n.settingPlugin.showDialog("提示","当前选中的单元格不是合并的单元格无法拆解")})),i(this,"mergeCell",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t.some((function(e){return e.isMerge}))||0===t.length)n.settingPlugin.showDialog("提示","当前选中的单元格中有合并的单元格，无法合并");else{var l=e.width,i=e.height;e.mergeEndLabel=t[t.length-1].label,e.mergeStartLabel=e.label,e.isMerge=!0,e.mergeRow=1,e.mergeCol=1,t.forEach((function(o){o.isMerge=!0,o.mergeStartLabel=e.label,o.mergeEndLabel=t[t.length-1].label,e.row===o.row&&e.label!==o.label&&(l+=o.width,e.mergeCol+=1),e.col===o.col&&e.label!==o.label&&(i+=o.height,e.mergeRow+=1)})),e.mergeWidth=l,e.mergeHeight=i,n.contentComponent.setSecondClickCell(null),o&&n.contentComponent.showClickRect(e),n.core.freshContent(),n.hideContextMenu()}})),i(this,"eventInsertCol",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=n.contentComponent.clickCell;n.contentComponent.isHasMergerInRectArrByCol(o.col)||(n.core.plugins.SettingPlugin.changeStepArr({type:13,pre:{col:o.col,num:e,isLeft:t},next:{col:o.col,num:e,isLeft:t}}),n.core.ws.wsSend(13,{col:o.col,num:e,isLeft:t}),n.insertCol(o.col,e,t)),n.hideContextMenu()})),i(this,"eventInsertRow",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=n.contentComponent.clickCell;n.contentComponent.isHasMergerInRectArrByRow(o.row)||(n.core.plugins.SettingPlugin.changeStepArr({type:14,pre:{row:o.row,num:e,isTop:t},next:{row:o.row,num:e,isTop:t}}),n.core.ws.wsSend(14,{row:o.row,num:e,isTop:t}),n.insertRow(o.row,e,t)),n.hideContextMenu()})),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.canvasWrapperDom=a.canvasWrapperDom,this.settingPlugin=a.plugins.SettingPlugin,this.options=r,this.layer=l,this.core=a,this.registryContextMenu()}return n(e,[{key:"registryContextMenu",value:function(){var e=this,t=this.core.h,o=t("div",{style:{display:"none"},attr:{className:"e-sheet-contextmenu-layout"}}),l=t("div",{style:{cursor:"pointer"},attr:{innerText:"合并单元格",className:"item-btn"}}),n=t("div",{style:{cursor:"pointer"},attr:{innerText:"拆分单元格",className:"item-btn"}}),i=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"左侧插入",onclick:function(t){e.eventInsertCol(t.target.nextElementSibling.valueAsNumber)}}}),t("input",{attr:{type:"number",placeholder:"请输入列数",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.eventInsertCol(t.target.valueAsNumber),t.target.value=1)}}}),t("span",{attr:{innerText:"列"}})]),r=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"右侧插入",onclick:function(t){e.eventInsertCol(t.target.nextElementSibling.valueAsNumber,!1)}}}),t("input",{attr:{type:"number",placeholder:"请输入列数",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.eventInsertCol(t.target.valueAsNumber,!1),t.target.value=1)}}}),t("span",{attr:{innerText:"列"}})]),s=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"上侧插入",onclick:function(t){e.eventInsertRow(t.target.nextElementSibling.valueAsNumber)}}}),t("input",{attr:{type:"number",placeholder:"请输入行数",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.eventInsertRow(t.target.valueAsNumber),t.target.value=1)}}}),t("span",{attr:{innerText:"行"}})]),a=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"下侧插入",onclick:function(t){e.eventInsertRow(t.target.nextElementSibling.valueAsNumber,!1)}}}),t("input",{attr:{type:"number",placeholder:"请输入行数",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.contentComponent.clickCell,e.eventInsertRow(t.target.valueAsNumber,!1),t.target.value=1)}}}),t("span",{attr:{innerText:"行"}})]);this.containerDom=o,this.canvasDom.addEventListener("contextmenu",(function(t){t.preventDefault();var i=e.contentComponent.clickCell,r=e.options.cellHeight,s=e.core.plugins.ScrollPlugin;s.offsetX,s.offsetY,t.offsetX<=r||t.offsetY<=r||i&&(o.style.display="block",o.style.left=t.offsetX+"px",o.style.top=t.offsetY+"px",i.isMerge?(l.style.display="none",n.style.display="flex"):(n.style.display="none",l.style.display="flex"))})),l.onclick=function(t){var o=e.contentComponent,l=o.clickCell,n=o.mergeSelectedCell,i={type:9,label:l.label},r=[l].concat(p(n)).sort((function(e,t){return e.row-t.row+(e.col-t.col)}));i.pre=r[0].label,i.next=r.map((function(e){return e.label})),e.core.plugins.SettingPlugin.changeStepArr(i),e.core.plugins.SettingPlugin.wsSendInfoByTypeAndData(9,i.next),e.mergeCell(r[0],r.slice(0))},n.onclick=function(t){var o=e.contentComponent.clickCell,l={row:o.row,col:o.col,mergeRow:o.mergeRow,mergeCol:o.mergeCol,mergeStartLabel:o.mergeStartLabel,mergeEndLabel:o.mergeEndLabel,isMerge:!1};e.core.plugins.SettingPlugin.changeStepArr({type:10,label:o.label,pre:{row:o.row,col:o.col,mergeRow:o.mergeRow,mergeCol:o.mergeCol,mergeStartLabel:o.mergeStartLabel,mergeEndLabel:o.mergeEndLabel,isMerge:!0},next:l}),e.core.plugins.SettingPlugin.wsSendInfoByTypeAndData(10,l),e.splitCell(o)},o.appendChild(l),o.appendChild(n),o.appendChild(i),o.appendChild(r),o.appendChild(s),o.appendChild(a),this.canvasWrapperDom.appendChild(o)}}]),e}(),B=function(){function e(t,l){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"labelInputDom",null),i(this,"fxInputDom",null),i(this,"fontHorAddrGroup",null),i(this,"fontVerAddrGroup",null),i(this,"fontSizeSelectDom",null),i(this,"fontColorSelectDom",null),i(this,"bgColorSelectDom",null),i(this,"fontItalicBtnDom",null),i(this,"fontWeightBtnDom",null),i(this,"cellMergerBtnDom",null),i(this,"cellSplitBtnDom",null),i(this,"warnDialogDom",null),this.contentComponent=r.ContentComponent,this.headerComponent=r.HeaderComponent,this.sideComponent=r.SideComponent,this.selectorDom=t,this.canvasDom=s.canvasDom,this.canvasWrapperDom=s.canvasWrapperDom,this.options=n,this.layer=l,this.core=s,this.registrySettingDom(),this.registryWarnDialogDom()}return n(e,[{key:"registryWarnDialogDom",value:function(){var e=this.core.h;this.warnDialogDom=e("e-sheet-warn-dialog-tip",{attribute:{show:!1}}),this.selectorDom.appendChild(this.warnDialogDom)}},{key:"showDialog",value:function(e,t){this.warnDialogDom.setAttribute("t",e),this.warnDialogDom.setAttribute("content",t),this.warnDialogDom.setAttribute("show",!0)}},{key:"setLabelCon",value:function(e){this.labelInputDom.value=e}},{key:"setCellCon",value:function(e){this.fxInputDom.value=e}},{key:"cellFontTextAlignChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.textAlign=e,this.core.freshContent())}},{key:"cellFontTextBaseLineChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.textBaseline=e,this.core.freshContent())}},{key:"cellFontSizeChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontSize=e,this.core.freshContent())}},{key:"cellFontColorChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontColor=e,this.core.freshContent())}},{key:"cellBgColorChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.bgColor=e,this.core.freshContent())}},{key:"cellFontWeightChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontWeight=e,this.core.freshContent())}},{key:"cellFontItalicChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontItalic=e,this.core.freshContent())}},{key:"setCellAttrInHeader",value:function(e){this.fontHorAddrGroup.setAttribute("value",e.textAlign),this.fontVerAddrGroup.setAttribute("value",e.textBaseline),this.fontSizeSelectDom.setAttribute("value",e.fontSize),this.fontWeightBtnDom.setAttribute("current",e.fontWeight),this.fontItalicBtnDom.setAttribute("current",e.fontItalic),e.isMerge?(this.cellMergerBtnDom.style.display="none",this.cellSplitBtnDom.style.display="flex"):(this.cellMergerBtnDom.style.display="flex",this.cellSplitBtnDom.style.display="none"),this.setLabelCon(e.label),this.setCellCon(e.text)}},{key:"changeFirstSelectedCell",value:function(e){var t=this.contentComponent.searchRectByLabel(e);t&&(this.contentComponent.showClickRect(t),this.setCellAttrInHeader(t),this.setCellCon(t.text),this.contentComponent.setSecondClickCell(null),this.core.fresh())}},{key:"convenientChangeStepArr",value:function(e,t,o){var l=this.contentComponent.clickCell;this.changeStepArr({type:e,label:l.label,pre:l[t],next:o})}},{key:"convenientGroupChangeStepArr",value:function(e){var t=this.contentComponent,o=t.clickCell,l=t.contentGroup;this.changeStepArr({label:null!=e?e:o.label,sheet:JSON.stringify(l)})}},{key:"changeStepArr",value:function(e){var t=this.core.getCurrentSheet();this.core.stepCallbackArr.forEach((function(t){t(JSON.parse(e))})),t.stepNum!==t.stepArr.length-1?-1===t.stepNum?t.stepArr.splice(t.stepNum+1,t.stepArr.length,e):t.stepArr.splice(t.stepNum+1,t.stepArr.length-1-t.stepNum,e):t.stepArr.push(e),t.stepNum+=1}},{key:"forwardSetSheet",value:function(){var e=this,o=this.core,l=this.contentComponent,n=o.getCurrentSheet(),i=o.ws;if(n.stepNum!==n.stepArr.length-1){var r=n.stepArr[n.stepNum+1],s=l.searchRectByLabel(r.label);switch(r.type){case 1:s.text=r.next,l.showClickRect(s),i.wsSend(0,s);break;case 2:s.fontSize=r.next;break;case 3:s.textAlign=r.next;break;case 4:s.textBaseline=r.next;break;case 5:s.fontWeight=r.next;break;case 6:s.fontItalic=r.next;break;case 7:s.fontColor=r.next;break;case 8:s.bgColor=r.next;break;case 9:for(var a=[],c=1;c<r.next.length;c++)a.push(l.searchRectByLabel(r.next[c]));var h=l.searchRectByLabel(r.next[0]);this.wsSendInfoByTypeAndData(9,r.next),this.core.plugins.ContextmenuPlugin.mergeCell(h,a);break;case 10:var d=l.searchRectByColAndRow(r.next.col,r.next.row);this.wsSendInfoByTypeAndData(10,t({},r.next)),this.core.plugins.ContextmenuPlugin.splitCell(d);break;case 11:this.core.plugins.DragPlugin.expandWidthNoDrag(s.col,r.next.width-r.pre.width),this.core.ws.wsSend(11,t({dis:r.next.width-r.pre.width},r));break;case 12:this.core.plugins.DragPlugin.expandHeightNoDrag(s.row,r.next.height-r.pre.height),this.core.ws.wsSend(12,t({dis:r.next.height-r.pre.height},r));break;case 13:this.core.ws.wsSend(13,t({},r.next)),this.core.plugins.ContextmenuPlugin.insertCol(r.next.col,r.next.num,r.next.isLeft);break;case 14:this.core.ws.wsSend(14,t({},r.next)),this.core.plugins.ContextmenuPlugin.insertRow(r.next.row,r.next.num,r.next.isTop);break;case 15:var u=this.contentComponent.searchRectByLabel(r.next.label);this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(r.next.pasteStr,u);break;case 16:this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(r.pre.lastStr));var g=this.contentComponent.searchRectByLabel(r.next.label);this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(r.next.lastStr,g),this.contentComponent.setSecondClickCell(null),this.core.ws.wsSend(16,{pre:r.pre.lastStr,next:r.next.lastStr,label:r.next.label});break;case 17:r.next.forEach((function(t){var o=e.contentComponent.searchRectByLabel(t.label);e.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(t.tableDomStr,o)})),this.core.ws.wsSend(17,{next:r.next})}[1,2,3,4,5,6,7,8].includes(r.type)&&this.wsSendCellAttrByTypeAndData(r.type),o.fresh(),n.stepNum+=1}}},{key:"fallbackSetSheet",value:function(){var e=this,o=this.core,l=this.contentComponent,n=o.getCurrentSheet(),i=o.ws;if(-1!==n.stepNum){var r=n.stepArr[0===n.stepNum?0:n.stepNum],s=l.searchRectByLabel(r.label);switch(r.type){case 1:s.text=r.pre,l.showClickRect(s),i.wsSend(0,s);break;case 2:s.fontSize=r.pre;break;case 3:s.textAlign=r.pre;break;case 4:s.textBaseline=r.pre;break;case 5:s.fontWeight=r.pre;break;case 6:s.fontItalic=r.pre;break;case 7:s.fontColor=r.pre;break;case 8:s.bgColor=r.pre;break;case 9:var a=l.searchRectByLabel(r.pre);this.wsSendInfoByTypeAndData(9,{label:r.pre,undo:!0}),this.core.plugins.ContextmenuPlugin.splitCell(a);break;case 10:for(var c=[],h=0;h<r.pre.mergeRow;h++)for(var d=0;d<r.pre.mergeCol;d++)0===h&&0===d||c.push(l.searchRectByColAndRow(r.pre.col+d,r.pre.row+h));var u=l.searchRectByLabel(r.pre.mergeStartLabel);this.wsSendInfoByTypeAndData(10,t(t({},r.pre),{},{undo:!0})),this.core.plugins.ContextmenuPlugin.mergeCell(u,c);break;case 11:this.core.plugins.DragPlugin.expandWidthNoDrag(s.col,r.pre.width-r.next.width),this.core.ws.wsSend(11,t({dis:r.pre.width-r.next.width},r));break;case 12:this.core.plugins.DragPlugin.expandHeightNoDrag(s.row,r.pre.height-r.next.height),this.core.ws.wsSend(12,t({dis:r.pre.height-r.next.height},r));break;case 13:this.core.ws.wsSend(13,t(t({},r.pre),{},{undo:!0})),this.core.plugins.ContextmenuPlugin.removeCol(r.pre.col,r.pre.num,r.pre.isLeft);break;case 14:this.core.ws.wsSend(14,t(t({},r.pre),{},{undo:!0})),this.core.plugins.ContextmenuPlugin.removeRow(r.pre.row,r.pre.num,r.pre.isTop);break;case 15:this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(r.pre.pasteStr)),this.core.ws.wsSend(15,{undo:!0,pasteStr:r.pre.pasteStr});break;case 16:this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(r.pre.beforeStr));var g=this.contentComponent.searchRectByLabel(r.next.label);this.core.plugins.SelectPlugin.forcePasteCellToNewCellByTargetCell(JSON.parse(r.next.beforeStr),g),this.core.ws.wsSend(16,{undo:!0,pre:r.pre.beforeStr,next:r.next.beforeStr,label:r.next.label}),this.contentComponent.setSecondClickCell(null);break;case 17:r.pre.forEach((function(t){e.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(t))})),this.core.ws.wsSend(17,{undo:!0,pre:r.pre})}[1,2,3,4,5,6,7,8].includes(r.type)&&this.wsSendCellAttrByTypeAndData(r.type),o.fresh(),n.stepNum-=1}}},{key:"wsSendCellAttrByTypeAndData",value:function(e){var t=this.contentComponent.clickCell;this.core.ws.wsSend(e,t)}},{key:"wsSendInfoByTypeAndData",value:function(e,t){this.core.ws.wsSend(e,t)}},{key:"registrySettingDom",value:function(){var e=this,t=this.core.h,o=t("input",{attr:{className:"cell-label-input",onblur:function(t){e.changeFirstSelectedCell(e.labelInputDom.value)},onkeydown:function(t){"Enter"===t.key&&e.changeFirstSelectedCell(e.labelInputDom.value)}}});this.labelInputDom=o;var l="A1",n=t("input",{attr:{className:"fx-input",oninput:function(t){e.core.plugins.InputPlugin.inputDom.value=t.target.value},onfocus:function(t){e.contentComponent.clickCell&&(l=e.contentComponent.clickCell.label,e.core.plugins.InputPlugin.showInput(e.contentComponent.clickCell))},onblur:function(t){e.core.plugins.InputPlugin.inputDom.value?(e.changeStepArr({type:1,label:l,pre:e.contentComponent.clickCell.text,next:e.core.plugins.InputPlugin.inputDom.value}),e.contentComponent.searchRectByLabel(l).text=e.core.plugins.InputPlugin.inputDom.value,e.core.freshContent(),e.core.plugins.InputPlugin.hideInput()):e.core.plugins.InputPlugin.hideInput()}}});this.fxInputDom=n;var i=t("div",{attr:{className:"e-sheet-setting-input-bar-layout"}},[t("div",{attr:{className:"left-input-layout"}},[o]),t("div",{attr:{className:"right-input-layout"}},[t("span",{attr:{innerText:"fx",className:"prefix-label"}}),n])]);this.selectorDom.insertBefore(i,this.canvasWrapperDom);var r=t("e-sheet-radio-group",{},[t("e-sheet-radio-button",{attribute:{label:"左对齐",value:"left"}},[t("e-sheet-icon-svg",{attribute:{category:"hor",position:"left"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"居中对齐",value:"center"}},[t("e-sheet-icon-svg",{attribute:{category:"hor",position:"center"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"右对齐",value:"right"}},[t("e-sheet-icon-svg",{attribute:{category:"hor",position:"right"}})])]);this.fontHorAddrGroup=r,r.addEventListener("e-sheet-radio-group-onchange",(function(t){e.convenientChangeStepArr(4,"textAlign",t.detail),e.cellFontTextAlignChange(t.detail),e.wsSendCellAttrByTypeAndData(4)}));var s=t("e-sheet-radio-group",{},[t("e-sheet-radio-button",{attribute:{label:"顶部对齐",value:"top"}},[t("e-sheet-icon-svg",{attribute:{category:"ver",position:"top"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"垂直居中",value:"middle"}},[t("e-sheet-icon-svg",{attribute:{category:"ver",position:"middle"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"底部对齐",value:"bottom"}},[t("e-sheet-icon-svg",{attribute:{category:"ver",position:"bottom"}})])]);this.fontVerAddrGroup=s,s.addEventListener("e-sheet-radio-group-onchange",(function(t){e.convenientChangeStepArr(3,"textBaseLine",t.detail),e.cellFontTextBaseLineChange(t.detail),e.wsSendCellAttrByTypeAndData(3)}));var a=t("div",{attr:{className:"e-sheet-setting-layout"}}),c=t("div",{attr:{className:"font-position-layout"}});c.appendChild(s),c.appendChild(r);var h=t("e-sheet-select",{});h.addEventListener("e-sheet-select-onchange",(function(t){e.convenientChangeStepArr(2,"fontSize",parseInt(t.detail)),e.cellFontSizeChange(t.detail),e.wsSendCellAttrByTypeAndData(2)})),h.setAttribute("label","字号");var d=t("div",{attr:{className:"font-position-layout"}}),u=t("div",{attr:{className:"font-position-layout"}});this.fontSizeSelectDom=h,d.appendChild(h);var g=t("e-sheet-radio-button",{attribute:{label:"粗体",value:"bold"}},[t("e-sheet-icon-svg",{attribute:{category:"font",position:"weight"}})]);this.fontWeightBtnDom=g,g.addEventListener("e-sheet-radio-group-change",(function(t){""===g.getAttribute("current")?(g.setAttribute("current",t.detail),e.convenientChangeStepArr(5,"fontWeight",t.detail),e.cellFontWeightChange(t.detail)):(g.setAttribute("current",""),e.convenientChangeStepArr(5,"fontWeight",""),e.cellFontWeightChange("")),e.wsSendCellAttrByTypeAndData(5)}));var m=t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"斜体",value:"italic"}},[t("e-sheet-icon-svg",{attribute:{category:"font",position:"italic"}})]);this.fontItalicBtnDom=m,m.addEventListener("e-sheet-radio-group-change",(function(t){""===m.getAttribute("current")?(m.setAttribute("current",t.detail),e.convenientChangeStepArr(6,"fontItalic",t.detail),e.cellFontItalicChange(t.detail)):(m.setAttribute("current",""),e.convenientChangeStepArr(6,"fontItalic",""),e.cellFontItalicChange("")),e.wsSendCellAttrByTypeAndData(6)}));var f=t("div",{attr:{className:"e-sheet-font-style-layout"}},[g,m]);d.appendChild(f);var C=t("e-sheet-icon-color-svg",{attribute:{category:"font-color"}});C.addEventListener("e-sheet-icon-color-svg-onchange",(function(t){e.convenientChangeStepArr(7,"fontColor",t.detail),e.cellFontColorChange(t.detail),e.wsSendCellAttrByTypeAndData(7)}));var v=t("e-sheet-tip",{attribute:{"tip-label":"字体颜色",left:-10,top:22}});v.appendChild(C),this.fontColorSelectDom=C,u.appendChild(v);var y=t("e-sheet-tip",{attribute:{"tip-label":"背景颜色",left:-10,top:22}}),w=t("e-sheet-icon-color-svg",{attribute:{category:"bg-color"}});this.bgColorSelectDom=w,y.appendChild(w),w.addEventListener("e-sheet-icon-color-svg-onchange",(function(t){e.convenientChangeStepArr(8,"bgColor",t.detail),e.cellBgColorChange(t.detail),e.wsSendCellAttrByTypeAndData(8)})),u.appendChild(y);var b=t("div",{attr:{className:"e-sheet-divide-line"}}),S=t("e-sheet-tip",{attribute:{"tip-label":"合并单元格",left:4,top:24}},[t("div",{attr:{className:"e-sheet-font-style-layout e-sheet-cell-hover"},style:{padding:"2px",userSelect:"none"}},[t("e-sheet-icon-svg",{attribute:{category:"cell",position:"merge"}}),t("div",{attr:{innerText:"合并单元格",className:"e-sheet-cell-font"}})])]),x=t("e-sheet-tip",{style:{display:"none"}},[t("div",{attr:{className:"e-sheet-font-style-layout e-sheet-cell-hover"},style:{cursor:"pointer",padding:"2px"}},[t("e-sheet-icon-svg",{attribute:{category:"cell",position:"split"}}),t("div",{attr:{innerText:"拆分单元格",className:"e-sheet-cell-font"}})])]),k=t("div",{attr:{className:"font-position-layout"}});S.onclick=function(t){var o=e.contentComponent,l=o.clickCell,n=o.mergeSelectedCell,i={type:9,label:l.label},r=[l].concat(p(n)).sort((function(e,t){return e.row-t.row+(e.col-t.col)}));i.pre=r[0].label,i.next=r.map((function(e){return e.label})),e.changeStepArr(i),e.wsSendInfoByTypeAndData(9,i.next),e.core.plugins.ContextmenuPlugin.mergeCell(r[0],r.slice(0)),S.style.display="none",x.style.display="flex"},x.onclick=function(t){var o=e.contentComponent.clickCell,l={row:o.row,col:o.col,mergeRow:o.mergeRow,mergeCol:o.mergeCol,mergeStartLabel:o.mergeStartLabel,mergeEndLabel:o.mergeEndLabel,isMerge:!1};e.changeStepArr({type:10,label:o.label,pre:{row:o.row,col:o.col,mergeRow:o.mergeRow,mergeCol:o.mergeCol,mergeStartLabel:o.mergeStartLabel,mergeEndLabel:o.mergeEndLabel,isMerge:!0},next:l}),e.wsSendInfoByTypeAndData(10,l),e.core.plugins.ContextmenuPlugin.splitCell(o),S.style.display="flex",x.style.display="none"},this.cellMergerBtnDom=S,this.cellSplitBtnDom=x,k.appendChild(S),k.appendChild(x),k.appendChild(t("div",{attr:{innerText:"单元格",className:"e-sheet-font-style-layout e-sheet-cell-font"},style:{justifyContent:"center"}}));var D=t("e-sheet-radio-button",{attribute:{label:"撤销(Ctrl+Z)",value:"fallback",top:24,left:-24},attr:{onclick:function(t){e.fallbackSetSheet()}}},[t("e-sheet-icon-svg",{attribute:{category:"step",position:"fallback"}})]),M=t("e-sheet-radio-button",{attribute:{label:"重做(Ctrl+Y)",value:"forward",top:24,left:-24},attr:{onclick:function(t){e.forwardSetSheet()}}},[t("e-sheet-icon-svg",{attribute:{category:"step",position:"forward"}})]);document.addEventListener("keydown",(function(t){t.ctrlKey&&"z"===t.key&&e.fallbackSetSheet(),t.ctrlKey&&"y"===t.key&&e.forwardSetSheet()}));var I=t("div",{attr:{className:"font-position-layout"}});I.appendChild(D),I.appendChild(M),a.appendChild(I),a.appendChild(b.cloneNode()),a.appendChild(c),a.appendChild(b.cloneNode()),a.appendChild(d),a.appendChild(b.cloneNode()),a.appendChild(u),a.appendChild(b.cloneNode()),a.appendChild(k),this.selectorDom.insertBefore(a,i)}}]),e}(),R=function(){function e(t,l){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"contextmenuDom",null),i(this,"hideContextMenu",(function(){n.contextmenuDom.style.display="none"})),i(this,"sheetArrLayoutDom",null),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.canvasWrapperDom=a.canvasWrapperDom,this.options=r,this.layer=l,this.core=a,this.registryDom(),this.registryContextmenuDom()}return n(e,[{key:"registryContextmenuDom",value:function(){var e=this,t=this.core.h;this.contextmenuDom=t("div",{style:{display:"none"},attr:{className:"e-sheet-contextmenu-layout"}},[t("div",{style:{cursor:"pointer"},attr:{innerText:"删除",className:"item-btn",onclick:function(t){if(1!==e.core.eSheetWorkBook.length){var o=parseInt(t.target.parentNode.dataset.select);e.core.eSheetWorkBook.splice(o,1),e.core.currentSheetIndex=e.core.eSheetWorkBook.length-1,e.core.switchSheet(e.core.currentSheetIndex),e.sheetArrLayoutDom.removeChild(e.sheetArrLayoutDom.childNodes[o]),e.sheetArrLayoutDom.childNodes.forEach((function(e,t){e.className="item-span",e.setAttribute("index",t)})),e.sheetArrLayoutDom.childNodes[o-1].className="item-span active-item-span",e.hideContextMenu()}else e.hideContextMenu()}}})]),this.selectorDom.appendChild(this.contextmenuDom)}},{key:"createNewSheet",value:function(){this.core.createNewSheet(),this.core.currentSheetIndex=this.core.eSheetWorkBook.length-1;var e=this.core.eSheetWorkBook[this.core.currentSheetIndex];this.core.switchSheet(this.core.currentSheetIndex),this.sheetArrLayoutDom.childNodes.forEach((function(e){e.className="item-span"})),this.sheetArrLayoutDom.appendChild(this.core.h("span",{attr:{innerText:e.label,className:"item-span active-item-span"},attribute:{index:this.core.currentSheetIndex}}))}},{key:"switchSheet",value:function(e){this.core.switchSheet(e);var t=this.core.currentSheetIndex;this.sheetArrLayoutDom.childNodes.forEach((function(e,o){e.className=t===o?"item-span active-item-span":"item-span"}))}},{key:"setSheetName",value:function(e,t){return!(this.core.eSheetWorkBook.map((function(e){return e.label})).includes(t)||!t)&&(this.core.eSheetWorkBook[e].label=t,!0)}},{key:"setCanvasScale",value:function(e){var t=this,o=this.options,l=o.width,n=o.height,i=o.cellHeight;this.contentComponent.contentGroup.forEach((function(o){o.width/=t.core.scale,o.height/=t.core.scale,o.x/=t.core.scale,o.y/=t.core.scale,o.ltX=i+o.x,o.ltY=i+o.y,o.mergeWidth/=t.core.scale,o.mergeHeight/=t.core.scale,o.width*=e,o.height*=e,o.x*=e,o.y*=e,o.ltX=e*i+o.x,o.ltY=e*i+o.y,o.mergeWidth*=e,o.mergeHeight*=e})),this.core.scale=e;var r=this.contentComponent.contentGroup[this.contentComponent.contentGroup.length-1];this.core.sheetWidth=r.ltX+r.width,this.core.sheetHeight=r.ltY+r.height,this.layer.clearRect(0,0,l,n),this.core.fresh(),this.core.freshScrollBar()}},{key:"registryDom",value:function(){var e=this,t=this.core,o=t.h,l=t.eSheetWorkBook,n=t.currentSheetIndex,i=o("div",{attr:{className:"sheet-arr-layout",onclick:function(t){e.hideContextMenu();var o=t.target.getAttribute("index");o&&e.switchSheet(parseInt(o))},ondblclick:function(t){var l=t.target,n=parseInt(t.target.getAttribute("index")),i=l.innerText,r=o("input",{attr:{className:"item-input",onblur:function(t){l.contains(r)&&(e.setSheetName(n,l.innerText)?l.innerText=r.value:l.innerText=i,r.remove())},onkeydown:function(t){"Enter"===t.key&&(e.setSheetName(n,l.innerText)?l.innerText=r.value:l.innerText=i,r.remove())}}});r.value=l.innerText,r.style.width=l.getBoundingClientRect().width-24+"px",l.innerText="",l.appendChild(r),r.focus()},oncontextmenu:function(t){t.preventDefault();var o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,l=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;e.contextmenuDom.dataset.select=t.target.getAttribute("index"),e.contextmenuDom.style.display="block",e.contextmenuDom.style.left=l+t.x+"px",e.contextmenuDom.style.top=o+t.y-34+"px"}}},l.map((function(e,t){return o("div",{attr:{innerText:e.label,className:n===t?"item-span active-item-span":"item-span"},attribute:{index:t}})})));this.sheetArrLayoutDom=i;var r=o("div",{attr:{className:"e-sheet-book-layout"}},[o("div",{attr:{className:"e-sheet-book-con"}},[o("div",{attr:{className:"menu-layout"}},[o("div",{attr:{className:"e-sheet-cell-hover"}},[o("e-sheet-tip",{attribute:{"tip-label":"全部",left:-6,top:-36}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"menu"}})])]),o("div",{attr:{className:"e-sheet-cell-hover"}},[o("e-sheet-tip",{attribute:{"tip-label":"新增",left:-6,top:-36},attr:{onclick:function(t){e.createNewSheet()}}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"plus"}})])])]),i,o("div",{attr:{className:"scroll-handle-layout"}},[o("e-sheet-tip",{attribute:{"tip-label":"向左滚动",left:-20,top:-36},style:{height:"100%"},attr:{onclick:function(e){i.scrollLeft-=300}}},[o("div",{attr:{className:"arrow"}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"arrow-left"}})])]),o("e-sheet-tip",{attribute:{"tip-label":"向右滚动",left:-20,top:-36},style:{height:"100%"},attr:{onclick:function(e){i.scrollLeft+=300}}},[o("div",{attr:{className:"arrow"}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"arrow-right"}})])])])])]);this.selectorDom.appendChild(r)}}]),e}(),T=function(){function e(t,l){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"ws",void 0),this.contentComponent=r.ContentComponent,this.headerComponent=r.HeaderComponent,this.sideComponent=r.SideComponent,this.selectorDom=t,this.canvasDom=s.canvasDom,this.canvasWrapperDom=s.canvasWrapperDom,this.mulPersonSelected=s.mulPersonSelected,this.options=n,this.layer=l,this.core=s}return n(e,[{key:"connect",value:function(e){this.ws=new WebSocket(e),this.wsOpenCallback(),this.wsCloseCallback(),this.wsMsgCallback()}},{key:"wsOpenCallback",value:function(){this.ws.onopen=function(e){}}},{key:"wsCloseCallback",value:function(){var e=this;this.ws.onclose=function(t){e.ws=null}}},{key:"wsMsgCallbackType1",value:function(e){this.contentComponent.changeRectTextByLabel(e.command)}},{key:"wsMsgCallbackType2",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontSize")}},{key:"wsMsgCallbackType3",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"textBaseline")}},{key:"wsMsgCallbackType4",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"textAlign")}},{key:"wsMsgCallbackType5",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontWeight")}},{key:"wsMsgCallbackType6",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontItalic")}},{key:"wsMsgCallbackType7",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontColor")}},{key:"wsMsgCallbackType8",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"bgColor")}},{key:"wsMsgCallbackType9",value:function(e){if(e.command.undo){var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.ContextmenuPlugin.splitCell(t,!1)}else{for(var o=[],l=1;l<e.command.length;l++)o.push(this.contentComponent.searchRectByLabel(e.command[l]));var n=this.contentComponent.searchRectByLabel(e.command[0]);this.core.plugins.ContextmenuPlugin.mergeCell(n,o,!1)}}},{key:"wsMsgCallbackType10",value:function(e){if(e.command.undo){for(var t=[],o=0;o<e.command.mergeRow;o++)for(var l=0;l<e.command.mergeCol;l++)0===o&&0===l||t.push(this.contentComponent.searchRectByColAndRow(e.command.col+l,e.command.row+o));var n=this.contentComponent.searchRectByLabel(e.command.mergeStartLabel);this.core.plugins.ContextmenuPlugin.mergeCell(n,t,!1)}else{var i=this.contentComponent.searchRectByColAndRow(e.command.col,e.command.row);this.core.plugins.ContextmenuPlugin.splitCell(i,!1)}}},{key:"wsMsgCallbackType11",value:function(e){var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.DragPlugin.expandWidthNoDrag(t.col,e.command.dis)}},{key:"wsMsgCallbackType12",value:function(e){var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.DragPlugin.expandHeightNoDrag(t.row,e.command.dis)}},{key:"wsMsgCallbackType13",value:function(e){var t=e.command;t.undo?this.core.plugins.ContextmenuPlugin.removeCol(t.col,t.num,t.isLeft):this.core.plugins.ContextmenuPlugin.insertCol(t.col,t.num,t.isLeft)}},{key:"wsMsgCallbackType14",value:function(e){var t=e.command;t.undo?this.core.plugins.ContextmenuPlugin.removeRow(t.row,t.num,t.isTop):this.core.plugins.ContextmenuPlugin.insertRow(t.row,t.num,t.isTop)}},{key:"wsMsgCallbackType15",value:function(e){if(e.command.undo)this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(e.command.pasteStr));else{var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(e.command.pasteStr,t,!1)}}},{key:"wsMsgCallbackType16",value:function(e){var t=e.command;this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(t.pre));var o=this.contentComponent.searchRectByLabel(t.label);t.undo?this.core.plugins.SelectPlugin.forcePasteCellToNewCellByTargetCell(JSON.parse(t.next),o):this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(t.next,o,!1),this.contentComponent.setSecondClickCell(null)}},{key:"wsMsgCallbackType17",value:function(e){var t=this,o=e.command;o.undo?o.pre.forEach((function(e){t.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(e))})):o.next.forEach((function(e){var o=t.contentComponent.searchRectByLabel(e.label);t.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(e.tableDomStr,o,!1)}))}},{key:"changeUserShow",value:function(e){var t=this.mulPersonSelected.findIndex((function(t){return t.userId===e.userId}));e.command=this.contentComponent.searchRectByLabel(e.command.label),-1===t?this.mulPersonSelected.push(e):this.mulPersonSelected[t]=e}},{key:"wsMsgCallback",value:function(){var e=this;this.ws.onmessage=function(t){e.core.plugins.DragPlugin;var o=e.core.components.ContentComponent,l=o.clickCell;JSON.stringify(l);var n=JSON.parse(t.data);switch(n.type){case 999:o.contentGroup=n.command,e.mulPersonSelected.forEach((function(e){e.command=o.searchRectByLabel(e.command.label)}));break;case 0:e.changeUserShow(n);break;case 1:e.wsMsgCallbackType1(n);break;case 2:e.wsMsgCallbackType2(n);break;case 3:e.wsMsgCallbackType3(n);break;case 4:e.wsMsgCallbackType4(n);break;case 5:e.wsMsgCallbackType5(n);break;case 6:e.wsMsgCallbackType6(n);break;case 7:e.wsMsgCallbackType7(n);break;case 8:e.wsMsgCallbackType8(n);break;case 9:e.wsMsgCallbackType9(n);break;case 10:e.wsMsgCallbackType10(n);break;case 11:e.wsMsgCallbackType11(n);break;case 12:e.wsMsgCallbackType12(n);break;case 13:e.wsMsgCallbackType13(n);break;case 14:e.wsMsgCallbackType14(n);break;case 15:e.wsMsgCallbackType15(n);break;case 16:e.wsMsgCallbackType16(n);break;case 17:e.wsMsgCallbackType17(n)}e.core.fresh()}}},{key:"wsSend",value:function(e,t){this.ws&&this.ws.send(JSON.stringify({type:e,command:t,userId:this.core.userId,userName:this.core.userName,userColor:this.core.userColor}))}},{key:"syncData",value:function(){this.wsSend(0,this.core.components.ContentComponent.contentGroup)}}]),e}(),N=function(e){r(l,e);var t=g(l);function l(){return o(this,l),t.apply(this,arguments)}return n(l,[{key:"connectedCallback",value:function(){var e=this;this.tipLabel=this.getAttribute("tip-label"),this.left=parseInt(this.getAttribute("left")),this.top=parseInt(this.getAttribute("top"));var t=document.createElement("div");t.className="e-sheet-radio-button-tip",t.innerText=this.tipLabel,this.className="e-sheet-tip",this.addEventListener("mouseover",(function(o){if(!document.body.contains(t)){var l=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,i=e.getBoundingClientRect(),r=i.x,s=i.y;t.style.left=r+e.left+n+"px",t.style.top=s+e.top+l+"px",document.body.appendChild(t)}})),this.addEventListener("mouseleave",(function(e){t.remove()}))}}]),l}(d(HTMLElement));customElements.define("e-sheet-tip",N);var P=function(e){r(l,e);var t=g(l);function l(){var e;return o(this,l),i(u(e=t.call(this)),"optionLayoutDom",null),i(u(e),"isOpen",!1),i(u(e),"showTextDom",null),i(u(e),"arrowDom",null),e}return n(l,[{key:"close",value:function(){this.optionLayoutDom&&this.optionLayoutDom.remove(),this.optionLayoutDom=null,this.isOpen=!1,this.arrowDom.style.transform="rotate(0deg)"}},{key:"connectedCallback",value:function(){var e,t=this;this.value=null!==(e=this.getAttribute("value"))&&void 0!==e?e:12,this.label=this.getAttribute("label"),this.className="e-sheet-select";var o=document.createElement("div");o.className="e-sheet-radio-button-tip",o.innerText=this.label,this.addEventListener("mouseover",(function(e){o||((o=document.createElement("div")).className="e-sheet-radio-button-tip",o.innerText=t.label);var l=t.getBoundingClientRect(),n=l.x,i=l.y;o.style.left=n+12+"px",o.style.top=i+24+"px",document.body.appendChild(o)})),this.addEventListener("mouseleave",(function(e){o.remove()}));var l=document.createElement("div");l.innerText=this.value,l.className="select-text",this.showTextDom=l;var n=document.createElement("e-sheet-icon-svg");n.setAttribute("category","select"),n.setAttribute("position","down"),this.arrowDom=n,n.style.transition="transform .5s",this.appendChild(l),this.appendChild(n),document.addEventListener("click",(function(e){t.contains(e.target)||t.close()})),this.addEventListener("e-sheet-option-onchange",(function(e){l.innerText=t.value=e.detail,t.dispatchEvent(new CustomEvent("e-sheet-select-onchange",{bubbles:!1,composed:!0,detail:t.value})),o.remove(),t.close()})),this.addEventListener("click",(function(e){if(e.stopImmediatePropagation(),t.isOpen)t.close();else if(!t.optionLayoutDom||t.optionLayoutDom.contains(e.target)){t.isOpen=!0,n.style.transform="rotate(180deg)",t.optionLayoutDom=document.createElement("div"),t.optionLayoutDom.className="e-sheet-option-layout",new Array(10).fill(0).forEach((function(e,o){var l=document.createElement("e-sheet-option");l.setAttribute("label",(12+o).toString()),l.setAttribute("value",12+o),l.setAttribute("current",t.value),t.optionLayoutDom.appendChild(l)}));var o=t.getBoundingClientRect().height;t.optionLayoutDom.style.left="-1px",t.optionLayoutDom.style.top=o+"px",t.appendChild(t.optionLayoutDom)}}))}},{key:"attributeChangedCallback",value:function(e,t,o){this.value=o,this.showTextDom.innerText=this.value}}],[{key:"observedAttributes",get:function(){return["value"]}}]),l}(d(HTMLElement));customElements.define("e-sheet-select",P);var Z=function(e){r(l,e);var t=g(l);function l(){return o(this,l),t.call(this)}return n(l,[{key:"connectedCallback",value:function(){var e=this;this.label=this.getAttribute("label"),this.value=this.getAttribute("value"),this.current=this.getAttribute("current"),this.className="e-sheet-option";var t=document.createElement("div");t.className="option-font",t.innerText=this.label;var o=document.createElement("e-sheet-icon-svg");this.value!==this.current&&(o.style.display="none"),o.setAttribute("category","bool"),o.setAttribute("position","true"),this.appendChild(t),this.appendChild(o),this.addEventListener("click",(function(t){t.stopImmediatePropagation(),e.dispatchEvent(new CustomEvent("e-sheet-option-onchange",{bubbles:!0,composed:!0,detail:e.value}))}))}}]),l}(d(HTMLElement));customElements.define("e-sheet-option",Z);var W=function(e){r(l,e);var t=g(l);function l(){return o(this,l),t.call(this)}return n(l,[{key:"connectedCallback",value:function(){var e=this;this.value=this.getAttribute("value");var t=this.attachShadow({mode:"open"}),o=document.createElement("slot");this.className="e-sheet-radio-group",t.appendChild(o),t.addEventListener("e-sheet-radio-group-change",(function(o){e.value=o.detail,new Array(e.childElementCount).fill(void 0).forEach((function(t,o){e.children.item(o).setAttribute("current",e.value)})),t.dispatchEvent(new CustomEvent("e-sheet-radio-group-onchange",{bubbles:!1,composed:!0,detail:e.value}))}))}},{key:"attributeChangedCallback",value:function(e,t,o){var l=this;this.value=o,new Array(this.childElementCount).fill(void 0).forEach((function(e,t){l.children.item(t).setAttribute("current",l.value)}))}}],[{key:"observedAttributes",get:function(){return["value"]}}]),l}(d(HTMLElement));customElements.define("e-sheet-radio-group",W);var H=function(e){r(l,e);var t=g(l);function l(){return o(this,l),t.call(this)}return n(l,[{key:"connectedCallback",value:function(){var e=this;this.label=this.getAttribute("label"),this.value=this.getAttribute("value"),this.left=this.getAttribute("left"),this.top=this.getAttribute("top"),this.className="e-sheet-radio-button";var t=this.attachShadow({mode:"open"}),o=document.createElement("div");o.className="e-sheet-radio-button-tip",o.innerText=this.label;var l=document.createElement("slot");t.addEventListener("click",(function(o){t.dispatchEvent(new CustomEvent("e-sheet-radio-group-change",{bubbles:!0,composed:!0,detail:e.value}))})),this.addEventListener("mouseover",(function(t){if(!document.body.contains(o)){var l=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,i=e.getBoundingClientRect(),r=i.x,s=i.y,a=e.left?parseInt(e.left):12*-e.label.length/2+4,c=e.top?parseInt(e.top):24;o.style.left=r+a+n+"px",o.style.top=s+l+c+"px",document.body.appendChild(o)}})),this.addEventListener("mouseleave",(function(e){o.remove()})),t.appendChild(l)}},{key:"attributeChangedCallback",value:function(e,t,o){this.value===o?this.className="e-sheet-radio-button e-sheet-radio-button-selected":this.className="e-sheet-radio-button"}}],[{key:"observedAttributes",get:function(){return["current"]}}]),l}(d(HTMLElement));customElements.define("e-sheet-radio-button",H);var j=function(e){r(l,e);var t=g(l);function l(){return o(this,l),t.call(this)}return n(l,[{key:"connectedCallback",value:function(){if(this.category=this.getAttribute("category"),this.position=this.getAttribute("position"),"hor"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"left":case"start":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00059"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00059)"><path fill="currentColor" fill-opacity="0.94" d="M17 5H3V4h14v1Zm-7 4H3V8h7v1Zm0 8H3v-1h7v1Zm7-4v-1H3v1h14Z"></path></g></svg>');case"center":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00035"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00035)"><path fill="currentColor" fill-opacity="0.94" d="M17 5H3V4h14v1ZM7 9h6V8H7v1Zm10 4H3v-1h14v1Zm-4 4H7v-1h6v1Z"></path></g></svg>');case"right":case"end":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00066"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00066)"><path fill="currentColor" fill-opacity="0.94" d="M17 5H3V4h14v1Zm-7 4h7V8h-7v1Zm7 3v1H3v-1h14Zm0 5h-7v-1h7v1Z"></path></g></svg>')}if("ver"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"top":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_7600_00213"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_00213)"><path fill="currentColor" d="M17 4H3V3h14v1Z"></path><path fill="#0089FF" d="m10.013 6 3.487 4h-7l3.513-4Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 9v8h-1V9h1Z"></path></g></svg>');case"middle":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_7600_00207"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_00207)"><path fill="currentColor" d="M17 10H3V9h14v1Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 1v5h-1V1h1Z"></path><path fill="#0089FF" d="m10.01 8 2.49-3h-5l2.51 3ZM10.01 11l2.49 3h-5l2.51-3Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 14v4h-1v-4h1Z"></path></g></svg>');case"bottom":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_7600_00217"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_00217)"><path fill="currentColor" d="M17 17H3v-1h14v1Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 3v8h-1V3h1Z"></path><path fill="#0089FF" d="m10.013 14 3.487-4h-7l3.513 4Z"></path></g></svg>')}if("bool"!==this.category||(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20","true"!==this.position))if("select"!==this.category||(this.className="e-sheet-cell-svg-layout e-sheet-svg-12-12","down"!==this.position)){if("font"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"weight":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00081"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00081)"><path fill="currentColor" d="M5.8 3.05a.75.75 0 0 0-.75.75v12.5c0 .414.336.75.75.75h5.5c2.297 0 3.75-1.862 3.75-4 0-1.415-.637-2.71-1.734-3.423.734-.635 1.234-1.588 1.234-2.827 0-2.424-1.91-3.75-3.75-3.75h-5Zm5 6H6.55v-4.5h4.25c1.16 0 2.25.796 2.25 2.25s-1.09 2.25-2.25 2.25Zm-4.25 1.5h4.75c1.314 0 2.25 1.027 2.25 2.5s-.936 2.5-2.25 2.5H6.55v-5Z" data-spm-anchor-id=""></path></g></svg>');case"italic":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20" data-spm-anchor-id=""><defs><clipPath id="master_svg0_7600_9375"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_9375)"><path fill="currentColor" d="M12 4h3V3H8v1h2.769l-2.77 12H5v1h7v-1H9.231l2.77-12Z"></path></g></svg>')}if("cell"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"merge":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_31608_94416"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_31608_94416)"><path fill="#0089FF" d="M15 10.5H5v-1h10v1Z"></path><path fill="currentColor" d="M6.5 3A1.5 1.5 0 0 1 8 4.5V6H7V4.5a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0-.5.5v11a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5V14h1v1.5A1.5 1.5 0 0 1 6.5 17h-2A1.5 1.5 0 0 1 3 15.5v-11A1.5 1.5 0 0 1 4.5 3h2Zm7 0A1.5 1.5 0 0 0 12 4.5V6h1V4.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5V14h-1v1.5a1.5 1.5 0 0 0 1.5 1.5h2a1.5 1.5 0 0 0 1.5-1.5v-11A1.5 1.5 0 0 0 15.5 3h-2Z"></path></g></svg>');case"split":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_31608_94446"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_31608_94446)"><path fill="currentColor" fill-rule="evenodd" d="M4 4.5A1.5 1.5 0 0 1 5.5 3h2A1.5 1.5 0 0 1 9 4.5v11A1.5 1.5 0 0 1 7.5 17h-2A1.5 1.5 0 0 1 4 15.5V14h1v1.5a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5v-11a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0-.5.5V6H4V4.5ZM16 4.5A1.5 1.5 0 0 0 14.5 3h-2A1.5 1.5 0 0 0 11 4.5v11a1.5 1.5 0 0 0 1.5 1.5h2a1.5 1.5 0 0 0 1.5-1.5V14h-1v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5V6h1V4.5Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M7 10.5H4v-1h3v1ZM16 10.5h-3v-1h3v1Z"></path><path fill="#0089FF" d="m18 10-3-2.5v5l3-2.5ZM2 10l3-2.5v5L2 10Z"></path></g></svg>')}if("book"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"menu":return void(this.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" data-spm-anchor-id=""><path d="M6 5H18V4H6V5ZM18 10H6V9H18V10ZM18 15H6V14H18V15ZM2 5H4V4H2V5ZM4 10H2V9H4V10ZM4 15H2V14H4V15Z" fill="rgba(40,50,72,1)"></path></svg>');case"plus":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_30306_58308"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_30306_58308)"><path fill="currentColor" fill-opacity="0.94" d="M9.5 4.5v5h-5a.5.5 0 0 0 0 1h5v5a.5.5 0 0 0 1 0v-5h5a.5.5 0 0 0 0-1h-5v-5a.5.5 0 0 0-1 0Z"></path></g></svg>');case"arrow-left":return void(this.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="wdn-icon" data-spm-anchor-id=""><path d="m12.646 3.646.708.708L7.707 10l5.647 5.646-.707.708L6.292 10l6.353-6.354Z" fill="currentColor"></path></svg>');case"arrow-right":return void(this.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="wdn-icon"><path d="m7.353 3.646-.707.708L12.293 10l-5.647 5.646.707.708L13.707 10 7.353 3.646Z" fill="currentColor"></path></svg>')}if("step"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"forward":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20" data-spm-anchor-id=""><defs><clipPath id="___SVG_ID__50__0___"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#___SVG_ID__50__0___)"><path fill="currentColor" fill-opacity="0.94" d="M16.3 6H7.988C4.975 6 3 8.22 3 11s1.975 5 4.988 5h4.168v1H7.988C4.388 17 2 14.296 2 11s2.387-6 5.988-6h8.298l-2.14-2.147.708-.706 3.353 3.364-3.354 3.343-.706-.708L16.3 6Z"></path></g></svg>');case"fallback":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="___SVG_ID__49__0___"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#___SVG_ID__49__0___)"><path fill="currentColor" fill-opacity="0.94" d="M6.354 2.353 3.714 5h8.298C15.612 5 18 7.704 18 11s-2.387 6-5.988 6H8v-1h4.012C15.025 16 17 13.78 17 11s-1.975-5-4.988-5H3.7l2.653 2.646-.706.708-3.854-3.843 3.853-3.864.708.706Z"></path></g></svg>')}}else this.innerHTML='<svg width="12" height="12" viewBox="0 0 12 12" stroke="none" data-spm-anchor-id="" style=""><path d="M6.00004 7.79293L1.85359 3.64648L1.14648 4.35359L6.00004 9.20714L10.8536 4.35359L10.1465 3.64648L6.00004 7.79293Z" fill="currentColor" data-spm-anchor-id=""></path></svg>';else this.innerHTML='<svg fill="none" width="20" height="20" viewBox="0 0 20 20" class="wdn-icon"><path d="M16.354 6.854a.5.5 0 0 0-.708-.708L8.5 13.293 4.854 9.647a.5.5 0 1 0-.708.707l4 4a.5.5 0 0 0 .708 0l7.5-7.5Z" fill="currentColor"></path></svg>'}}]),l}(d(HTMLElement));customElements.define("e-sheet-icon-svg",j);var G=function(e){r(l,e);var t=g(l);function l(){return o(this,l),t.call(this)}return n(l,[{key:"connectedCallback",value:function(){var e=this;this.category=this.getAttribute("category"),this.color=this.getAttribute("color"),this.className="e-sheet-icon-color-svg";var t=document.createElement("div");t.onclick=function(t){e.querySelector("svg").querySelectorAll("path").forEach((function(t){"currentColor"!==t.getAttribute("fill")&&e.dispatchEvent(new CustomEvent("e-sheet-icon-color-svg-onchange",{bubbles:!1,composed:!0,detail:t.getAttribute("fill")}))}))};var o=document.createElement("div"),l=document.createElement("e-sheet-icon-svg");l.setAttribute("category","select"),l.setAttribute("position","down"),l.style.transition="transform .5s",o.appendChild(l);var n=document.createElement("input");n.className="no-draw-input",n.type="color",n.oninput=function(t){e.setAttribute("color",t.target.value),e.dispatchEvent(new CustomEvent("e-sheet-icon-color-svg-onchange",{bubbles:!1,composed:!0,detail:t.target.value}))},o.appendChild(n),o.className="arrow-layout",o.onclick=function(e){l.style.transform="rotate(180deg)",n.click()},document.addEventListener("click",(function(t){e.contains(t.target)||(l.style.transform="rotate(0deg)")})),t.className="e-sheet-cell-svg-layout e-sheet-svg-20-20","font-color"===this.category?t.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" data-spm-anchor-id=""><defs><clipPath id="master_svg0_23880_31533"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_23880_31533)"><path fill="#000000" d="M17 19H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path><path fill="currentColor" fill-opacity="0.14" d="M17 19.5q.621 0 1.06-.44.44-.439.44-1.06t-.44-1.06q-.439-.44-1.06-.44H3q-.621 0-1.06.44-.44.439-.44 1.06t.44 1.06q.439.44 1.06.44h14Zm0-.5H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path><path fill="currentColor" fill-opacity="0.94" d="m12.456 11 1.584 3.697a.5.5 0 0 0 .92-.394l-1.715-4-2.785-6.5a.5.5 0 0 0-.92 0l-2.785 6.5-1.714 4a.5.5 0 0 0 .919.394L7.544 11h4.912Zm-.429-1H7.973L10 5.27 12.027 10Z"></path></g></svg>':"bg-color"===this.category&&(t.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_31391_75878"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_31391_75878)"><path fill="currentColor" fill-opacity="0.94" fill-rule="evenodd" d="M9.718 1.843 5.857 5.704h-3.87v1h2.87L3.354 8.207q-.44.44-.44 1.061t.44 1.06l4.95 4.95q.439.44 1.06.44t1.06-.44l6.365-6.364q.44-.439.44-1.06 0-.622-.44-1.061l-4.95-4.95q-.44-.44-1.06-.44-.622 0-1.061.44ZM11.5 6.704H6.271l-2.21 2.21q-.147.147-.147.354t.147.354l.531.531 10.315-.771 1.175-1.175q.146-.146.146-.353t-.146-.354l-4.95-4.95q-.147-.146-.354-.146t-.353.146L7.27 5.704H11.5v1Zm5.088 8.442c.78 0 1.412-.632 1.412-1.411q0-.78-1.412-2.353-1.412 1.573-1.412 2.353c0 .78.633 1.411 1.412 1.411Z"></path><path fill="#F2C150" d="M17 19H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path><path fill="currentColor" fill-opacity="0.14" d="M17 19.5q.621 0 1.06-.44.44-.439.44-1.06t-.44-1.06q-.439-.44-1.06-.44H3q-.621 0-1.06.44-.44.439-.44 1.06t.44 1.06q.439.44 1.06.44h14Zm0-.5H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path></g></svg>'),this.appendChild(t),this.appendChild(o)}},{key:"attributeChangedCallback",value:function(e,t,o){this.color=o,this.querySelector("svg").querySelectorAll("path").forEach((function(e){"currentColor"!==e.getAttribute("fill")&&e.setAttribute("fill",o)}))}}],[{key:"observedAttributes",get:function(){return["color"]}}]),l}(d(HTMLElement));customElements.define("e-sheet-icon-color-svg",G);var E=function(e){r(l,e);var t=g(l);function l(){var e;o(this,l);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return i(u(e=t.call.apply(t,[this].concat(r))),"show",!1),i(u(e),"title",""),i(u(e),"content",""),i(u(e),"wrapperDom",void 0),i(u(e),"titleDom",void 0),i(u(e),"contentDom",void 0),i(u(e),"mounted",!1),e}return n(l,[{key:"connectedCallback",value:function(){var e=this;this.show=this.getAttribute("show"),this.title=this.getAttribute("t"),this.content=this.getAttribute("content"),this.className="e-sheet-warn-dialog-tip",this.wrapperDom=document.createElement("div"),this.wrapperDom.className="e-sheet-warn-dialog-wrapper",this.titleDom=document.createElement("div"),this.titleDom.className="e-sheet-warn-dialog-wrapper-title",this.contentDom=document.createElement("div"),this.contentDom.className="e-sheet-warn-dialog-wrapper-content";var t=document.createElement("div");t.className="e-sheet-warn-dialog-tip-close-btn",t.addEventListener("click",(function(t){e.setAttribute("show",!1)})),this.titleDom.innerText=this.title,this.contentDom.innerText=this.content,this.wrapperDom.append(this.titleDom),this.wrapperDom.append(this.contentDom),this.wrapperDom.append(t),this.append(this.wrapperDom),this.mounted=!0}},{key:"showDialog",value:function(){this.style.display="flex"}},{key:"closeDialog",value:function(){this.style.display="none"}},{key:"attributeChangedCallback",value:function(e,t,o){var l=JSON.parse(o);this.show=l,l&&this.mounted?(this.title=this.getAttribute("t"),this.content=this.getAttribute("content"),this.titleDom.innerText=this.title,this.contentDom.innerText=this.content,this.showDialog()):this.closeDialog()}}],[{key:"observedAttributes",get:function(){return["show"]}}]),l}(d(HTMLElement));customElements.define("e-sheet-warn-dialog-tip",E);var Y=function(){function e(t){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(o(this,e),i(this,"excelDom",null),i(this,"AppExcel",null),"[object HTMLDivElement]"===Object.prototype.toString.call(t)?this.excelDom=t:this.excelDom=document.querySelector(t),!this.excelDom)throw new Error("the selector is error");return this.excelDom.style.position="relative",this.init(l,n)}return n(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.AppExcel=new w(this.excelDom,e,{ContentComponent:k,HeaderComponent:S,SideComponent:x,WholeComponent:b},t({SettingPlugin:B,ScrollPlugin:D,InputPlugin:M,DragPlugin:A,SelectPlugin:I,ContextmenuPlugin:L,BookPlugin:R,WebsocketPlugin:T},o)),this.AppExcel}},{key:"installXlsxData",value:function(e){this.AppExcel.installXlsxData(e)}}]),e}();return Y}));
