function e(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function t(t){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?e(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function l(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t,o){return(t=f(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function h(e,t,o){return h=c()?Reflect.construct.bind():function(e,t,o){var n=[null];n.push.apply(n,t);var l=new(Function.bind.apply(e,n));return o&&a(l,o.prototype),l},h.apply(null,arguments)}function d(e){var t="function"==typeof Map?new Map:void 0;return d=function(e){if(null===e||(o=e,-1===Function.toString.call(o).indexOf("[native code]")))return e;var o;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return h(e,arguments,s(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,e)},d(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){var t=c();return function(){var o,n=s(e);if(t){var l=s(this).constructor;o=Reflect.construct(n,arguments,l)}else o=n.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,o)}}function p(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function f(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C={cell:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTkgMTd2LTVoLTJ2NWgtNXYyaDV2NWgydi01aDV2LTJoLTV6IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9Ii44OCIvPjxwYXRoIGQ9Ik0xMiAxOS41aDQuNXY1aDN2LTVoNXYtM2gtNXYtNWgtM3Y1aC01djNoLjV6IiBzdHJva2U9IiMxNzFBMUQiLz48L2c+PGRlZnM+PGZpbHRlciBpZD0iZmlsdGVyMF9kIiB4PSI4IiB5PSI5IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==","col-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxtYXNrIGlkPSJhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSI3IiB5PSI5IiB3aWR0aD0iMjIiIGhlaWdodD0iMTgiIGZpbGw9IiMwMDAiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik03IDloMjJ2MThIN3oiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE5IDEwaC0ydjdoLTR2Mmg0djdoMnYtN2g0di0yaC00di03ek05IDE4bDQtM3Y2bC00LTN6bTE4IDBsLTQgM3YtNmw0IDN6Ii8+PC9tYXNrPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTkgMTBoLTJ2N2gtNHYyaDR2N2gydi03aDR2LTJoLTR2LTd6TTkgMThsNC0zdjZsLTQtM3ptMTggMGwtNCAzdi02bDQgM3oiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMTkgMTBoMVY5aC0xdjF6bS0yIDBWOWgtMXYxaDF6bTAgN3YxaDF2LTFoLTF6bS00IDB2LTFoLTF2MWgxem0wIDJoLTF2MWgxdi0xem00IDBoMXYtMWgtMXYxem0wIDdoLTF2MWgxdi0xem0yIDB2MWgxdi0xaC0xem0wLTd2LTFoLTF2MWgxem00IDB2MWgxdi0xaC0xem0wLTJoMXYtMWgtMXYxem0tNCAwaC0xdjFoMXYtMXpNOSAxOGwtLjYtLjgtMS4wNjcuOCAxLjA2Ny44LjYtLjh6bTQtM2gxdi0ybC0xLjYgMS4yLjYuOHptMCA2bC0uNi44TDE0IDIzdi0yaC0xem0xNC0zbC42LjggMS4wNjctLjgtMS4wNjctLjgtLjYuOHptLTQgM2gtMXYybDEuNi0xLjItLjYtLjh6bTAtNmwuNi0uOEwyMiAxM3YyaDF6bS00LTZoLTJ2MmgyVjl6bS0zIDF2N2gydi03aC0yem0xIDZoLTR2Mmg0di0yem0tNSAxdjJoMnYtMmgtMnptMSAzaDR2LTJoLTR2MnptMy0xdjdoMnYtN2gtMnptMSA4aDJ2LTJoLTJ2MnptMy0xdi03aC0ydjdoMnptLTEtNmg0di0yaC00djJ6bTUtMXYtMmgtMnYyaDJ6bS0xLTNoLTR2Mmg0di0yem0tMyAxdi03aC0ydjdoMnpNOS42IDE4LjhsNC0zLTEuMi0xLjYtNCAzIDEuMiAxLjZ6TTEyIDE1djZoMnYtNmgtMnptMS42IDUuMmwtNC0zLTEuMiAxLjYgNCAzIDEuMi0xLjZ6bTEyLjgtM2wtNCAzIDEuMiAxLjYgNC0zLTEuMi0xLjZ6TTI0IDIxdi02aC0ydjZoMnptLTEuNi01LjJsNCAzIDEuMi0xLjYtNC0zLTEuMiAxLjZ6IiBmaWxsPSIjZmZmIiBtYXNrPSJ1cmwoI2EpIi8+PC9nPjxkZWZzPjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iNC4zMzMiIHk9IjciIHdpZHRoPSIyNy4zMzMiIGhlaWdodD0iMjQiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==","row-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxtYXNrIGlkPSJhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSI5IiB5PSI3IiB3aWR0aD0iMTgiIGhlaWdodD0iMjIiIGZpbGw9IiMwMDAiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik05IDdoMTh2MjJIOXoiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTI2IDE5di0yaC03di00aC0ydjRoLTd2Mmg3djRoMnYtNGg3ek0xOCA5bDMgNGgtNmwzLTR6bTAgMThsLTMtNGg2bC0zIDR6Ii8+PC9tYXNrPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjYgMTl2LTJoLTd2LTRoLTJ2NGgtN3YyaDd2NGgydi00aDd6TTE4IDlsMyA0aC02bDMtNHptMCAxOGwtMy00aDZsLTMgNHoiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMjYgMTl2MWgxdi0xaC0xem0wLTJoMXYtMWgtMXYxem0tNyAwaC0xdjFoMXYtMXptMC00aDF2LTFoLTF2MXptLTIgMHYtMWgtMXYxaDF6bTAgNHYxaDF2LTFoLTF6bS03IDB2LTFIOXYxaDF6bTAgMkg5djFoMXYtMXptNyAwaDF2LTFoLTF2MXptMCA0aC0xdjFoMXYtMXptMiAwdjFoMXYtMWgtMXptMC00di0xaC0xdjFoMXpNMTggOWwuOC0uNi0uOC0xLjA2Ny0uOCAxLjA2Ny44LjZ6bTMgNHYxaDJsLTEuMi0xLjYtLjguNnptLTYgMGwtLjgtLjZMMTMgMTRoMnYtMXptMyAxNGwtLjguNi44IDEuMDY3LjgtMS4wNjctLjgtLjZ6bS0zLTR2LTFoLTJsMS4yIDEuNi44LS42em02IDBsLjguNkwyMyAyMmgtMnYxem02LTR2LTJoLTJ2Mmgyem0tMS0zaC03djJoN3YtMnptLTYgMXYtNGgtMnY0aDJ6bS0xLTVoLTJ2Mmgydi0yem0tMyAxdjRoMnYtNGgtMnptMSAzaC03djJoN3YtMnptLTggMXYyaDJ2LTJIOXptMSAzaDd2LTJoLTd2MnptNi0xdjRoMnYtNGgtMnptMSA1aDJ2LTJoLTJ2MnptMy0xdi00aC0ydjRoMnptLTEtM2g3di0yaC03djJ6TTE3LjIgOS42bDMgNCAxLjYtMS4yLTMtNC0xLjYgMS4yek0yMSAxMmgtNnYyaDZ2LTJ6bS01LjIgMS42bDMtNC0xLjYtMS4yLTMgNCAxLjYgMS4yem0zIDEyLjhsLTMtNC0xLjYgMS4yIDMgNCAxLjYtMS4yek0xNSAyNGg2di0yaC02djJ6bTUuMi0xLjZsLTMgNCAxLjYgMS4yIDMtNC0xLjYtMS4yeiIgZmlsbD0iI2ZmZiIgbWFzaz0idXJsKCNhKSIvPjwvZz48ZGVmcz48ZmlsdGVyIGlkPSJmaWx0ZXIwX2QiIHg9IjYiIHk9IjUuMzMzIiB3aWR0aD0iMjQiIGhlaWdodD0iMjcuMzMzIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+PGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz48ZmVPZmZzZXQgZHk9IjEiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPjxmZUJsZW5kIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPjwvZmlsdGVyPjwvZGVmcz48L3N2Zz4=","s-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTcgMTl2LThoM3Y4aDNsLTQuNSA1LjVMMTQgMTloM3oiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMjMgMTguNWgtMi41di04aC00djhoLTMuNTU1bC42NjguODE3IDQuNSA1LjUuMzg3LjQ3My4zODctLjQ3MyA0LjUtNS41LjY2OC0uODE3SDIzeiIgc3Ryb2tlPSIjZmZmIi8+PC9nPjxkZWZzPjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iOC44OSIgeT0iOCIgd2lkdGg9IjE5LjIyMSIgaGVpZ2h0PSIyMi4wNzkiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==","e-resize":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjAgMTloLTh2LTNoOHYtM2w1IDQuNS01IDQuNXYtM3oiIGZpbGw9IiMxNzFBMUQiLz48cGF0aCBkPSJNMTkuNSAxM3YyLjVoLTh2NGg4djMuNjIzbC44MzQtLjc1MSA1LTQuNS40MTMtLjM3Mi0uNDEzLS4zNzItNS00LjUtLjgzNC0uNzVWMTN6IiBzdHJva2U9IiNmZmYiLz48L2c+PGRlZnM+PGZpbHRlciBpZD0iZmlsdGVyMF9kIiB4PSI4IiB5PSI4Ljc1NSIgd2lkdGg9IjIxLjQ5NSIgaGVpZ2h0PSIxOS40OTEiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iMSIvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PC9kZWZzPjwvc3ZnPg==",crosshair:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTggMTh2LTZoLTF2NmgtNnYxaDZ2Nmgxdi02aDZ2LTFoLTZ6IiBmaWxsPSIjMTcxQTFEIi8+PHBhdGggZD0iTTE4LjUgMTJ2LS41aC0ydjZoLTZ2Mmg2djZoMnYtNmg2di0yaC02VjEyeiIgc3Ryb2tlPSIjZmZmIi8+PC9nPjxkZWZzPjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iNyIgeT0iOSIgd2lkdGg9IjIxIiBoZWlnaHQ9IjIxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+PGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz48ZmVPZmZzZXQgZHk9IjEiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPjxmZUJsZW5kIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPjwvZmlsdGVyPjwvZGVmcz48L3N2Zz4="},v=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),i(this,"canvasDom",null),i(this,"ctx",null),i(this,"cellWidth",0),i(this,"cellHeight",0),this.ctx=t.getContext("2d"),this.cellWidth=l.cellWidth,this.cellHeight=l.cellHeight,this.canvasDom=t,t.addEventListener("mousemove",(function(e){n.setCursor("cell")}))}return l(e,[{key:"setCursor",value:function(e){this.canvasDom.style.cursor="url(".concat(C[e],") 18 18, ").concat(e)}},{key:"setCursorDefault",value:function(){this.canvasDom.style.cursor="default"}},{key:"drawLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"source-over",o=arguments.length>2?arguments[2]:void 0;if(this.ctx.strokeStyle=null!=o?o:"black",this.ctx.lineWidth=1,this.ctx.globalCompositeOperation=t,this.ctx.beginPath(),e.length%2!=0)throw new Error("points is error");var n=e.length/2;this.ctx.moveTo(e[0],e[1]);for(var l=2;l<n+1;l+=2)this.ctx.lineTo(e[l],e[l+1]);this.ctx.closePath(),this.ctx.stroke()}},{key:"drawText",value:function(e,t){var o,n,l,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"center",d=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,g=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",p=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",m=this.ctx,f=this.cellWidth,C=this.cellHeight;m.globalCompositeOperation=null!=a?a:"source-over",r=null!==(o=r)&&void 0!==o?o:f,s=null!==(n=s)&&void 0!==n?n:C,d.fontSize=null!==(l=d.fontSize)&&void 0!==l?l:12,m.font=d?"".concat(d.fontWeight+" ").concat(d.fontItalic+" ").concat(d.fontSize,"px ").concat(d.fontFamily):"12px Calibre",m.fillStyle=c||"black";var v=e+r/2,y=t+s/2;m.textBaseline=u||"middle",m.textAlign=h||"center";var w="";if(m.measureText(i).width>r){var b=(r/d.fontSize).toFixed(0)-1;w=i.slice(0,b-1)+"..."}else w=i;var S=0,k=0;if(S="left"===h?e:"right"===h?e+r:v,k="top"===u?t+2:"bottom"===u?t+s-2:y,m.fillText(w,S,k,r),"true"===g&&i){var x=m.measureText(w);"right"===h&&"middle"===u&&this.drawthroughLine(S-x.width,k,S,k),"left"===h&&"middle"===u&&this.drawthroughLine(S,k,S+x.width,k),"center"===h&&"top"===u&&this.drawthroughLine(S-x.width/2,k+d.fontSize/2,S+x.width/2,k+d.fontSize/2),"center"===h&&"bottom"===u&&this.drawthroughLine(S-x.width/2,k-d.fontSize/2,S+x.width/2,k-d.fontSize/2),"right"===h&&"bottom"===u&&this.drawthroughLine(S-x.width,k-d.fontSize/2,S,k-d.fontSize/2),"right"===h&&"top"===u&&this.drawthroughLine(S-x.width,k+d.fontSize/2,S,k+d.fontSize/2),"left"===h&&"bottom"===u&&this.drawthroughLine(S,k-d.fontSize/2,S+x.width,k-d.fontSize/2),"left"===h&&"top"===u?this.drawthroughLine(S,k+d.fontSize/2,S+x.width,k+d.fontSize/2):"center"===h&&"middle"===u&&this.drawthroughLine(S-x.width/2,k,S+x.width/2,k)}if("true"===p&&i){var D=m.measureText(w);"right"===h&&"middle"===u&&this.drawthroughLine(S-D.width,k+d.fontSize/2,S,k+d.fontSize/2),"left"===h&&"middle"===u&&this.drawthroughLine(S,k+d.fontSize/2,S+D.width,k+d.fontSize/2),"center"===h&&"top"===u&&this.drawthroughLine(S-D.width/2,k+d.fontSize,S+D.width/2,k+d.fontSize),"center"===h&&"bottom"===u&&this.drawthroughLine(S-D.width/2,k,S+D.width/2,k),"right"===h&&"bottom"===u&&this.drawthroughLine(S-D.width,k,S,k),"right"===h&&"top"===u&&this.drawthroughLine(S-D.width,k+d.fontSize,S,k+d.fontSize),"left"===h&&"bottom"===u&&this.drawthroughLine(S,k,S+D.width,k),"left"===h&&"top"===u?this.drawthroughLine(S,k+d.fontSize,S+D.width,k+d.fontSize):"center"===h&&"middle"===u&&this.drawthroughLine(S-D.width/2,k+d.fontSize/2,S+D.width/2,k+d.fontSize/2)}}},{key:"drawthroughLine",value:function(e,t,o,n){this.ctx.strokeStyle="black",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(e,t),this.ctx.lineTo(o,n),this.ctx.closePath(),this.ctx.stroke()}},{key:"clearRect",value:function(e,t,o,n){this.ctx.clearRect(e,t,o,n)}},{key:"drawStrokeRect",value:function(e,t,o,n,l,i){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;this.ctx.lineWidth=r,this.ctx.globalCompositeOperation=null!=i?i:"source-over",this.ctx.strokeStyle=null!=l?l:"black",this.ctx.strokeRect(e,t,o,n)}},{key:"drawFillRect",value:function(e,t,o,n,l,i){this.ctx.fillStyle=null!=l?l:"black",this.ctx.globalCompositeOperation=null!=i?i:"source-over",this.ctx.fillRect(e,t,o,n)}},{key:"drawDashStrokeRect",value:function(e,t,o,n,l,i){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;this.ctx.lineWidth=r,this.ctx.globalCompositeOperation=null!=i?i:"source-over",this.ctx.strokeStyle=null!=l?l:"black",this.ctx.setLineDash([5,5]),this.ctx.strokeRect(e,t,o,n),this.ctx.setLineDash([])}},{key:"drawTriangleRect",value:function(e,t,o,n){this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.x,t.y),this.ctx.lineTo(o.x,o.y),this.ctx.closePath(),this.ctx.fillStyle=null!=n?n:"black",this.ctx.fill()}}]),e}();function y(e){return e>26?e%26==0?String.fromCharCode(64+parseInt((Math.floor(e/26)-1).toFixed(0)))+String.fromCharCode(90):String.fromCharCode(64+parseInt(Math.floor(e/26).toFixed(0)))+String.fromCharCode(64+e%26):String.fromCharCode(64+e)}var w=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};o(this,e),i(this,"mulPersonSelected",[]),i(this,"userId",(new Date).valueOf()),i(this,"userName",(new Date).valueOf().toString()),i(this,"userColor",this.getRandomColor()),i(this,"stepCallbackArr",[]),i(this,"scale",1),i(this,"ws",void 0),i(this,"fontSize",12),i(this,"workBook",{}),i(this,"eSheetWorkBook",[]),i(this,"row",60),i(this,"col",26),i(this,"cellWidth",120),i(this,"cellHeight",40),i(this,"width",600),i(this,"height",600),i(this,"sheetWidth",0),i(this,"sheetHeight",0),i(this,"selectorDom",null),i(this,"canvasDom",null),i(this,"canvasWrapperDom",null),i(this,"layer",null),i(this,"components",{}),i(this,"plugins",{}),i(this,"copyKey",!1),i(this,"copyCellDash",[]),i(this,"shiftKey",!1),i(this,"ctrlKey",!1),i(this,"dragSign",!1),i(this,"lockDrag",!1),i(this,"dragSignDirectionIsHor",!1),i(this,"offsetYLock",!1),i(this,"offsetXLock",!1),i(this,"isScrollBottomBound",!1),i(this,"isScrollRightBound",!1),i(this,"nonSelectBgColor","#FFFFFF"),i(this,"selectedBorderBgColor","#0089FF"),i(this,"selectedBgColor","#EBF4FF"),i(this,"borderColor","#ECEDEE"),i(this,"borderCellBgColor","#F9FBFD"),i(this,"currentSheetIndex",0),i(this,"installComponentsObj",{}),i(this,"installPluginsObj",{}),i(this,"getType",(function(e){return Object.prototype.toString.call(e)})),i(this,"h",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.attr,l=t.style,i=t.attribute,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=document.createElement(e);for(var a in o)s[a]=o[a];for(var c in i)s.setAttribute(c,i[c]);for(var h in l)s.style[h]=l[h];r&&("[object Array]"===n.getType(r)?r.forEach((function(e){s.appendChild(e)})):s.appendChild(r));return s})),i(this,"fps",0),i(this,"lastTime",0),i(this,"draw",(function(){var e=performance.now(),t=e-n.lastTime;n.lastTime=e,n.fps=Math.round(1e3/t),requestAnimationFrame(n.draw)})),l.width=l.width&&!isNaN(l.width)&&l.width>0?l.width:this.width,l.height=l.height&&!isNaN(l.height)&&l.height>0?l.height:this.width,l.row=l.row&&l.row>this.row?l.row:this.row,l.col=l.col&&l.col>this.col?l.col:this.col,l.cellWidth=this.cellWidth,l.cellHeight=this.cellHeight,this.installComponentsObj=r,this.installPluginsObj=s,this.selectorDom=t;var a=document.createElement("canvas");a.width=l.width,a.height=l.height;var c=this.h("div",{attr:{className:"e-sheet-canvas-wrapper"}});if(c.appendChild(a),this.canvasWrapperDom=c,this.selectorDom.style.width=l.width+"px",this.canvasWrapperDom.style.width=l.width+"px",this.canvasWrapperDom.style.height=l.height+"px",this.selectorDom.appendChild(c),this.canvasDom=a,this.layer=new v(a,l,this),this.options=l,l.init)this.installComponents(r),this.installPlugins(s),this.createNewSheet(),this.drawCanvas(),this.freshScrollBar(),this.plugins.SettingPlugin.changeFirstSelectedCell("A1"),this.ws=this.plugins.WebsocketPlugin;else{var h=this.h("e-sheet-loading-cup");this.selectorDom.appendChild(h)}}return l(e,[{key:"loadData",value:function(e){var t=this;!e||Array.isArray(e)&&0===e.length?this.createNewSheet():e.forEach((function(e){t.eSheetWorkBook.push({id:e.id,label:e.label,sheet:e.data,clickCell:null,stepArr:[],stepNum:-1})}))}},{key:"drawExcel",value:function(e){this.installComponents(this.installComponentsObj),this.installPlugins(this.installPluginsObj),this.loadData(e),this.drawCanvas(),this.freshScrollBar(),this.plugins.SettingPlugin.changeFirstSelectedCell("A1"),this.ws=this.plugins.WebsocketPlugin,this.selectorDom.querySelector(".e-sheet-loading-cup-layout").remove()}},{key:"drawCanvas",value:function(){this.currentSheetIndex=0;var e=this.eSheetWorkBook[this.currentSheetIndex];this.components.ContentComponent.installContentDataByData(e.sheet),e.clickCell&&this.components.ContentComponent.showClickRect(e.clickCell),this.components.WholeComponent.draw(),this.components.HeaderComponent.trendsDraw(0),this.components.SideComponent.trendsDraw(0),this.components.ContentComponent.trendsDraw(0,0),this.plugins.BookPlugin.freshBookSheet()}},{key:"getRandomColor",value:function(){var e=Math.floor(16777215*Math.random()).toString(16);return 6===e.length?"#"+e:this.getRandomColor()}},{key:"stepCallbackHandle",value:function(e){this.stepCallbackArr.push(e)}},{key:"exportXlsxData",value:function(){var e=[];return this.eSheetWorkBook.forEach((function(t){var o=t.sheet.filter((function(e){return e.isMerge})),n=o.filter((function(e){return e.mergeStartLabel===e.label})).map((function(e){var t=o.findIndex((function(t){return t.label===e.mergeEndLabel})),n=o[t];return{s:{c:e.col-1,r:e.row-1},e:{c:n.col-1,r:n.row-1}}})),l=t.sheet.filter((function(e){return!!e.text})).filter((function(e){return e.isMerge&&e.label===e.mergeStartLabel||!e.isMerge})),i={};l.forEach((function(e){i[e.label]={t:"s",v:e.text}})),l.length>1?i["!ref"]=l[0].label+":"+l[l.length-1].label:1===l.length&&(i["!ref"]=l[0].label);var r={label:t.label,sheet:i};n.length>0&&(i["!merges"]=n),e.push(r)})),e}},{key:"connectWebSocket",value:function(e){this.ws.connect(e)}},{key:"setUserName",value:function(e){this.userName=e}},{key:"switchSheet",value:function(e){this.saveHandle();var t=this.eSheetWorkBook[e];if(this.currentSheetIndex=e,this.components.ContentComponent.installContentDataByData(t.sheet),t.clickCell)this.components.ContentComponent.showClickRect(t.clickCell),this.plugins.SettingPlugin.setLabelCon(t.clickCell.label),this.plugins.SettingPlugin.setCellCon(t.clickCell.text);else{var o=this.components.ContentComponent.searchRectByLabel("A1");this.components.ContentComponent.showClickRect(o),this.plugins.SettingPlugin.setLabelCon(o.label),this.plugins.SettingPlugin.setCellCon(o.text)}this.fresh()}},{key:"saveHandle",value:function(){(this.copyKey=!1,this.copyCellDash=[],this.components.ContentComponent&&this.components.ContentComponent.clickCell)&&(this.eSheetWorkBook[this.currentSheetIndex].clickCell=this.components.ContentComponent.clickCell,this.components.ContentComponent.hideClickRect())}},{key:"getCurrentSheet",value:function(){return this.eSheetWorkBook[this.currentSheetIndex]}},{key:"createNewSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet";this.saveHandle();var t=this.options,o=t.row,n=t.col,l=t.cellWidth,i=t.cellHeight,r=0,s=0,a=0,c=i;this.sheetWidth=0,this.sheetHeight=0;for(var h=1,d=e+h,u=this.eSheetWorkBook.findIndex((function(e){return e.label===d}));-1!==u;)h++,d=e+h,u=this.eSheetWorkBook.findIndex((function(e){return e.label===d}));this.eSheetWorkBook.push({id:(new Date).valueOf(),label:d,sheet:[],clickCell:null,stepArr:[],stepNum:-1}),this.currentSheetIndex=this.eSheetWorkBook.length-1;for(var g=this.eSheetWorkBook[this.eSheetWorkBook.length-1].sheet,p=0;p<o;p++){r=0,s=i,this.sheetHeight+=i;for(var m=0;m<n;m++){0===p&&(this.sheetWidth+=l);var f=y(m+1)+(p+1);g.push({row:p+1,col:m+1,text:"",textAsNumber:NaN,width:l,height:i,x:r,y:a,ltX:s,ltY:c,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:"#ffffff",fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",strikethrough:"",underline:"",label:f}),r+=l,s+=l}a+=i,c+=i}}},{key:"initExcelData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet1",t=this.options,o=t.row,n=t.col,l=t.cellWidth,i=t.cellHeight,r=0,s=0,a=0,c=i;this.sheetWidth=0,this.sheetHeight=0;var h=this.eSheetWorkBook.findIndex((function(t){return t.label===e})),d=0;-1===h?(this.eSheetWorkBook.push({label:e,sheet:[]}),d=this.eSheetWorkBook.length-1):d=h,this.eSheetWorkBook[d].sheet=[];for(var u=0;u<o;u++){r=0,s=i,this.sheetHeight+=i;for(var g=0;g<n;g++){var p,m;0===u&&(this.sheetWidth+=l);var f=y(g+1)+(u+1);this.eSheetWorkBook[d].sheet.push({row:u+1,col:g+1,text:this.workBook[e]&&null!==(p=null===(m=this.workBook[e][String.fromCharCode(65+g)+(u+1)])||void 0===m?void 0:m.v)&&void 0!==p?p:"",textAsNumber:NaN,width:l,height:i,x:r,y:a,ltX:s,ltY:c,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:"#ffffff",fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",label:f}),r+=l,s+=l}a+=i,c+=i}}},{key:"installXlsxData",value:function(e){if(this.workBook=e,0===Object.keys(e).length)throw new Error("data is error");this.initExcelData(Object.keys(e)[0]),this.components.ContentComponent.installContentDataByName(Object.keys(e)[0]),this.components.ContentComponent.hideClickRect(),this.fresh()}},{key:"installComponents",value:function(e){for(var t in e)this.components[t]=new e[t](this.layer,this.options,this)}},{key:"installPlugins",value:function(e){for(var t in e)this.plugins[t]=new e[t](this.selectorDom,this.layer,this.options,this.components,this)}},{key:"fresh",value:function(){var e=this.plugins.ScrollPlugin,t=e.offsetX,o=e.offsetY,n=this.components,l=n.ContentComponent,i=n.HeaderComponent,r=n.SideComponent,s=n.WholeComponent;l.trendsDraw(t,o),i.trendsDraw(t),r.trendsDraw(o),s.draw()}},{key:"freshContent",value:function(){var e=this.plugins.ScrollPlugin,t=e.offsetX,o=e.offsetY;this.components.ContentComponent.trendsDraw(t,o)}},{key:"freshScrollBar",value:function(){this.plugins.ScrollPlugin.changeHorBarWidth(),this.plugins.ScrollPlugin.changeVerBarHeight()}}]),e}(),b=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"options",{}),i(this,"layer",null),i(this,"core",null),this.layer=t,this.options=n,this.core=l}return l(e,[{key:"draw",value:function(){var e=this.core,t=e.borderCellBgColor,o=e.borderColor,n=this.options.cellHeight;this.layer.clearRect(0,0,n,n),this.layer.drawTriangleRect({x:n-6,y:6},{x:n-6,y:n-6},{x:6,y:n-6},"#DCDCDC"),this.layer.drawLine([0,0,n,0],null,o),this.layer.drawLine([0,0,0,n],null,o),this.layer.drawFillRect(0,0,n,n,t,"destination-over")}},{key:"addEvent",value:function(){}}]),e}(),S=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"options",{}),i(this,"layer",null),i(this,"headerRectGroup",[]),this.options=n,this.layer=t,this.core=l}return l(e,[{key:"initDraw",value:function(){for(var e=this.options.col,t=this.options.cellWidth,o=this.options.cellHeight,n=0;n<e;n++){var l=String.fromCharCode(65+n),i=new Konva.Rect({x:n*t+40,y:0,width:t,height:o,fill:"#c0c4cc",stroke:"#606266",strokeWidth:1,attrs:{headerLabel:l,col:n,row:0}}),r=new Konva.Text({x:n*t+40,y:0,width:t,height:o,align:"center",verticalAlign:"middle",text:l,fontSize:20,fontFamily:"Calibri",fill:"black",attrs:{headerLabel:l,col:n,row:0}});i.hide(),r.hide(),this.headerBackGroup.add(i),this.headerTextGroup.add(r)}var s=new Konva.Line({points:[0,0,0,0],stroke:"blue",strokeWidth:1,lineCap:"round",lineJoin:"round"});this.headerBorderGroup.add(s)}},{key:"trendsDraw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=this.options,n=o.width,l=o.cellHeight,i=this.core,r=i.borderCellBgColor,s=i.nonSelectBgColor,a=i.borderColor,c=i.selectedBgColor,h=this.core.components.ContentComponent,d=h.contentGroup,u=h.clickCell,g=h.clickRectShow,p=h.isRowSelect,m=h.secondClickCell,f=h.attrSecond,C=h.attrFirst,v=h.startAndEndRect,y=this.searchScreenAddr(t,0),w=this.searchScreenAddr(t+n-l,l),b=d.filter((function(e){return e.col>=y.col&&1===e.row&&e.col<=w.col}));this.headerRectGroup=b,this.layer.clearRect(l,0,n,l),this.layer.drawLine([l,0,n,0],null,a),this.layer.drawLine([l,l,n,l],null,a);for(var S=function(){var o=b[k];if(e.layer.drawText(o.x+l-t,0,o.label.slice(0,o.label.length-1),o.width,l,"destination-over",null,null,{fontSize:12,fontFamily:"",fontWeight:"",fontItalic:""}),e.layer.drawLine([o.x+l-t,0,o.x+l-t,l],"destination-over",a),g&&!p){var n=v?C.col:(null==m?void 0:m.col)>u.col?u.col:null==m?void 0:m.col,i=v?f.col:(null==m?void 0:m.col)>u.col?null==m?void 0:m.col:u.col;if(m&&o.col>=n&&o.col<=i)e.layer.drawFillRect(o.x+l-t,0,o.width,l,c,"destination-over");else if(o.col!==u.col||u.isMerge)if(u.isMerge){-1!==e.findClickCellRowArr(u).findIndex((function(e){return e===o.col}))&&e.layer.drawFillRect(o.x+l-t,0,o.width,l,c,"destination-over")}else e.layer.drawFillRect(o.x+l-t,0,o.width,l,r,"destination-over");else e.layer.drawFillRect(o.x+l-t,0,o.width,l,c,"destination-over")}else e.layer.drawFillRect(o.x+l-t,0,o.width,l,r,"destination-over");e.layer.drawFillRect(o.x+l-t,0,o.width,l,s,"destination-over")},k=0;k<b.length;k++)S()}},{key:"findClickCellRowArr",value:function(e){for(var t=[],o=e.col+e.mergeCol-1,n=e.col;n<=o;n++)t.push(n);return t}},{key:"searchScreenAddr",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.core.components.ContentComponent.contentGroup.filter((function(e){return 1===e.row})),n=0,l=0,i=0,r=0,s=0;s<o.length;s++){var a=o[s];if(l=(n=a.x)+a.width,r=(i=a.y)+a.height,n<=e&&e<=l&&i<=t&&t<=r&&1===a.row)return a}return o[o.length-1]}}]),e}(),k=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"options",{}),i(this,"layer",null),i(this,"sideRectGroup",[]),this.options=n,this.layer=t,this.core=l}return l(e,[{key:"initDraw",value:function(){for(var e=this.options,t=e.row,o=e.cellHeight,n=0;n<t;n++){var l=new Konva.Rect({x:0,y:n*o+40,width:o,height:o,fill:"#fff",stroke:"#606266",strokeWidth:1,attrs:{uniPos:"header"+n,exHeaderCell:!0,col:0,row:n,zIndex:99}}),i=new Konva.Text({x:0,y:n*o+40,width:o,height:o,text:n+1,fontSize:20,align:"center",verticalAlign:"middle",fontFamily:"Calibri",fill:"black",attrs:{col:0,row:n,label:n}});l.hide(),i.hide(),this.sideBackGroup.add(l),this.sideTextGroup.add(i)}var r=new Konva.Line({points:[0,0,0,0],stroke:"blue",strokeWidth:1,lineCap:"round",lineJoin:"round"});this.sideBorderGroup.add(r)}},{key:"trendsDraw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=this.options,n=o.height,l=o.cellHeight,i=this.core.components.ContentComponent,r=i.contentGroup,s=i.clickCell,a=i.clickRectShow,c=i.isColSelect,h=i.secondClickCell,d=i.attrSecond,u=i.attrFirst,g=i.startAndEndRect,p=this.core,m=p.borderCellBgColor;p.selectedBorderBgColor;var f=p.borderColor,C=p.selectedBgColor,v=p.nonSelectBgColor,y=this.searchScreenAddr(0,t),w=this.searchScreenAddr(l,n-l+t),b=r.filter((function(e){return e.row>=y.row&&1===e.col&&e.row<=w.row}));this.sideRectGroup=b,this.layer.clearRect(0,l,l,n),this.layer.drawLine([0,l,0,n],null,f),this.layer.drawLine([l,l,l,n],null,f);for(var S=function(){var o=b[k];if(e.layer.drawText(0,o.y+l-t,o.row,l,o.height,"destination-over",null,null,{fontSize:o.fontSize,fontWeight:o.fontWeight,fontItalic:o.fontItalic,fontFamily:o.fontFamily}),e.layer.drawLine([0,o.y+l-t,l,o.y+l-t],"destination-over",f),a&&!c){var n=g?u.row:(null==h?void 0:h.row)>s.row?s.row:null==h?void 0:h.row,i=g?d.row:(null==h?void 0:h.row)>s.row?null==h?void 0:h.row:s.row;if(h&&o.row>=n&&o.row<=i)e.layer.drawFillRect(0,o.y+l-t,l,o.height,C,"destination-over");else if(s.row!==o.row||s.isMerge)if(s.isMerge){-1!==e.findClickCellRowArr(s).findIndex((function(e){return e===o.row}))&&e.layer.drawFillRect(0,o.y+l-t,l,o.height,C,"destination-over")}else e.layer.drawFillRect(0,o.y+l-t,l,o.height,m,"destination-over");else e.layer.drawFillRect(0,o.y+l-t,l,o.height,C,"destination-over")}else e.layer.drawFillRect(0,o.y+l-t,l,o.height,m,"destination-over");e.layer.drawFillRect(0,o.y+l-t,l,o.height,v,"destination-over")},k=0;k<b.length;k++)S()}},{key:"findClickCellRowArr",value:function(e){for(var t=[],o=e.row+e.mergeRow-1,n=e.row;n<=o;n++)t.push(n);return t}},{key:"searchScreenAddr",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.core.components.ContentComponent.contentGroup.filter((function(e){return 1===e.col})),n=0,l=0,i=0,r=0,s=0;s<o.length;s++){var a=o[s];if(l=(n=a.x)+a.width,r=(i=a.y)+a.height,n<=e&&e<=l&&i<=t&&t<=r&&1===a.col)return a}return o[o.length-1]}}]),e}(),x=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;o(this,e),i(this,"selectedCellTopBorderDom",null),i(this,"selectedCellBottomBorderDom",null),i(this,"selectedCellLeftBorderDom",null),i(this,"selectedCellRightBorderDom",null),i(this,"selectedCellWidth",0),i(this,"selectedCellHeight",0),i(this,"canvasDom",null),i(this,"options",{}),i(this,"offsetX",0),i(this,"offsetY",0),i(this,"clickRectShow",!1),i(this,"moveClickCell",null),i(this,"clickCell",null),i(this,"secondClickCell",null),i(this,"isColSelect",!1),i(this,"isRowSelect",!1),i(this,"moreSelectedCell",[]),i(this,"mergeSelectedCell",[]),i(this,"startAndEndRect",null),i(this,"attrFirst",null),i(this,"attrSecond",null),i(this,"layer",null),i(this,"contentGroup",[]),i(this,"moveCell",(function(e){var t=n.options.cellHeight,o=n.core.plugins.ScrollPlugin,l=o.offsetX,i=o.offsetY,r=n.core.plugins.SelectPlugin.searchRectAddr(e.offsetX+l-t,e.offsetY+i-t);n.moveClickCell=r,n.showSelectedCellDom(r.x+t-l,r.y-i+t,r.isMerge?r.mergeWidth:r.width,r.isMerge?r.mergeHeight:r.height)})),i(this,"cellPainterDom",null),i(this,"cellPainterTopBorderDom",null),i(this,"cellPainterBottomBorderDom",null),i(this,"cellPainterLeftBorderDom",null),i(this,"cellPainterRightBorderDom",null),this.options=l,this.layer=t,this.core=r,this.canvasDom=r.canvasDom,this.selectorDom=r.selectorDom,this.canvasWrapperDom=r.canvasWrapperDom,this.registrySelectedCellDom(),this.registryCellPainterDom()}return l(e,[{key:"installContentDataByName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet1",t=this.core.eSheetWorkBook.findIndex((function(t){return t.label===e}));this.contentGroup=this.core.eSheetWorkBook[t].sheet}},{key:"installContentDataByData",value:function(e){this.contentGroup=e}},{key:"showClickRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.clickCell=e,this.clickRectShow=!0,this.isColSelect=t,this.isRowSelect=o,this.core.ws&&this.core.ws.wsSend(0,e)}},{key:"setSecondClickCell",value:function(e){this.secondClickCell=e}},{key:"hideClickRect",value:function(){this.clickRectShow=!1,this.isColSelect=!1,this.isRowSelect=!1,this.secondClickCell=null,this.clickCell=null,this.moreSelectedCell=[],this.hideSelectedCellDom()}},{key:"drawMulPersonSelected",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.options.cellHeight;this.core.mulPersonSelected.forEach((function(l){var i=l.command;if(i.isMerge){var r=i.mergeWidth,s=i.mergeHeight;e.layer.drawStrokeRect(i.x+n-t,i.y-o+n,r,s,l.userColor,"destination-over",2)}else e.layer.drawStrokeRect(i.x+n-t,i.y-o+n,i.width,i.height,l.userColor,"destination-over",2);e.layer.drawText(i.x+n-t+6,i.y-o+n-16,l.userName,i.width,20,"destination-over","#ffffff","left",{},"top"),e.layer.drawFillRect(i.x+n-t,i.y-o+n-20,i.width,20,l.userColor,"destination-over")}))}},{key:"initDraw",value:function(){for(var e=this.options.col,t=this.options.row,o=this.options.cellWidth,n=this.options.cellHeight,l=0;l<t;l++)for(var i=0;i<e;i++){var r=String.fromCharCode(65+i),s=new Konva.Rect({x:i*o+40,y:l*n+40,width:o,height:n,stroke:"#dcdfe6",strokeWidth:1,listening:!1,attrs:{row:l,col:i,name:r+(l+1)}}),a=new Konva.Text({x:i*o+40,y:l*n+40,width:o,height:n,align:"center",verticalAlign:"middle",padding:6,ellipsis:!0,fontSize:12,fontFamily:"Calibri",fill:"black",attrs:{row:l,col:i,name:r+(l+1)}});s.hide(),a.hide(),this.contentBackGroup.add(s),this.contentTextGroup.add(a)}var c=new Konva.Rect({x:0,y:0,width:0,height:0});this.contentBorderGroup.add(c)}},{key:"showSelectedCellDom",value:function(e,t,o,n){var l,i;o=null!==(l=o)&&void 0!==l?l:this.selectedCellWidth,n=null!==(i=n)&&void 0!==i?i:this.selectedCellHeight,this.selectedCellWidth=o,this.selectedCellHeight=n,t<this.core.cellHeight||e<this.core.cellHeight?this.hideSelectedCellDom():(this.selectedCellTopBorderDom.style.display="block",this.selectedCellTopBorderDom.style.left=e+"px",this.selectedCellTopBorderDom.style.top=t+"px",this.selectedCellTopBorderDom.style.width=o+"px",this.selectedCellBottomBorderDom.style.display="block",this.selectedCellBottomBorderDom.style.left=e+"px",this.selectedCellBottomBorderDom.style.top=t+n-4+"px",this.selectedCellBottomBorderDom.style.width=o+"px",this.selectedCellLeftBorderDom.style.display="block",this.selectedCellLeftBorderDom.style.left=e+"px",this.selectedCellLeftBorderDom.style.top=t+"px",this.selectedCellLeftBorderDom.style.height=n+"px",this.selectedCellRightBorderDom.style.display="block",this.selectedCellRightBorderDom.style.left=e+o-4+"px",this.selectedCellRightBorderDom.style.top=t+"px",this.selectedCellRightBorderDom.style.height=n+"px"),this.showSelectedCellPainterDom(e+o,t+n)}},{key:"setSelectedCellBorderDomBgColor",value:function(e){var t=this.core.selectedBorderBgColor,o=null!=e?e:t;this.selectedCellTopBorderDom.style.backgroundColor=o,this.selectedCellBottomBorderDom.style.backgroundColor=o,this.selectedCellLeftBorderDom.style.backgroundColor=o,this.selectedCellRightBorderDom.style.backgroundColor=o}},{key:"hideSelectedCellDom",value:function(){this.selectedCellTopBorderDom.style.display="none",this.selectedCellBottomBorderDom.style.display="none",this.selectedCellLeftBorderDom.style.display="none",this.selectedCellRightBorderDom.style.display="none",this.cellPainterDom.style.display="none"}},{key:"searchAllCellInMergeCell",value:function(e){if(e||!e.isMerge)return[];for(var t=e.row+e.mergeRow,o=e.col+e.mergeCol,n=[],l=e.row;l<t;l++)for(var i=e.col;i<o;i++)n.push(this.searchRectByColAndRow(i,l));return n}},{key:"initMoreSelectedCell",value:function(){var e=this.moreSelectedCell,t=this.clickCell,o="",n="";if(e.length>0)o=JSON.stringify(e),e.forEach((function(e){e.text="",e.fontColor="",e.bgColor="",e.font="",e.textAlign="",e.mergeWidth=0,e.mergeHeight=0,e.mergeRow=1,e.mergeCol=1,e.isMerge=!1,e.fontSize=12,e.fontFamily=""})),n=JSON.stringify(e);else if(t.isMerge){o=JSON.stringify(this.searchAllCellInMergeCell(t));for(var l=t.row+t.mergeRow,i=t.col+t.mergeCol,r=[],s=t.row;s<l;s++)for(var a=t.col;a<i;a++){var c=this.searchRectByColAndRow(a,s);c.text="",c.fontSize=12,c.fontFamily="",c.fontColor="",c.bgColor="",c.font="",c.textAlign="",c.mergeWidth=0,c.mergeHeight=0,c.mergeRow=1,c.mergeCol=1,c.isMerge=!1,r.push(c)}n=JSON.stringify(r)}else o=JSON.stringify([t]),t.text="",t.fontColor="",t.bgColor="",t.font="",t.textAlign="",t.mergeWidth=0,t.mergeHeight=0,t.mergeRow=1,t.mergeCol=1,t.isMerge=!1,t.fontSize=12,t.fontFamily="",n=JSON.stringify([t]);return{preCellStr:o,lastCellStr:n}}},{key:"searchAllCellsByMoreSelectedCellAndTargetCell",value:function(e,t){var o=[];if(!(t.length>1))return[e];for(var n=t[0],l=t[t.length-1],i=l.col-n.col,r=l.row-n.row,s=e.row,a=e.row+r;s<=a;s++)for(var c=e.col,h=e.col+i;c<=h;c++)o.push(this.searchRectByColAndRow(c,s));return o}},{key:"moveSelectedCellDom",value:function(){var e=this;this.setSelectedCellBorderDomBgColor(),this.canvasDom.onmousemove=function(t){e.moveCell(t)},this.canvasWrapperDom.onmouseup=function(t){if(e.setSelectedCellBorderDomBgColor("transparent"),e.moveClickCell&&!e.moveClickCell.isMerge){var o=e.core.plugins,n=o.SelectPlugin,l=o.SettingPlugin,i=n.transformCanvasCellToTableDomStr(),r=e.initMoreSelectedCell(),s=r.preCellStr,a=r.lastCellStr,c=e.searchAllCellsByMoreSelectedCellAndTargetCell(e.moveClickCell,JSON.parse(s));l.changeStepArr({type:16,pre:{beforeStr:s,lastStr:a},next:{beforeStr:JSON.stringify(c),lastStr:i,label:e.moveClickCell.label}}),e.core.ws.wsSend(16,{pre:a,next:i,label:e.moveClickCell.label}),n.transformTableDomStrToCanvasCell(i,e.moveClickCell),e.setSecondClickCell(null),e.moveClickCell=null,e.canvasDom.onmousemove=null,e.canvasWrapperDom.onmouseup=null}}}},{key:"registrySelectedCellDom",value:function(){var e=this,o=this.core,n=o.h,l=o.canvasWrapperDom,i={onmousedown:function(t){e.moveSelectedCellDom()},oncontextmenu:function(e){e.preventDefault()}},r={left:0,top:0,display:"none"},s=n("div",{attr:t({className:"e-sheet-hor-cell-border"},i),style:t(t({},r),{},{width:0})}),a=n("div",{attr:t({className:"e-sheet-hor-cell-border"},i),style:t(t({},r),{},{width:0})}),c=n("div",{attr:t({className:"e-sheet-ver-cell-border"},i),style:t(t({},r),{},{height:0})}),h=n("div",{attr:t({className:"e-sheet-ver-cell-border"},i),style:t(t({},r),{},{height:0})});this.selectedCellTopBorderDom=s,this.selectedCellBottomBorderDom=a,this.selectedCellLeftBorderDom=c,this.selectedCellRightBorderDom=h,l.appendChild(s),l.appendChild(a),l.appendChild(c),l.appendChild(h)}},{key:"registryCellPainterDom",value:function(){var e=this,t=this.core,o=t.h,n=t.canvasWrapperDom;this.cellPainterDom=o("div",{attr:{className:"e-sheet-cell-painter",onmouseup:function(t){e.canvasDom.onmousemove=null}}}),this.cellPainterTopBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{height:"4px",display:"none"}}),this.cellPainterBottomBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{height:"4px",display:"none"}}),this.cellPainterLeftBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{width:"4px",display:"none"}}),this.cellPainterRightBorderDom=o("div",{attr:{className:"e-sheet-cell-painter-border",onmouseup:function(t){e.canvasDom.onmousemove=null}},style:{width:"4px",display:"none"}}),n.appendChild(this.cellPainterTopBorderDom),n.appendChild(this.cellPainterBottomBorderDom),n.appendChild(this.cellPainterLeftBorderDom),n.appendChild(this.cellPainterRightBorderDom),this.cellPainterDom.oncontextmenu=function(e){e.preventDefault()},this.cellPainterDom.onmousedown=function(t){t.stopImmediatePropagation();var o=parseInt(e.cellPainterDom.style.left),n=parseInt(e.cellPainterDom.style.top),l=0,i=0,r=0,s=0,a=0,c=0,h=null,d=null,u="";e.canvasDom.onmousemove=function(t){var g=e.options.cellHeight,p=e.clickCell,m=e.moreSelectedCell,f=e.core.plugins.ScrollPlugin,C=f.offsetX,v=f.offsetY,y=e.core.plugins.SelectPlugin.searchRectAddr(t.offsetX+C-g,t.offsetY+v-g),w=Math.abs(t.offsetX-o),b=Math.abs(t.offsetY-n);if(m.length>0){var S=m.filter((function(e){return e.row===p.row}));d=S[S.length-1],l=d.col-p.col+1,r=d.x-p.x+d.width;var k=m.filter((function(e){return e.col===p.col}));h=k[k.length-1],i=h.row-p.row+1,s=h.y-p.y+h.height,m[m.length-1]}else p.isMerge?(d=e.searchRectByColAndRow(p.col+p.mergeCol-1,p.row),h=e.searchRectByColAndRow(p.col,p.row+p.mergeRow-1),e.searchRectByLabel(p.mergeEndLabel),r=p.mergeWidth,s=p.mergeHeight):(d=h=p,r=p.width,s=p.height),l=p.mergeCol,i=p.mergeRow;if(t.offsetX>=p.ltX-C&&t.offsetX<=p.ltX-C+r&&t.offsetY>=p.ltY-v&&t.offsetY<=p.ltY-v+s)return e.hidePainterBorderDom(),u=null,e.canvasWrapperDom.onmouseup=null,void(e.canvasDom.onmouseup=null);if(w>b){var x=e.searchRectByColAndRow(y.col,p.row);t.offsetX>o?(u="right",a=Math.ceil(Math.abs(x.col-d.col)/l),e.showPainterBorderDom(p.ltX+r-C,p.ltY-v,r*a,s)):t.offsetX<o&&(u="left",a=Math.ceil(Math.abs(x.col-p.col)/l),e.showPainterBorderDom(p.ltX-r*a-C,p.ltY-v,r*a,s))}else{var D=e.searchRectByColAndRow(p.col,y.row);t.offsetY>n?(u="bottom",c=Math.ceil(Math.abs(D.row-h.row)/i),e.showPainterBorderDom(p.ltX,p.ltY+s-v,r,s*c)):t.offsetY<n&&(u="top",c=Math.ceil(Math.abs(D.row-p.row)/i),e.showPainterBorderDom(p.ltX,p.ltY-s*c-v,r,s*c))}e.canvasWrapperDom.onmouseup=function(t){if(t.stopImmediatePropagation(),null!==u){var o=e.core.plugins,n=o.SelectPlugin,r=o.SettingPlugin,s=n.transformCanvasCellToTableDomStr(),h=[];if("right"===u)for(var d=1;d<=a;d++)h.push(e.searchRectByColAndRow(p.col+d*l,p.row));else if("left"===u)for(var g=1;g<=a;g++)h.push(e.searchRectByColAndRow(p.col-g*l,p.row));else if("bottom"===u)for(var f=1;f<=c;f++)h.push(e.searchRectByColAndRow(p.col,p.row+f*i));else if("top"===u)for(var C=1;C<=c;C++)h.push(e.searchRectByColAndRow(p.col,p.row-C*i));var v=[];h.forEach((function(t){v.push(JSON.stringify(e.searchAllCellsByMoreSelectedCellAndTargetCell(t,m)))}));var y=[];h.forEach((function(e){y.push({tableDomStr:s,label:e.label}),n.transformTableDomStrToCanvasCell(s,e)})),r.changeStepArr({type:17,pre:v,next:y}),e.core.ws.wsSend(17,{next:y}),e.setSecondClickCell(null),e.canvasDom.onmousemove=null,e.canvasWrapperDom.onmouseup=null,e.hidePainterBorderDom()}}}},n.appendChild(this.cellPainterDom)}},{key:"hidePainterBorderDom",value:function(){this.cellPainterTopBorderDom.style.display="none",this.cellPainterBottomBorderDom.style.display="none",this.cellPainterLeftBorderDom.style.display="none",this.cellPainterRightBorderDom.style.display="none"}},{key:"showPainterBorderDom",value:function(e,t,o,n){this.cellPainterTopBorderDom.style.left=e+"px",this.cellPainterTopBorderDom.style.top=t+"px",this.cellPainterTopBorderDom.style.width=o+"px",this.cellPainterTopBorderDom.style.display="block",this.cellPainterBottomBorderDom.style.left=e+"px",this.cellPainterBottomBorderDom.style.top=t+n-4+"px",this.cellPainterBottomBorderDom.style.width=o+"px",this.cellPainterBottomBorderDom.style.display="block",this.cellPainterLeftBorderDom.style.left=e+"px",this.cellPainterLeftBorderDom.style.top=t+"px",this.cellPainterLeftBorderDom.style.height=n+"px",this.cellPainterLeftBorderDom.style.display="block",this.cellPainterRightBorderDom.style.left=e+o-4+"px",this.cellPainterRightBorderDom.style.top=t+"px",this.cellPainterRightBorderDom.style.height=n+"px",this.cellPainterRightBorderDom.style.display="block"}},{key:"showSelectedCellPainterDom",value:function(e,t){t<this.core.cellHeight||e<this.core.cellHeight||e>this.options.width||t>this.options.height?this.cellPainterDom.style.display="none":this.cellPainterDom.style.display="block",this.cellPainterDom.style.left=e-3+"px",this.cellPainterDom.style.top=t-3+"px",this.cellPainterDom.style.cursor="url(".concat(C.crosshair,") 18 18, crosshair")}},{key:"hideCellPainterDom",value:function(){this.cellPainterDom.style.display="none"}},{key:"trendsDraw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.options,l=n.width,i=n.height,r=n.cellHeight;n.cellWidth;var s=this.core,a=s.nonSelectBgColor,c=s.selectedBorderBgColor,h=s.borderColor,d=s.selectedBgColor,u=s.copyKey,g=this.searchScreenAddr(t,o),p=this.searchScreenAddr(t+l-r,o+i-r);this.layer.clearRect(r,r,l,i);var m=this.core.copyCellDash;if(u)if(m.length>1){var f=m[0],C=m[m.length-1];this.layer.drawDashStrokeRect(f.ltX-t+2,f.ltY-o+2,C.ltX-f.ltX+C.width-4,C.ltY-f.ltY+C.height-4,c,"destination-over")}else if(1===m.length){var v=m[0];v.isMerge?this.layer.drawDashStrokeRect(v.ltX-t+2,v.ltY-o+2,v.mergeWidth-4,v.mergeHeight-4,c,"destination-over"):this.layer.drawDashStrokeRect(v.ltX-t+2,v.ltY-o+2,v.width-4,v.height-4,c,"destination-over")}var y=null,w=null,b=null;if(this.secondClickCell){y=this.clickCell;var S=(w=this.secondClickCell).x>y.x,k=w.y>y.y;if(b=S&&!k?this.searchRectIsMerge(y.x,w.y,w.x,y.y,y,w):S&&k?this.searchRectIsMerge(y.x,y.y,w.x,w.y,y,w):!S&&k?this.searchRectIsMerge(w.x,y.y,y.x,w.y,y,w):this.searchRectIsMerge(w.x,w.y,y.x,y.y,y,w),this.startAndEndRect=b,b){var x=[],D=[];b.forEach((function(t){x.push(e.searchRectByLabel(t.mergeStartLabel)),D.push(e.searchRectByLabel(t.mergeEndLabel))}));var M=x.concat([y,w]),I=D.concat([y,w]),A=M.sort((function(e,t){return e.x-t.x}))[0].col,B=M.sort((function(e,t){return e.y-t.y}))[0].row,L=I.sort((function(e,t){return e.x-t.x}))[I.length-1].col,T=I.sort((function(e,t){return e.y-t.y}))[I.length-1].row;y=this.searchRectByColAndRow(A,B),w=this.searchRectByColAndRow(L,T),this.attrFirst=y,this.attrSecond=w}}var R=g.col,P=p.col,N=g.row,Z=p.row,W=this.contentGroup;if(this.clickRectShow)if(this.isColSelect&&!this.isRowSelect)this.layer.drawStrokeRect(this.clickCell.x+r-t,r,this.clickCell.width,this.core.isScrollBottomBound?i-r:i,c,"destination-over",2);else if(this.isRowSelect&&!this.isColSelect)this.layer.drawStrokeRect(r,this.clickCell.y-o+r,this.core.isScrollRightBound?l-r:l,r,c,"destination-over",2);else if(this.isRowSelect&&this.isColSelect)this.layer.drawStrokeRect(r,r,this.core.isScrollRightBound?l-r:l,this.core.isScrollBottomBound?i-r:i,c,"destination-over",2);else if(this.secondClickCell)if(b)b&&(this.layer.drawStrokeRect(y.x+r-t,y.y-o+r,w.x-y.x+w.width,w.y-y.y+w.height,c,"destination-over",2),this.showSelectedCellDom(y.x+r-t,y.y-o+r,w.x-y.x+w.width,w.y-y.y+w.height));else if(this.secondClickCell.x>=this.clickCell.x){var H=this.secondClickCell.y>this.clickCell.y;this.layer.drawStrokeRect(this.clickCell.x+r-t,(H?this.clickCell.y:this.secondClickCell.y)-o+r,this.secondClickCell.x-this.clickCell.x+this.secondClickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height,c,"destination-over",2),this.showSelectedCellDom(this.clickCell.x+r-t,(H?this.clickCell.y:this.secondClickCell.y)-o+r,this.secondClickCell.x-this.clickCell.x+this.secondClickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height)}else{var j=this.secondClickCell.y>this.clickCell.y;this.layer.drawStrokeRect(this.secondClickCell.x+r-t,(j?this.clickCell.y:this.secondClickCell.y)-o+r,this.clickCell.x-this.secondClickCell.x+this.clickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height,c,"destination-over",2),this.showSelectedCellDom(this.secondClickCell.x+r-t,(j?this.clickCell.y:this.secondClickCell.y)-o+r,this.clickCell.x-this.secondClickCell.x+this.clickCell.width,Math.abs(this.secondClickCell.y-this.clickCell.y)+this.secondClickCell.height)}else if(this.clickCell.isMerge){var G=this.clickCell,E=G.mergeWidth,Y=G.mergeHeight;this.layer.drawStrokeRect(this.clickCell.x+r-t,this.clickCell.y-o+r,E,Y,c,"destination-over",2),this.showSelectedCellDom(this.clickCell.x+r-t,this.clickCell.y-o+r,E,Y)}else this.layer.drawStrokeRect(this.clickCell.x+r-t,this.clickCell.y-o+r,this.clickCell.width,this.clickCell.height,c,"destination-over",2),this.showSelectedCellDom(this.clickCell.x+r-t,this.clickCell.y-o+r,this.clickCell.width,this.clickCell.height);this.drawMulPersonSelected(t,o),this.moreSelectedCell=[],this.mergeSelectedCell=[];for(var z=0;z<W.length;z++){var X=W[z],F=X.row,V=X.col,J=X.text,O=X.x,_=X.y,U=X.width,Q=X.height;if(V>=R&&V<=P&&F>=N&&F<=Z)if(X.isMerge)if(X.label===X.mergeStartLabel){var K=X.mergeWidth,q=X.mergeHeight;this.layer.drawStrokeRect(O-t+r,_-o+r,K,q,h,"destination-over",1),this.layer.drawText(O-t+r,_-o+r,J,K,q,"destination-over",X.fontColor,X.textAlign,{fontSize:X.fontsize,fontFamily:X.fontFamily,fontWeight:X.fontWeight,fontItalic:X.fontItalic},X.textBaseline,X.strikethrough,X.underline),this.layer.drawFillRect(O-t+r,_-o+r,K,q,X.bgColor?X.bgColor:a,"destination-over",1)}else{var $=this.searchRectByLabel(X.mergeStartLabel);$.col>=R&&$.col<=P&&$.row>=N&&$.row<=Z||(this.layer.drawStrokeRect($.x-t+r,$.y-o+r,$.mergeWidth,$.mergeHeight,h,"destination-over",1),this.layer.drawText($.x-t+r,$.y-o+r,$.text,$.mergeWidth,$.mergeHeight,"destination-over",$.fontColor,$.textAlign,{fontsize:$.fontSize,fontFamily:$.fontFamily,fontWeight:$.fontWeight,fontItalic:$.fontItalic},$.textBaseline,X.strikethrough,X.underline),this.layer.drawFillRect($.x-t+r,$.y-o+r,$.mergeWidth,$.mergeHeight,$.bgColor?$.bgColor:a,"destination-over",1))}else X.isMerge||(this.layer.drawStrokeRect(O-t+r,_-o+r,U,Q,h,"destination-over",1),this.layer.drawText(O-t+r,_-o+r,J,U,Q,"destination-over",X.fontColor,X.textAlign,{fontSize:X.fontSize,fontFamily:X.fontFamily,fontWeight:X.fontWeight,fontItalic:X.fontItalic},X.textBaseline,X.strikethrough,X.underline),this.layer.drawFillRect(O-t+r,_-o+r,U,Q,X.bgColor?X.bgColor:a,"destination-over",1));if(this.secondClickCell){var ee=b?w.col>y.col?y.col:w.col:this.secondClickCell.col>this.clickCell.col?this.clickCell.col:this.secondClickCell.col,te=b?w.row>y.row?y.row:w.row:this.secondClickCell.row>this.clickCell.row?this.clickCell.row:this.secondClickCell.row,oe=b?w.col>y.col?w.col:y.col:this.secondClickCell.col>this.clickCell.col?this.secondClickCell.col:this.clickCell.col,ne=b?w.row>y.row?w.row:y.row:this.secondClickCell.row>this.clickCell.row?this.secondClickCell.row:this.clickCell.row;V>=ee&&V<=oe&&F>=te&&F<=ne&&(this.layer.drawFillRect(O+r-t,_-o+r,U,Q,d,"destination-over"),X.col===this.clickCell.col&&X.row===this.clickCell.row||this.mergeSelectedCell.push(X),this.moreSelectedCell.push(X))}this.isRowSelect&&this.isColSelect&&this.layer.drawFillRect(O-t+r,_-o+r,U,Q,d,"destination-over")}}},{key:"searchScreenAddr",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.contentGroup,n=0,l=0,i=0,r=0,s=0;s<o.length;s++){var a=o[s];if(l=(n=a.x)+a.width,r=(i=a.y)+a.height,n<=e&&e<=l&&i<=t&&t<=r)return a}return o[o.length-1]}},{key:"countMergeWidthAndHeight",value:function(e){var t=e.width,o=e.height;return e.mergeLabelGroup.forEach((function(n){e.row===n.row&&(t+=n.width),e.col===n.col&&(o+=n.height)})),{mergeWidth:t,mergeHeight:o}}},{key:"searchRectIsMerge",value:function(e,t,o,n,l,i){var r=this.contentGroup.filter((function(r){return r.x>=e&&r.x<=o&&r.y>=t&&r.y<=n&&r.isMerge&&([l.row,i.row].includes(r.row)||[l.col,i.col].includes(r.col))}));return r.length>0?r:null}},{key:"searchRectByLabel",value:function(e){var t=this.contentGroup,o=t.findIndex((function(t){return t.label===e}));return-1!==o?t[o]:null}},{key:"searchRectByColAndRow",value:function(e,t){var o=this.contentGroup,n=o.findIndex((function(o){return o.col===e&&o.row===t}));return-1!==n?o[n]:null}},{key:"searchRectIndexByColAndRow",value:function(e,t){return this.contentGroup.findIndex((function(o){return o.col===e&&o.row===t}))}},{key:"changeRectTextByLabel",value:function(e){var t=this.searchRectByLabel(e.label);t&&(t.text=e.text)}},{key:"changeRectAttrByLabel",value:function(e,t){var o=this.searchRectByLabel(e.label);o&&(o[t]=e[t])}},{key:"searchRectArrByCol",value:function(e){return this.contentGroup.filter((function(t){return t.col===e}))}},{key:"searchRectArrByRow",value:function(e){return this.contentGroup.filter((function(t){return t.row===e}))}},{key:"isHasMergerInRectArrByCol",value:function(e){return this.searchRectArrByCol(e).some((function(e){return e.isMerge}))}},{key:"isHasMergerInRectArrByRow",value:function(e){return this.searchRectArrByRow(e).some((function(e){return e.isMerge}))}},{key:"initContentGroupRowAndColByCol",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.contentGroup,l=this.options.cellHeight;o?this.core.col+=t:this.core.col-=t;for(var i=this.core.col,r=1,s=0,a=0,c=n.length;a<c;a++){var h=n[a];if((a+1)%i==1&&(r=1,s=0),h.col>=e&&(h.col=r,h.x=s,h.ltX=s+l,h.col>=27?h.label=String.fromCharCode(65+h.col-27)+String.fromCharCode(65+h.col-27)+h.row:h.label=String.fromCharCode(65+h.col-1)+h.row,h.isMerge)){for(var d=0,u=0,g=h.mergeStartLabel.replace(/[0-9]/,""),p=h.mergeEndLabel.replace(/[0-9]/,""),m=h.mergeStartLabel.replace(/[A-Z]/,""),f=h.mergeEndLabel.replace(/[A-Z]/,""),C=0;C<g.length;C++)d+=h.mergeStartLabel.charCodeAt(C)-65+t;for(var v=0;v<p.length;v++)u+=h.mergeEndLabel.charCodeAt(v)-65+t;d>=27?(h.mergeStartLabel=String.fromCharCode(65+d-26)+String.fromCharCode(65+d-26)+m,h.mergeEndLabel=String.fromCharCode(65+u-26)+String.fromCharCode(65+u-26)+f):(h.mergeStartLabel=String.fromCharCode(65+d)+m,h.mergeEndLabel=String.fromCharCode(65+u)+f)}r+=1,s+=h.width}}},{key:"initContentGroupRowAndColByRow",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.contentGroup,l=this.options.cellHeight;o?this.core.row+=t:this.core.row-=t;for(var i=this.core.col,r=0,s=0,a=0,c=0,h=n.length;c<h;c++){var d=n[c];if((c+1)%i==1&&((r+=1)>1&&(s+=d.height),a=0),d.row>=e&&(d.row=r,d.y=s,d.ltY=s+l,d.x=a,d.ltX=a+l,"insert"===d.label?d.col>=27?d.label=String.fromCharCode(65+d.col-27)+String.fromCharCode(65+d.col-27)+d.row:d.label=String.fromCharCode(65+d.col-1)+d.row:d.label=d.label.replace(/[0-9]/,r),d.isMerge)){var u=d.mergeStartLabel.replace(/[0-9]/,""),g=d.mergeEndLabel.replace(/[0-9]/,""),p=parseInt(d.mergeStartLabel.replace(/[A-Z]/,"")),m=parseInt(d.mergeEndLabel.replace(/[A-Z]/,""));d.mergeStartLabel=u+(p+t),d.mergeEndLabel=g+(m+t)}a+=d.width}}}]),e}(),D=function(){function e(t,n){var l=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"clientHorX",0),i(this,"clientVerY",0),i(this,"recordDeltaY",0),i(this,"barTopDis",0),i(this,"barLeftDis",0),i(this,"wheelStep",10),i(this,"selectorDom",null),i(this,"barVerContainerDom",null),i(this,"barHorContainerDom",null),i(this,"layer",null),i(this,"options",{}),i(this,"components",[]),i(this,"barHeight",10),i(this,"contentComponent",null),i(this,"headerComponent",null),i(this,"sideComponent",null),i(this,"horBarDom",null),i(this,"verBarDom",null),i(this,"core",null),i(this,"leftDis",0),i(this,"topDis",0),i(this,"offsetX",0),i(this,"offsetY",0),this.selectorDom=t,this.canvasWrapperDom=a.canvasWrapperDom,this.layer=n,this.core=a,this.options=r,this.components=s,this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.wholeComponent=s.WholeComponent,this.registryHorScroll(),this.registryVerScroll(),document.onmouseup=function(){document.onmousemove=null,l.horBarDom.style.backgroundColor="rgb(201, 201, 201)",l.verBarDom.style.backgroundColor="rgb(201, 201, 201)",l.core.canvasDom.onmousemove=null,l.core.dragSign=!1,l.core.lockDrag=!1}}return l(e,[{key:"contentMoveX",value:function(){this.headerComponent.trendsDraw(this.offsetX),this.contentComponent.trendsDraw(this.offsetX,this.offsetY)}},{key:"contentMoveY",value:function(){this.sideComponent.trendsDraw(this.offsetY),this.contentComponent.trendsDraw(this.offsetX,this.offsetY)}},{key:"registryWheel",value:function(e){var t=this;this.canvasWrapperDom.onmouseover=function(){t.canvasWrapperDom.onwheel=function(e){e.preventDefault(),t.recordDeltaY=Math.abs(t.barTopDis),t.recordDeltaY+=e.deltaY>0?t.wheelStep:-t.wheelStep,requestAnimationFrame((function(){var e=t.recordDeltaY;t.verMoveFunc(e)}))}}}},{key:"unRegistryHorScroll",value:function(){this.barHorContainerDom.remove(),this.horBarDom.remove()}},{key:"changeHorBarWidth",value:function(){var e=(this.options.width-this.options.cellHeight-10)/this.core.sheetWidth;this.horBarDom.style.width=(this.options.width-this.options.cellHeight-10)*e+"px"}},{key:"changeVerBarHeight",value:function(){var e=(this.options.height-this.options.cellHeight-10)/this.core.sheetHeight;this.verBarDom.style.height=(this.options.height-this.options.cellHeight-10)*e+"px"}},{key:"registryHorScroll",value:function(){var e=this,t=document.createElement("div");t.style.height=this.barHeight+"px",t.style.width=this.options.width-this.options.cellHeight-10+"px",t.style.left=this.options.cellHeight+"px",t.style.bottom=0,t.style.position="absolute",this.canvasWrapperDom.appendChild(t),this.barHorContainerDom=t;var o=document.createElement("div");this.horBarDom=o;var n=this.core.sheetWidth>this.options.width?(this.options.width-this.options.cellHeight-10)/this.core.sheetWidth:1;o.style.width=(this.options.width-this.options.cellHeight-10)*n+"px",o.style.height=this.barHeight+"px",o.style.transformOrigin="left",o.style.userSelect="none",o.style.borderRadius=this.barHeight+"px",o.style.backgroundColor="rgb(201, 201, 201)",o.style.transform="translateX(".concat(this.barLeftDis+"px",")"),t.appendChild(o),o.onmouseover=function(e){o.style.backgroundColor="rgb(150, 150, 150)"},o.onmouseleave=function(e){o.style.backgroundColor="rgb(201, 201, 201)"},o.onmousedown=function(t){t.preventDefault(),document.onmousemove=function(n){o.style.backgroundColor="rgb(150, 150, 150)",e.layer.setCursorDefault(),requestAnimationFrame((function(){var o=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,l=n.pageX-o-(e.canvasWrapperDom.getBoundingClientRect().x+e.options.cellHeight)-t.offsetX;e.horMoveFunc(l)}))}}}},{key:"registryVerScroll",value:function(){var e=this,t=document.createElement("div");t.style.height=this.options.height-this.options.cellHeight-10+"px",t.style.width=this.barHeight+"px",t.style.right=0,t.style.top=this.options.cellHeight+"px",t.style.position="absolute",this.canvasWrapperDom.appendChild(t),this.barVerContainerDom=t;var o=document.createElement("div");this.verBarDom=o;var n=this.core.sheetHeight>this.options.height?(this.options.height-this.options.cellHeight-10)/this.core.sheetHeight:1;o.style.width=this.barHeight+"px",o.style.height=(this.options.height-this.options.cellHeight-10)*n+"px",o.style.transformOrigin="top",o.style.userSelect="none",o.style.backgroundColor="rgb(201, 201, 201)",o.style.borderRadius=this.barHeight+"px",o.onmouseover=function(e){o.style.backgroundColor="rgb(150, 150, 150)"},o.onmouseleave=function(e){o.style.backgroundColor="rgb(201, 201, 201)"},t.appendChild(o),this.registryWheel(o),o.onmousedown=function(t){t.preventDefault(),document.onmousemove=function(n){o.style.backgroundColor="rgb(150, 150, 150)",e.layer.setCursorDefault(),requestAnimationFrame((function(){var o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,l=n.pageY-o-(e.canvasWrapperDom.getBoundingClientRect().y+e.options.cellHeight)-t.offsetY;e.verMoveFunc(l)}))}}}},{key:"horMoveFunc",value:function(e){this.core.plugins.InputPlugin.hideInput();var t=this.core.sheetWidth>this.options.width?(this.options.width-this.options.cellHeight-10)/this.core.sheetWidth:1,o=1===t?0:this.options.width-this.options.cellHeight-10-(this.options.width-this.options.cellHeight)*t;e<=0?(this.horBarDom.style.transform="translateX(0px)",this.barLeftDis=0,this.leftDis=0,this.core.isScrollRightBound=!1):e>=o?(this.horBarDom.style.transform="translateX(".concat(o+"px",")"),this.barLeftDis=o,this.leftDis=-(this.core.sheetWidth-(this.options.width-this.options.cellHeight)),this.core.isScrollRightBound=!0):(this.horBarDom.style.transform="translateX(".concat(e+"px",")"),this.barLeftDis=Math.abs(e),this.leftDis=-e/t,this.core.offsetXLock=!1,this.core.isScrollRightBound=!1),this.core.offsetXLock||(1!==t&&(this.offsetX=Math.abs(this.leftDis),this.contentMoveX()),(e<=0||e>=o)&&(this.core.offsetXLock=!0))}},{key:"verMoveFunc",value:function(e){this.core.plugins.InputPlugin.hideInput();var t=this.core.sheetHeight>this.options.height?(this.options.height-this.options.cellHeight-10)/this.core.sheetHeight:1,o=1===t?0:this.options.height-this.options.cellHeight-10-(this.options.height-this.options.cellHeight)*t;e<=0?(this.verBarDom.style.transform="translateY(0px)",this.barTopDis=0,this.topDis=0,this.core.isScrollBottomBound=!1):e>=o?(this.verBarDom.style.transform="translateY(".concat(o+"px",")"),this.barTopDis=o,this.topDis=-(this.core.sheetHeight-(this.options.height-this.options.cellHeight)),this.core.isScrollBottomBound=!0):(this.verBarDom.style.transform="translateY(".concat(e+"px",")"),this.barTopDis=e,this.topDis=-e/t,this.core.offsetYLock=!1,this.core.isScrollBottomBound=!1),this.core.offsetYLock||(1!==t&&(this.offsetY=Math.abs(this.topDis),this.contentMoveY()),(e<=0||e>=o)&&(this.core.offsetYLock=!0))}}]),e}(),M=function(){function e(t,n){var l=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"options",{}),i(this,"core",null),i(this,"selectorDom",null),i(this,"contentComponent",null),i(this,"headerComponent",null),i(this,"sideBorderLine",null),i(this,"dblClickContext",null),i(this,"clickContext",null),i(this,"inputDom",null),i(this,"rectContext",null),i(this,"headerBorderLine",null),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.wholeComponent=s.WholeComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.canvasWrapperDom=a.canvasWrapperDom,this.options=r,this.layer=n,this.core=a,this.appendInput(),a.plugins.ScrollPlugin.horBarDom.addEventListener("mousedown",(function(){l.inputDom.style.display="none"})),a.plugins.ScrollPlugin.verBarDom.addEventListener("mousedown",(function(){l.inputDom.style.display="none"}))}return l(e,[{key:"hideInput",value:function(){this.inputDom.style.display="none",this.inputDom.value="",this.inputDom.oninput=null}},{key:"setCellText",value:function(){this.contentComponent.clickCell.text=this.inputDom.value}},{key:"showInput",value:function(e){var t=this,o=this.inputDom,n=this.core.plugins.ScrollPlugin,l=n.offsetX,i=n.offsetY,r=this.options.cellHeight,s=e.x,a=e.y,c=e.width,h=e.height,d=e.text,u=e.isMerge,g=e.mergeWidth,p=e.mergeHeight,m=e.bgColor,f=e.fontColor,C=d.length*this.core.fontSize,v=u?g:c;o.style.opacity=1,o.style.top=a+r-i+"px",o.style.left=s+r-l+"px",o.style.display="inline-block",o.style.textAlign="center",o.style.width=(v>C?v:C)+"px",o.style.height=(u?p:h)+"px",o.style.borderRadius="6px",o.style.backgroundColor=null!=m?m:"",o.style.color=null!=f?f:"",o.value=d,o.oninput=function(e){t.core.plugins.SettingPlugin.setCellCon(e.target.value)},this.contentComponent.hideCellPainterDom()}},{key:"appendInput",value:function(){var e=this,t=document.createElement("input");this.inputDom=t,t.style.display="none",t.style.position="absolute",t.style.outline="none",t.style.border="2px solid "+this.core.selectedBorderBgColor,t.style.boxSizing="border-box",this.canvasWrapperDom.appendChild(t),this.canvasDom.addEventListener("dblclick",(function(o){e.contentComponent.hideSelectedCellDom();var n=e.options.cellHeight;if(!(o.offsetX<=n||o.offsetY<=n)){e.core.plugins.SelectPlugin.clearCopyDash();var l=e.core.plugins.ScrollPlugin,i=l.offsetX,r=l.offsetY,s=e.contentComponent.clickCell,a=s.x,c=s.y,h=s.width,d=s.height,u=s.text,g=s.isMerge,p=s.mergeWidth,m=s.mergeHeight,f=s.bgColor,C=s.fontColor;e.core.fresh();var v=g?p:h,y=u.length*e.core.fontSize;t.style.opacity=1,t.style.top=c+n-r+"px",t.style.left=a+n-i+"px",t.style.display="inline-block",t.style.textAlign="center",t.style.width=(v>y?v:y)+"px",t.style.height=(g?m:d)+"px",t.style.borderRadius="6px",t.style.backgroundColor=null!=f?f:"",t.style.color=null!=C?C:"",t.value=u,t.focus(),t.onblur=function(o){t.value?(o.relatedTarget&&e.selectorDom.contains(o.relatedTarget)||e.core.plugins.SettingPlugin.changeStepArr({type:1,label:s.label,pre:s.text,next:t.value}),s.text=t.value,e.core.ws.wsSend(1,s),e.inputDom.value="",e.core.fresh(),e.hideInput()):e.hideInput()},t.oninput=function(t){e.core.plugins.SettingPlugin.setCellCon(t.target.value)},e.contentComponent.hideCellPainterDom()}}))}}]),e}(),I=function(){function e(t,n){var l=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"options",{}),i(this,"core",null),i(this,"selectorDom",null),i(this,"contentComponent",null),i(this,"headerComponent",null),i(this,"sideBorderLine",null),i(this,"clickContext",null),i(this,"inputDom",null),i(this,"copyKey",["text","mergeWidth","mergeHeight","mergeRow","mergeCol","isMerge","bgColor","fontColor"]),i(this,"moreShiftSelectClick",(function(e){if(l.core.shiftKey){var t=l.options.cellHeight,o=l.core.plugins.ScrollPlugin,n=o.offsetX,i=o.offsetY,r=l.contentComponent.clickCell,s=l.searchRectAddr(e.offsetX+n-t,e.offsetY+i-t);if(s.isMerge){var a=s.x>r.x,c=s.y>r.y;a&&!c?s=l.searchRectByColAndRow(s.col+s.mergeCol-1,s.row):a&&c?s=l.searchRectByColAndRow(s.col+s.mergeCol-1,s.row+s.mergeRow-1):!a&&c&&(s=l.searchRectByColAndRow(s.col,s.row+s.mergeRow-1))}l.contentComponent.setSecondClickCell(s),l.core.fresh()}})),i(this,"moreCtrlSelectClick",(function(e){if(l.core.shiftKey){var t=l.options.cellHeight,o=l.core.plugins.ScrollPlugin,n=o.offsetX,i=o.offsetY,r=l.searchRectAddr(e.offsetX+n-t,e.offsetY+i-t);l.contentComponent.setSecondClickCell(r),l.core.fresh()}})),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.settingPlugin=a.plugins.SettingPlugin,this.options=r,this.layer=n,this.core=a,this.showClickHandler(),this.moreSelect(),this.displayColTextRegister()}return l(e,[{key:"searchRectIsMergeInTwoCell",value:function(e,t){var o=this.contentComponent.contentGroup;return null===t?e.isMerge:o.filter((function(o){return o.col>=e.col&&o.row>=e.row&&o.col<=t.col&&o.row<=t.row})).some((function(e){return e.isMerge}))}},{key:"displayAllTextByCol",value:function(e,t){var o=this,n=this.options.cellHeight,l=this.contentComponent.contentGroup.filter((function(t){return t.col===e})).map((function(e){return o.layer.ctx.measureText(e.text).width+n}));l.push(t);var i=l.sort((function(e,t){return e-t}))[l.length-1];this.core.plugins.DragPlugin.expandWidthNoDrag(e,i-t)}},{key:"displayColTextRegister",value:function(){var e=this;this.canvasDom.addEventListener("dblclick",(function(t){var o=e.options.cellHeight,n=e.core.plugins.ScrollPlugin,l=n.offsetX;n.offsetY;var i=t.offsetX+l;if(t.offsetY<=o){for(var r=null,s=e.headerComponent.headerRectGroup,a=0;a<s.length;a++){var c=s[a];if(i>c.ltX&&i<c.ltX+c.width){r=c;break}}e.displayAllTextByCol(r.col,r.width)}}))}},{key:"copyText",value:function(e){navigator.clipboard&&navigator.clipboard.writeText(e)}},{key:"searchMergeArr",value:function(e,t,o,n){var l=[];return this.contentComponent.contentGroup.forEach((function(i){i.col>=e&&i.col<=o&&i.row>=t&&i.row<=n&&l.push(i)})),l.splice(1,l.length)}},{key:"copyRect",value:function(e,t){var o=e.width,n=e.height,l=this.searchMergeArr(e.col,e.row,e.col+t.mergeCol-1,e.row+t.mergeRow-1);e.mergeEndLabel=l[l.length-1].label,e.mergeStartLabel=e.label,e.isMerge=!0,l.forEach((function(t){t.isMerge=!0,t.mergeStartLabel=e.label,t.mergeEndLabel=l[l.length-1].label,e.row===t.row&&e.label!==t.label&&(o+=t.width),e.col===t.col&&e.label!==t.label&&(n+=t.height)})),e.mergeWidth=o,e.mergeHeight=n}},{key:"setCellAttr",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["row","col","x","y","ltX","ltY","mergeStartLabel","mergeEndLabel","label","isFromExcel","width","height"];for(var n in t)o.includes(n)||(e[n]=t[n]);t.isMerge&&(e.mergeStartLabel=String.fromCharCode(65+e.col-1)+e.row,e.mergeEndLabel=String.fromCharCode(65+e.col+e.mergeCol-2)+(e.row+e.mergeRow-1))}},{key:"copyCellAttr",value:function(e,t){for(var o in t)e[o]=t[o]}},{key:"tableDomToArr",value:function(e){for(var t=[],o=e.querySelectorAll("tr"),n=0;n<o.length;n++){t[n]=[];for(var l=o[n].querySelectorAll("td"),i=0;i<l.length;i++)t[n].push(l[i])}return t}},{key:"transformTableDomStrToDom",value:function(e){var t=this.core.h,o=(new DOMParser).parseFromString(e,"text/html");!o.querySelector("style")||o.querySelector("style").sheet.cssRules;var n=o.querySelector("table");if(!n)return null;for(var l=this.tableDomToArr(n),i=t("td"),r=function(e){for(var t=l[e],o=function(o){var n=t[o];if(n||l[e].push(i.cloneNode()),n.rowSpan>1)for(var r=1,s=n.rowSpan;r<s;r++)l[e+r].splice(o,0,i.cloneNode());n.colSpan>1&&new Array(n.colSpan-1).fill(0).forEach((function(t){l[e].splice(o+1,0,i.cloneNode())}))},n=0;n<t.length;n++)o(n)},s=0;s<l.length;s++)r(s);return l}},{key:"transformTableDomStrToCanvasCell",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.core.h,l=(new DOMParser).parseFromString(e,"text/html"),i=l.querySelector("style")?l.querySelector("style").sheet.cssRules:[],r=l.querySelector("table");if(r){for(var s=r.querySelectorAll("tr"),a=this.tableDomToArr(r),c=n("td"),h=function(e){for(var t=a[e],o=function(o){var n=t[o];if(n||a[e].push(c.cloneNode()),n.rowSpan>1)for(var l=1,i=n.rowSpan;l<i;l++)a[e+l].splice(o,0,c.cloneNode());n.colSpan>1&&new Array(n.colSpan-1).fill(0).forEach((function(t){a[e].splice(o+1,0,c.cloneNode())}))},n=0;n<t.length;n++)o(n)},d=0;d<a.length;d++)h(d);a.length;for(var u=0;u<a.length;u++)for(var g=a[u],p=0;p<g.length;p++){var m=g[p],f={};if(g[p].getAttribute("data-json"))f=JSON.parse(g[p].getAttribute("data-json"));else{for(var C,v,y="",w="",b=null,S="",k=0,x=i.length;k<x;k++)m.className===i[k].selectorText.replace(".","")&&(y=""!==i[k].style.backgroundColor?i[k].style.backgroundColor:null,w=""!==i[k].style.color?i[k].style.color:null,""===i[k].style.textAlign||i[k].style.textAlign,b=""!==i[k].style.fontSize?i[k].style.fontSize.replace("pt",""):12,S=""!==i[k].style.fontFamily?i[k].style.fontFamily:null);v=b+" "+S,f={mergeRow:m.rowSpan>1?m.rowSpan:m.colSpan>1?1:0,mergeCol:m.colSpan>1?m.colSpan:m.rowSpan>1?1:0,isMerge:m.colSpan&&m.colSpan>1||m.rowSpan&&m.rowSpan>1,text:m.innerText,isFromExcel:!0,bgColor:y,fontColor:w,font:v,fontSize:null!==(C=b)&&void 0!==C?C:12,fontFamily:S}}var D=this.searchRectByColAndRow(t.col+p,t.row+u);if(u===s.length-1&&g.length,f.isMerge)for(var M=D.row+f.mergeRow,I=D.col+f.mergeCol,A=D.row;A<M;A++)for(var B=D.col;B<I;B++)if(A===D.row&&B===D.col)this.setCellAttr(D,f),f.isFromExcel&&(D.mergeWidth=D.width,D.mergeHeight=D.height);else{var L=this.searchRectByColAndRow(B,A);L.isMerge=!0,L.mergeStartLabel=D.mergeStartLabel,L.mergeEndLabel=D.mergeEndLabel,f.isFromExcel&&(L.col===D.col&&(D.mergeHeight+=L.height),L.row===D.row&&(D.mergeWidth+=L.width))}else D.isMerge||this.setCellAttr(D,f)}o&&this.contentComponent.showClickRect(t),this.core.fresh()}}},{key:"transformCanvasCellToTableDomStr",value:function(){var e=this.contentComponent,t=e.clickCell,o=e.secondClickCell,n=e.clickRectShow,l=e.moreSelectedCell,i=this.core.h;if(n){var r=i("table"),s=i("tr"),a=i("td");if(t&&!o)if(t.isMerge)for(var c=t.row+t.mergeRow,h=t.row;h<c;h++){var d=s.cloneNode();if(h===t.row){var u=a.cloneNode();this.setTdAttrs(u,t),d.appendChild(u)}r.appendChild(d)}else{var g=s.cloneNode(),p=a.cloneNode();this.setTdAttrs(p,t),g.appendChild(p),r.appendChild(g)}else if(o)for(var m=0,f=null,C=0;C<l.length;C++){var v=l[C];if(m!==v.row&&(m=v.row,f=s.cloneNode(),r.appendChild(f)),v.isMerge&&v.label===v.mergeStartLabel||!v.isMerge){var y=a.cloneNode();this.setTdAttrs(y,v),f.appendChild(y)}}var w=r.outerHTML;return s.remove(),a.remove(),w}}},{key:"transformCanvasCellToTableDomStrByParams",value:function(e,t,o,n){var l=this.core.h;if(o){var i=l("table"),r=l("tr"),s=l("td");if(e&&!t)if(e.isMerge)for(var a=e.row+e.mergeRow,c=e.row;c<a;c++){var h=r.cloneNode();if(c===e.row){var d=s.cloneNode();this.setTdAttrs(d,e),h.appendChild(d)}i.appendChild(h)}else{var u=r.cloneNode(),g=s.cloneNode();this.setTdAttrs(g,e),u.appendChild(g),i.appendChild(u)}else if(t)for(var p=0,m=null,f=0;f<n.length;f++){var C=n[f];if(p!==C.row&&(p=C.row,m=r.cloneNode(),i.appendChild(m)),C.isMerge&&C.label===C.mergeStartLabel||!C.isMerge){var v=s.cloneNode();this.setTdAttrs(v,C),m.appendChild(v)}}var y=i.outerHTML;return r.remove(),s.remove(),y}}},{key:"searchPastePositionCells",value:function(e,t,o){for(var n=[],l=e+o.col,i=t+o.row,r=o.row;r<=i;r++)for(var s=o.col;s<=l;s++)n.push(this.contentComponent.searchRectByColAndRow(s,r));return n}},{key:"forcePasteCellToNewCell",value:function(e){var t=this;e.forEach((function(e){var o=t.contentComponent.searchRectByLabel(e.label);t.copyCellAttr(o,e)}))}},{key:"forcePasteCellToNewCellByTargetCell",value:function(e,t){var o=this,n=e[0];e.forEach((function(e){var l=o.contentComponent.searchRectByColAndRow(e.col-n.col+t.col,e.row-n.row+t.row);o.copyCellAttr(l,e)}))}},{key:"clearCopyDash",value:function(){this.copyText(""),this.core.copyKey=!1,this.core.copyCellDash=[],this.core.freshContent()}},{key:"moreSelect",value:function(){var e=this;document.addEventListener("paste",(function(t){var o=e.contentComponent,n=o.clickRectShow,l=o.clickCell,i=t.clipboardData.getData("text/html"),r=e.transformTableDomStrToDom(i);if(Array.isArray(r)&&!r[0][0].getAttribute("data-json")){var s,a=r.length,c=r[0].length;return s=JSON.stringify(e.searchPastePositionCells(c-1,a-1,l)),e.core.plugins.SettingPlugin.changeStepArr({type:15,pre:{label:l.label,pasteStr:s},next:{label:l.label,pasteStr:i}}),e.core.ws.wsSend(15,{pasteStr:i,label:l.label}),e.transformTableDomStrToCanvasCell(i,l),void e.contentComponent.setSecondClickCell(null)}if(1===e.core.copyCellDash.length){if(e.searchRectIsMergeInTwoCell(l,null))return void e.settingPlugin.showDialog("","");var h=e.core.copyCellDash[0];if(h.isMerge){var d=e.contentComponent.searchRectByColAndRow(l.col+h.mergeCol-1,l.row+h.mergeRow-1);if(e.searchRectIsMergeInTwoCell(l,d))return void e.settingPlugin.showDialog("","")}}else if(e.core.copyCellDash.length>1){var u=e.core.copyCellDash[0],g=e.core.copyCellDash[e.core.copyCellDash.length-1],p=e.contentComponent.searchRectByColAndRow(l.col+g.col-u.col,l.row+g.row-u.row);if(e.searchRectIsMergeInTwoCell(l,p))return void e.settingPlugin.showDialog("","")}if(n&&e.core.copyCellDash.length>0){var m="",f=e.core.copyCellDash[0],C=e.core.copyCellDash[e.core.copyCellDash.length-1];m=1===e.core.copyCellDash.length?JSON.stringify(e.searchPastePositionCells(f.mergeCol-1,f.mergeRow-1,l)):JSON.stringify(e.searchPastePositionCells(C.col-f.col,C.row-f.row,l)),e.core.plugins.SettingPlugin.changeStepArr({type:15,pre:{label:l.label,pasteStr:m},next:{label:l.label,pasteStr:i}}),e.core.ws.wsSend(15,{pasteStr:i,label:l.label}),e.transformTableDomStrToCanvasCell(i,l),e.contentComponent.setSecondClickCell(null)}})),document.addEventListener("copy",(function(t){t.preventDefault(),e.core.copyCellDash=[];var o=e.transformCanvasCellToTableDomStr();t.clipboardData.setData("text/html",o);var n=e.contentComponent,l=n.clickCell,i=n.moreSelectedCell;if(e.core.copyKey=!0,i.length>0)e.core.copyCellDash=i;else{if(!l)return;e.core.copyCellDash=[l]}e.core.freshContent()})),document.addEventListener("keydown",(function(t){e.core.shiftKey=t.shiftKey,e.core.ctrlKey=t.ctrlKey,t.shiftKey&&t.ctrlKey&&"KeyZ"===t.code||t.ctrlKey&&"z"===t.code||"Escape"===t.code&&e.clearCopyDash()})),document.addEventListener("keyup",(function(t){e.core.shiftKey=t.shiftKey,e.core.ctrlKey=t.ctrlKey})),this.canvasDom.addEventListener("mousedown",this.moreShiftSelectClick)}},{key:"setTdAttrs",value:function(e,t){t.isMerge&&(e.rowSpan=t.mergeRow,e.colSpan=t.mergeCol),e.innerText=t.text,e.style.backgroundColor=t.bgColor,e.style.color=t.fontColor,e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.textAlign=t.textAlign,e.setAttribute("data-json",JSON.stringify(t))}},{key:"showClickHandler",value:function(){var e=this;this.canvasDom.addEventListener("mousedown",(function(t){if(!(2===t.button&&e.contentComponent.secondClickCell||(e.core.plugins.ContextmenuPlugin.hideContextMenu(),e.core.plugins.BookPlugin.hideContextMenu(),e.core.shiftKey||e.core.ctrlKey||e.core.dragSign))){var o=e.options,n=o.cellHeight;o.cellWidth;var l=e.core.plugins.ScrollPlugin,i=l.offsetX,r=l.offsetY;if(l.topDis,l.barVerContainerDom,l.barHorContainerDom,t.offsetY<=n&&t.offsetX<=n)e.contentComponent.setSecondClickCell(null),e.contentComponent.showClickRect({},!0,!0),e.contentComponent.hideSelectedCellDom();else if(t.offsetY<=n&&t.offsetX>n){var s=e.searchHeaderRectAddr(t.offsetX+i-n);s&&(e.contentComponent.setSecondClickCell(null),e.contentComponent.showClickRect(s,!0)),e.contentComponent.hideSelectedCellDom()}else if(t.offsetY>n&&t.offsetX<=n){var a=e.searchSideRectAddr(t.offsetY+r-n);a&&(e.contentComponent.setSecondClickCell(null),e.contentComponent.showClickRect(a,!1,!0)),e.contentComponent.hideSelectedCellDom()}else{var c=e.searchRectAddr(t.offsetX+i-n,t.offsetY+r-n);c&&(e.contentComponent.showClickRect(c),e.core.plugins.SettingPlugin.setCellAttrInHeader(c),e.contentComponent.setSecondClickCell(null),e.canvasDom.onmousemove=function(t){var o,l=e.core.plugins.ScrollPlugin,i=l.offsetX,r=l.offsetY,s=e.searchRectAddr(t.offsetX+i-n,t.offsetY+r-n);if(s&&c.label===s.label)e.contentComponent.setSecondClickCell(null);else if(s&&s.label!==(null===(o=e.contentComponent.secondClickCell)||void 0===o?void 0:o.label)){var a=s.x>c.x,h=s.y>c.y;s.isMerge&&(a&&!h?s=e.searchRectByColAndRow(s.col+s.mergeCol-1,s.row):a&&h?s=e.searchRectByColAndRow(s.col+s.mergeCol-1,s.row+s.mergeRow-1):!a&&h&&(s=e.searchRectByColAndRow(s.col,s.row+s.mergeRow-1))),e.contentComponent.setSecondClickCell(s),e.core.fresh()}})}e.core.fresh()}}))}},{key:"searchRectIsMerge",value:function(e,t,o,n){var l=this.contentComponent.contentGroup.find((function(l){return l.x>=e&&l.x<=o&&l.y>=t&&l.y<=n&&l.isMerge}));return l?{startRect:this.searchRectByLabel(l.mergeStartLabel),endRect:this.searchRectByLabel(l.mergeEndLabel)}:null}},{key:"searchRectByLabel",value:function(e){var t=this.contentComponent.contentGroup,o=t.findIndex((function(t){return t.label===e}));return-1!==o?t[o]:null}},{key:"searchRectByColAndRow",value:function(e,t){var o=this.contentComponent.contentGroup,n=o.findIndex((function(o){return o.col===e&&o.row===t}));return-1!==n?o[n]:null}},{key:"searchRectAddr",value:function(e,t){for(var o,n=this.contentComponent.contentGroup,l=function(){var o=n[i];if(e>=o.x&&e<=o.x+o.width&&t>=o.y&&t<=o.y+o.height){if(o.isMerge){if(o.label===o.mergeStartLabel)return{v:o};var l=n.findIndex((function(e){return e.label===o.mergeStartLabel}));return{v:n[l]}}return{v:o}}},i=0;i<n.length;i++)if(o=l())return o.v}},{key:"searchHeaderRectAddr",value:function(e){for(var t=this.headerComponent.headerRectGroup,o=0;o<t.length;o++){var n=t[o];if(e>=n.x&&e<=n.x+n.width)return n}}},{key:"searchSideRectAddr",value:function(e){for(var t=this.sideComponent.sideRectGroup,o=0;o<t.length;o++){var n=t[o];if(e>=n.y&&e<=n.y+n.height)return n}}}]),e}(),A=function(){function e(t,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"dragShowDis",6),i(this,"dragCell",null),i(this,"stepObj",{}),this.contentComponent=r.ContentComponent,this.headerComponent=r.HeaderComponent,this.sideComponent=r.SideComponent,this.selectorDom=t,this.canvasDom=s.canvasDom,this.options=l,this.layer=n,this.core=s,this.registerDragEvent()}return l(e,[{key:"expandWidthNoDrag",value:function(e,t){for(var o=this.contentComponent.contentGroup,n=0;n<o.length;n++){var l=o[n];if(!(l.col<e)&&(l.col===e?l.width+=t:l.col>e&&(l.x+=t,l.ltX+=t),l.col===e&&1===l.row&&(this.core.sheetWidth+=t),l.isMerge&&l.mergeStartLabel===l.label&&l.col===e&&(l.mergeWidth+=t),l.isMerge&&l.mergeStartLabel!==l.label&&l.col===e)){var i=this.contentComponent.searchRectByLabel(l.mergeStartLabel);i.row===l.row&&(i.mergeWidth+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"expandHeightNoDrag",value:function(e,t){for(var o=this.contentComponent.contentGroup,n=0;n<o.length;n++){var l=o[n];if(l.row===e?l.height+=t:l.row>e&&(l.y+=t,l.ltY+=t),l.row===e&&1===l.col&&(this.core.sheetHeight+=t),l.isMerge&&l.mergeStartLabel===l.label&&l.row===e&&(l.mergeHeight+=t),l.isMerge&&l.mergeStartLabel!==l.label&&l.row===e){var i=this.contentComponent.searchRectByLabel(l.mergeStartLabel);i.col===l.col&&(i.mergeHeight+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"expandWidth",value:function(e,t){var o=this.contentComponent.contentGroup,n=this.options.cellHeight;if(this.layer.setCursor("col-resize"),!this.dragCell||this.dragCell.width+t<n&&t<0)return this.stepObj.next={width:n},void(this.dragCell=null);for(var l=0;l<o.length;l++){var i=o[l];if(!(i.col<e)&&(i.col===e?i.width+=t:i.col>e&&(i.x+=t,i.ltX+=t),i.col===e&&1===i.row&&(this.core.sheetWidth+=t),i.isMerge&&i.mergeStartLabel===i.label&&i.col===e&&(i.mergeWidth+=t),i.isMerge&&i.mergeStartLabel!==i.label&&i.col===e)){var r=this.contentComponent.searchRectByLabel(i.mergeStartLabel);r.row===i.row&&(r.mergeWidth+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"expandHeight",value:function(e,t){var o=this.contentComponent.contentGroup,n=this.options.cellHeight;if(this.layer.setCursor("col-resize"),!this.dragCell||this.dragCell.height+t<n&&t<0)return this.stepObj.next={height:n},void(this.dragCell=null);for(var l=0;l<o.length;l++){var i=o[l];if(i.row===e?i.height+=t:i.row>e&&(i.y+=t,i.ltY+=t),i.row===e&&1===i.col&&(this.core.sheetHeight+=t),i.isMerge&&i.mergeStartLabel===i.label&&i.row===e&&(i.mergeHeight+=t),i.isMerge&&i.mergeStartLabel!==i.label&&i.row===e){var r=this.contentComponent.searchRectByLabel(i.mergeStartLabel);r.col===i.col&&(r.mergeHeight+=t)}}this.core.freshScrollBar(),this.core.fresh()}},{key:"registerDragEvent",value:function(){var e=this;this.canvasDom.addEventListener("mouseup",(function(o){if(e.core.lockDrag=!1,e.dragCell){e.stepObj.next={width:e.dragCell.width,height:e.dragCell.height};var n=0;11===e.stepObj.type&&(n=e.stepObj.next.width-e.stepObj.pre.width),12===e.stepObj.type&&(n=e.stepObj.next.height-e.stepObj.pre.height),e.core.plugins.SettingPlugin.changeStepArr(JSON.parse(JSON.stringify(e.stepObj))),e.core.ws.wsSend(e.stepObj.type,t({dis:n},e.stepObj))}})),this.canvasDom.addEventListener("mousedown",(function(t){if(e.core.lockDrag=!0,e.dragCell&&e.core.dragSign){e.stepObj.pre={},e.stepObj.label=e.dragCell.label,e.stepObj.pre.width=e.dragCell.width,e.stepObj.pre.height=e.dragCell.height;var o=0,n=t.pageX,l=0,i=t.pageY;e.canvasDom.onmousemove=function(t){if(!e.dragCell)return!1;e.core.dragSignDirectionIsHor?(o=t.pageX,e.stepObj.type=11,e.expandWidth(e.dragCell.col,o-n),n=o):(l=t.pageY,e.stepObj.type=12,e.expandHeight(e.dragCell.row,l-i),i=l)}}})),this.canvasDom.addEventListener("mousemove",(function(t){if(e.core.lockDrag)return!1;var o=e.headerComponent.headerRectGroup,n=e.sideComponent.sideRectGroup,l=e.core.plugins.ScrollPlugin,i=l.offsetX,r=l.offsetY,s=e.options.cellHeight,a=e.dragShowDis,c=t.offsetX+i,h=t.offsetY+r;if(e.dragCell&&(c<e.dragCell.ltX+e.dragCell.width-a||c>e.dragCell.ltX+e.dragCell.width+a+1)&&(e.core.dragSign=!1,e.dragCell=null),e.dragCell&&(h<e.dragCell.ltY+e.dragCell.height-a||c>e.dragCell.ltY+e.dragCell.height+a+1)&&(e.core.dragSign=!1,e.dragCell=null),!e.core.lockDrag){if(t.offsetY<=s){t.offsetX>s&&e.layer.setCursor("s-resize");for(var d=0;d<o.length;d++){var u=o[d];c>u.ltX+u.width-a&&c<u.ltX+u.width+a+1&&(e.core.dragSign||(e.dragCell=u),e.layer.setCursor("col-resize"),e.core.dragSign=!0,e.core.dragSignDirectionIsHor=!0)}}if(t.offsetX<=s){t.offsetY>s&&e.layer.setCursor("e-resize");for(var g=0;g<n.length;g++){var p=n[g];h>p.ltY+p.height-a&&h<p.ltY+p.height+a+1&&(e.core.dragSign||(e.dragCell=p),e.layer.setCursor("row-resize"),e.core.dragSign=!0,e.core.dragSignDirectionIsHor=!1)}}}}))}}]),e}(),B=function(){function e(t,n){var l=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"containerDom",null),i(this,"hideContextMenu",(function(){l.containerDom.style.display="none"})),i(this,"insertRow",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var n=l.core.col,i=l.options,r=i.cellWidth,s=i.cellHeight,a=l.contentComponent.contentGroup;l.core.sheetHeight+=t*s;for(var c=l.contentComponent.searchRectIndexByColAndRow(1,o?e:e+1),h=function(){var t=a[c];new Array(n).fill(void 0).forEach((function(o,l){a.splice(c,0,{row:e,col:n-l,text:"",width:r,height:s,x:t.x,y:t.y,ltX:t.ltX,ltY:t.ltY,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:null,fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",label:"insert"})}))},d=1;d<=t;d++)h();l.contentComponent.initContentGroupRowAndColByRow(e,t),l.core.fresh(),l.core.plugins.ScrollPlugin.changeVerBarHeight()}})),i(this,"insertCol",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var n=l.core.row,i=l.options,r=i.cellWidth,s=i.cellHeight,a=l.contentComponent.contentGroup;l.core.sheetWidth+=t*r;for(var c=function(n){var i=l.contentComponent.searchRectIndexByColAndRow(e,n),c=a[i];new Array(t).fill(void 0).forEach((function(t){a.splice(o?i:i+1,0,{row:n,col:e,text:"",width:r,height:s,x:c.x,y:c.y,ltX:c.ltX,ltY:c.ltY,mergeWidth:0,mergeHeight:0,mergeRow:1,mergeCol:1,mergeStartLabel:"",mergeEndLabel:"",mergeLabelGroup:[],isMerge:!1,bgColor:null,fontColor:"#000000",font:null,fontSize:12,fontWeight:"",fontItalic:"",fontFamily:"Calibre",textAlign:"center",textBaseline:"middle",label:"insert"})}))},h=1;h<=n;h++)c(h);l.contentComponent.initContentGroupRowAndColByCol(e,t),l.core.fresh(),l.core.plugins.ScrollPlugin.changeHorBarWidth()}})),i(this,"removeCol",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var n=l.core.row,i=l.options,r=i.cellWidth;i.cellHeight;var s=l.contentComponent.contentGroup;l.core.sheetWidth-=t*r;for(var a=1;a<=n;a++)for(var c=0;c<t;c++){var h=l.contentComponent.searchRectIndexByColAndRow(o?e+c:e+1+c,a);s.splice(h,1)}l.contentComponent.initContentGroupRowAndColByCol(e,t,!1),l.core.fresh(),l.core.plugins.ScrollPlugin.changeHorBarWidth()}})),i(this,"removeRow",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var n=l.core.col,i=l.options;i.cellWidth;var r=i.cellHeight,s=l.contentComponent.contentGroup;l.core.sheetHeight-=t*r;for(var a=l.contentComponent.searchRectIndexByColAndRow(1,o?e:e+1),c=1;c<=t;c++)s.splice(a,n);l.contentComponent.initContentGroupRowAndColByRow(e,t,!1),l.core.fresh(),l.core.plugins.ScrollPlugin.changeVerBarHeight()}})),i(this,"splitCell",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.isMerge)return l.settingPlugin.showDialog("",""),!1;e.mergeEndLabel="",e.mergeStartLabel="",e.isMerge=!1;for(var o=e.row,n=e.row+e.mergeRow;o<n;o++)for(var i=e.col,r=e.col+e.mergeCol;i<r;i++)if(o===e.row&&i===e.col);else{var s=l.contentComponent.searchRectByColAndRow(i,o);s.mergeEndLabel="",s.mergeStartLabel="",s.isMerge=!1}return e.mergeRow=1,e.mergeCol=1,t&&l.contentComponent.showClickRect(e),l.core.fresh(),l.hideContextMenu(),!0})),i(this,"mergeCell",(function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(1===t.length&&t[0].label===e.label)return l.settingPlugin.showDialog("",""),!1;if(t.some((function(e){return e.isMerge}))||0===t.length)return l.settingPlugin.showDialog("",""),!1;var n=e.width,i=e.height;return e.mergeEndLabel=t[t.length-1].label,e.mergeStartLabel=e.label,e.isMerge=!0,e.mergeRow=1,e.mergeCol=1,t.forEach((function(o){o.isMerge=!0,o.mergeStartLabel=e.label,o.mergeEndLabel=t[t.length-1].label,e.row===o.row&&e.label!==o.label&&(n+=o.width,e.mergeCol+=1),e.col===o.col&&e.label!==o.label&&(i+=o.height,e.mergeRow+=1)})),e.mergeWidth=n,e.mergeHeight=i,l.contentComponent.setSecondClickCell(null),o&&l.contentComponent.showClickRect(e),l.core.freshContent(),l.hideContextMenu(),!0})),i(this,"eventInsertCol",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=l.contentComponent.clickCell;l.contentComponent.isHasMergerInRectArrByCol(o.col)||(l.core.plugins.SettingPlugin.changeStepArr({type:13,pre:{col:o.col,num:e,isLeft:t},next:{col:o.col,num:e,isLeft:t}}),l.core.ws.wsSend(13,{col:o.col,num:e,isLeft:t}),l.insertCol(o.col,e,t)),l.hideContextMenu()})),i(this,"eventInsertRow",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=l.contentComponent.clickCell;l.contentComponent.isHasMergerInRectArrByRow(o.row)||(l.core.plugins.SettingPlugin.changeStepArr({type:14,pre:{row:o.row,num:e,isTop:t},next:{row:o.row,num:e,isTop:t}}),l.core.ws.wsSend(14,{row:o.row,num:e,isTop:t}),l.insertRow(o.row,e,t)),l.hideContextMenu()})),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.canvasWrapperDom=a.canvasWrapperDom,this.settingPlugin=a.plugins.SettingPlugin,this.options=r,this.layer=n,this.core=a,this.registryContextMenu()}return l(e,[{key:"registryContextMenu",value:function(){var e=this,t=this.core.h,o=t("div",{style:{display:"none"},attr:{className:"e-sheet-contextmenu-layout"}}),n=t("div",{style:{cursor:"pointer"},attr:{innerText:"",className:"item-btn"}}),l=t("div",{style:{cursor:"pointer"},attr:{innerText:"",className:"item-btn"}}),i=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"",onclick:function(t){e.eventInsertCol(t.target.nextElementSibling.valueAsNumber)}}}),t("input",{attr:{type:"number",placeholder:"",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.eventInsertCol(t.target.valueAsNumber),t.target.value=1)}}}),t("span",{attr:{innerText:""}})]),r=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"",onclick:function(t){e.eventInsertCol(t.target.nextElementSibling.valueAsNumber,!1)}}}),t("input",{attr:{type:"number",placeholder:"",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.eventInsertCol(t.target.valueAsNumber,!1),t.target.value=1)}}}),t("span",{attr:{innerText:""}})]),s=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"",onclick:function(t){e.eventInsertRow(t.target.nextElementSibling.valueAsNumber)}}}),t("input",{attr:{type:"number",placeholder:"",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.eventInsertRow(t.target.valueAsNumber),t.target.value=1)}}}),t("span",{attr:{innerText:""}})]),a=t("div",{attr:{className:"item-input-btn item-top-border"}},[t("span",{attr:{innerText:"",onclick:function(t){e.eventInsertRow(t.target.nextElementSibling.valueAsNumber,!1)}}}),t("input",{attr:{type:"number",placeholder:"",className:"input-con",value:1,onkeydown:function(t){"Enter"===t.key&&(e.contentComponent.clickCell,e.eventInsertRow(t.target.valueAsNumber,!1),t.target.value=1)}}}),t("span",{attr:{innerText:""}})]);this.containerDom=o,this.canvasDom.addEventListener("contextmenu",(function(t){t.preventDefault();var i=e.contentComponent.clickCell,r=e.options.cellHeight,s=e.core.plugins.ScrollPlugin;s.offsetX,s.offsetY,t.offsetX<=r||t.offsetY<=r||i&&(o.style.display="block",o.style.left=t.offsetX+"px",o.style.top=t.offsetY+"px",i.isMerge?(n.style.display="none",l.style.display="flex"):(l.style.display="none",n.style.display="flex"))})),n.onclick=function(t){var o=e.contentComponent,n=o.clickCell,l=o.mergeSelectedCell,i={type:9,label:n.label},r=[n].concat(p(l)).sort((function(e,t){return e.row-t.row+(e.col-t.col)}));i.pre=r[0].label,i.next=r.map((function(e){return e.label})),e.core.plugins.SettingPlugin.changeStepArr(i),e.core.plugins.SettingPlugin.wsSendInfoByTypeAndData(9,i.next),e.mergeCell(r[0],r.slice(0))},l.onclick=function(t){var o=e.contentComponent.clickCell,n={row:o.row,col:o.col,mergeRow:o.mergeRow,mergeCol:o.mergeCol,mergeStartLabel:o.mergeStartLabel,mergeEndLabel:o.mergeEndLabel,isMerge:!1};e.core.plugins.SettingPlugin.changeStepArr({type:10,label:o.label,pre:{row:o.row,col:o.col,mergeRow:o.mergeRow,mergeCol:o.mergeCol,mergeStartLabel:o.mergeStartLabel,mergeEndLabel:o.mergeEndLabel,isMerge:!0},next:n}),e.core.plugins.SettingPlugin.wsSendInfoByTypeAndData(10,n),e.splitCell(o)},o.appendChild(n),o.appendChild(l),o.appendChild(i),o.appendChild(r),o.appendChild(s),o.appendChild(a),this.canvasWrapperDom.appendChild(o)}}]),e}(),L=function(){function e(t,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"labelInputDom",null),i(this,"fxInputDom",null),i(this,"fontHorAddrGroup",null),i(this,"fontVerAddrGroup",null),i(this,"fontSizeSelectDom",null),i(this,"fontColorSelectDom",null),i(this,"bgColorSelectDom",null),i(this,"fontItalicBtnDom",null),i(this,"fontWeightBtnDom",null),i(this,"fontStrikethroughBtnDom",null),i(this,"fontUnderlineBtnDom",null),i(this,"cellMergerBtnDom",null),i(this,"cellSplitBtnDom",null),i(this,"warnDialogDom",null),this.contentComponent=r.ContentComponent,this.headerComponent=r.HeaderComponent,this.sideComponent=r.SideComponent,this.selectorDom=t,this.canvasDom=s.canvasDom,this.canvasWrapperDom=s.canvasWrapperDom,this.options=l,this.layer=n,this.core=s,this.registrySettingDom(),this.registryWarnDialogDom()}return l(e,[{key:"registryWarnDialogDom",value:function(){var e=this.core.h;this.warnDialogDom=e("e-sheet-warn-dialog-tip",{attribute:{show:!1}}),this.selectorDom.appendChild(this.warnDialogDom)}},{key:"showDialog",value:function(e,t){this.warnDialogDom.setAttribute("t",e),this.warnDialogDom.setAttribute("content",t),this.warnDialogDom.setAttribute("show",!0)}},{key:"setLabelCon",value:function(e){this.labelInputDom.value=e}},{key:"setCellCon",value:function(e){this.fxInputDom.value=e}},{key:"cellFontTextAlignChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.textAlign=e,this.core.freshContent())}},{key:"cellFontTextBaseLineChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.textBaseline=e,this.core.freshContent())}},{key:"cellFontSizeChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontSize=e,this.core.freshContent())}},{key:"cellFontColorChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontColor=e,this.core.freshContent())}},{key:"cellBgColorChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.bgColor=e,this.core.freshContent())}},{key:"cellFontWeightChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontWeight=e,this.core.freshContent())}},{key:"cellUnderlineChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.underline=e,this.core.freshContent())}},{key:"cellStrikethroughChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.strikethrough=e,this.core.freshContent())}},{key:"cellFontItalicChange",value:function(e){this.contentComponent.clickCell&&(this.contentComponent.clickCell.fontItalic=e,this.core.freshContent())}},{key:"setCellAttrInHeader",value:function(e){this.fontHorAddrGroup.setAttribute("value",e.textAlign),this.fontVerAddrGroup.setAttribute("value",e.textBaseline),this.fontSizeSelectDom.setAttribute("value",e.fontSize),this.fontWeightBtnDom.setAttribute("current",e.fontWeight),this.fontStrikethroughBtnDom.setAttribute("current",e.strikethrough),this.fontUnderlineBtnDom.setAttribute("current",e.underline),this.fontItalicBtnDom.setAttribute("current",e.fontItalic),e.isMerge?(this.cellMergerBtnDom.style.display="none",this.cellSplitBtnDom.style.display="flex"):(this.cellMergerBtnDom.style.display="flex",this.cellSplitBtnDom.style.display="none"),this.setLabelCon(e.label),this.setCellCon(e.text)}},{key:"changeFirstSelectedCell",value:function(e){var t=this.contentComponent.searchRectByLabel(e);t&&(this.contentComponent.showClickRect(t),this.setCellAttrInHeader(t),this.setCellCon(t.text),this.contentComponent.setSecondClickCell(null),this.core.fresh())}},{key:"convenientChangeStepArr",value:function(e,t,o){var n=this.contentComponent.clickCell;this.changeStepArr({type:e,label:n.label,pre:n[t],next:o})}},{key:"convenientGroupChangeStepArr",value:function(e){var t=this.contentComponent,o=t.clickCell,n=t.contentGroup;this.changeStepArr({label:null!=e?e:o.label,sheet:JSON.stringify(n)})}},{key:"changeStepArr",value:function(e){var t=this.core.getCurrentSheet();this.core.stepCallbackArr.forEach((function(t){t(JSON.parse(e))})),t.stepNum!==t.stepArr.length-1?-1===t.stepNum?t.stepArr.splice(t.stepNum+1,t.stepArr.length,e):t.stepArr.splice(t.stepNum+1,t.stepArr.length-1-t.stepNum,e):t.stepArr.push(e),t.stepNum+=1}},{key:"forwardSetSheet",value:function(){var e=this,o=this.core,n=this.contentComponent,l=o.getCurrentSheet(),i=o.ws;if(l.stepNum!==l.stepArr.length-1){var r=l.stepArr[l.stepNum+1],s=n.searchRectByLabel(r.label);switch(r.type){case 1:s.text=r.next,n.showClickRect(s),i.wsSend(0,s);break;case 2:s.fontSize=r.next;break;case 3:s.textAlign=r.next;break;case 4:s.textBaseline=r.next;break;case 5:s.fontWeight=r.next;break;case 6:s.fontItalic=r.next;break;case 7:s.fontColor=r.next;break;case 8:s.bgColor=r.next;break;case 9:for(var a=[],c=1;c<r.next.length;c++)a.push(n.searchRectByLabel(r.next[c]));var h=n.searchRectByLabel(r.next[0]);this.wsSendInfoByTypeAndData(9,r.next),this.core.plugins.ContextmenuPlugin.mergeCell(h,a);break;case 10:var d=n.searchRectByColAndRow(r.next.col,r.next.row);this.wsSendInfoByTypeAndData(10,t({},r.next)),this.core.plugins.ContextmenuPlugin.splitCell(d);break;case 11:this.core.plugins.DragPlugin.expandWidthNoDrag(s.col,r.next.width-r.pre.width),this.core.ws.wsSend(11,t({dis:r.next.width-r.pre.width},r));break;case 12:this.core.plugins.DragPlugin.expandHeightNoDrag(s.row,r.next.height-r.pre.height),this.core.ws.wsSend(12,t({dis:r.next.height-r.pre.height},r));break;case 13:this.core.ws.wsSend(13,t({},r.next)),this.core.plugins.ContextmenuPlugin.insertCol(r.next.col,r.next.num,r.next.isLeft);break;case 14:this.core.ws.wsSend(14,t({},r.next)),this.core.plugins.ContextmenuPlugin.insertRow(r.next.row,r.next.num,r.next.isTop);break;case 15:var u=this.contentComponent.searchRectByLabel(r.next.label);this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(r.next.pasteStr,u);break;case 16:this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(r.pre.lastStr));var g=this.contentComponent.searchRectByLabel(r.next.label);this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(r.next.lastStr,g),this.contentComponent.setSecondClickCell(null),this.core.ws.wsSend(16,{pre:r.pre.lastStr,next:r.next.lastStr,label:r.next.label});break;case 17:r.next.forEach((function(t){var o=e.contentComponent.searchRectByLabel(t.label);e.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(t.tableDomStr,o)})),this.core.ws.wsSend(17,{next:r.next});break;case 18:s.strikethrough=r.next;break;case 19:s.underline=r.next}[1,2,3,4,5,6,7,8,18,19].includes(r.type)&&this.wsSendCellAttrByTypeAndData(r.type),o.fresh(),l.stepNum+=1}}},{key:"fallbackSetSheet",value:function(){var e=this,o=this.core,n=this.contentComponent,l=o.getCurrentSheet(),i=o.ws;if(-1!==l.stepNum){var r=l.stepArr[0===l.stepNum?0:l.stepNum],s=n.searchRectByLabel(r.label);switch(r.type){case 1:s.text=r.pre,n.showClickRect(s),i.wsSend(0,s);break;case 2:s.fontSize=r.pre;break;case 3:s.textAlign=r.pre;break;case 4:s.textBaseline=r.pre;break;case 5:s.fontWeight=r.pre;break;case 6:s.fontItalic=r.pre;break;case 7:s.fontColor=r.pre;break;case 8:s.bgColor=r.pre;break;case 9:var a=n.searchRectByLabel(r.pre);this.wsSendInfoByTypeAndData(9,{label:r.pre,undo:!0}),this.core.plugins.ContextmenuPlugin.splitCell(a);break;case 10:for(var c=[],h=0;h<r.pre.mergeRow;h++)for(var d=0;d<r.pre.mergeCol;d++)0===h&&0===d||c.push(n.searchRectByColAndRow(r.pre.col+d,r.pre.row+h));var u=n.searchRectByLabel(r.pre.mergeStartLabel);this.wsSendInfoByTypeAndData(10,t(t({},r.pre),{},{undo:!0})),this.core.plugins.ContextmenuPlugin.mergeCell(u,c);break;case 11:this.core.plugins.DragPlugin.expandWidthNoDrag(s.col,r.pre.width-r.next.width),this.core.ws.wsSend(11,t({dis:r.pre.width-r.next.width},r));break;case 12:this.core.plugins.DragPlugin.expandHeightNoDrag(s.row,r.pre.height-r.next.height),this.core.ws.wsSend(12,t({dis:r.pre.height-r.next.height},r));break;case 13:this.core.ws.wsSend(13,t(t({},r.pre),{},{undo:!0})),this.core.plugins.ContextmenuPlugin.removeCol(r.pre.col,r.pre.num,r.pre.isLeft);break;case 14:this.core.ws.wsSend(14,t(t({},r.pre),{},{undo:!0})),this.core.plugins.ContextmenuPlugin.removeRow(r.pre.row,r.pre.num,r.pre.isTop);break;case 15:this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(r.pre.pasteStr)),this.core.ws.wsSend(15,{undo:!0,pasteStr:r.pre.pasteStr});break;case 16:this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(r.pre.beforeStr));var g=this.contentComponent.searchRectByLabel(r.next.label);this.core.plugins.SelectPlugin.forcePasteCellToNewCellByTargetCell(JSON.parse(r.next.beforeStr),g),this.core.ws.wsSend(16,{undo:!0,pre:r.pre.beforeStr,next:r.next.beforeStr,label:r.next.label}),this.contentComponent.setSecondClickCell(null);break;case 17:r.pre.forEach((function(t){e.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(t))})),this.core.ws.wsSend(17,{undo:!0,pre:r.pre});break;case 18:s.strikethrough=r.pre;break;case 19:s.underline=r.pre}[1,2,3,4,5,6,7,8,18,19].includes(r.type)&&this.wsSendCellAttrByTypeAndData(r.type),o.fresh(),l.stepNum-=1}}},{key:"wsSendCellAttrByTypeAndData",value:function(e){var t=this.contentComponent.clickCell;this.core.ws.wsSend(e,t)}},{key:"wsSendInfoByTypeAndData",value:function(e,t){this.core.ws.wsSend(e,t)}},{key:"registrySettingDom",value:function(){var e=this,t=this.core.h,o=t("input",{attr:{className:"cell-label-input",onblur:function(t){e.changeFirstSelectedCell(e.labelInputDom.value)},onkeydown:function(t){"Enter"===t.key&&e.changeFirstSelectedCell(e.labelInputDom.value)}}});this.labelInputDom=o;var n="A1",l=t("input",{attr:{className:"fx-input",oninput:function(t){e.core.plugins.InputPlugin.inputDom.value=t.target.value},onfocus:function(t){e.contentComponent.clickCell&&(n=e.contentComponent.clickCell.label,e.core.plugins.InputPlugin.showInput(e.contentComponent.clickCell))},onblur:function(t){e.core.plugins.InputPlugin.inputDom.value?(e.changeStepArr({type:1,label:n,pre:e.contentComponent.clickCell.text,next:e.core.plugins.InputPlugin.inputDom.value}),e.contentComponent.searchRectByLabel(n).text=e.core.plugins.InputPlugin.inputDom.value,e.core.freshContent(),e.core.plugins.InputPlugin.hideInput()):e.core.plugins.InputPlugin.hideInput()}}});this.fxInputDom=l;var i=t("div",{attr:{className:"e-sheet-setting-input-bar-layout"}},[t("div",{attr:{className:"left-input-layout"}},[o]),t("div",{attr:{className:"right-input-layout"}},[t("span",{attr:{innerText:"fx",className:"prefix-label"}}),l])]);this.selectorDom.insertBefore(i,this.canvasWrapperDom),this.createFontHorAddrGroup(),this.createFontVerAddrGroup();var r=t("div",{attr:{className:"e-sheet-setting-layout"}}),s=t("div",{attr:{className:"font-position-layout"}});s.appendChild(this.fontVerAddrGroup),s.appendChild(this.fontHorAddrGroup),this.createFontSizeSelectDom();var a=t("div",{attr:{className:"font-position-layout"}}),c=t("div",{attr:{className:"font-position-layout"}});a.appendChild(this.fontSizeSelectDom),this.createFontWeightBtnDom(),this.createFontItalicBtnDom(),this.createFontUnderlineBtnDom(),this.createFontStrikethroughBtnDom();var h=t("div",{attr:{className:"e-sheet-font-style-layout"}},[this.fontWeightBtnDom,this.fontItalicBtnDom,this.fontUnderlineBtnDom,this.fontStrikethroughBtnDom]);a.appendChild(h),c.appendChild(this.createFontColorSelectDom()),c.appendChild(this.createBgColorSelectDom());var d=t("div",{attr:{className:"e-sheet-divide-line"}});this.createCellMergerBtnDom(),this.createCellSplitBtnDom();var u=t("div",{attr:{className:"font-position-layout"}});u.appendChild(this.cellMergerBtnDom),u.appendChild(this.cellSplitBtnDom),u.appendChild(t("div",{attr:{innerText:"",className:"e-sheet-font-style-layout e-sheet-cell-font"},style:{justifyContent:"center"}})),r.appendChild(this.createStepDom()),r.appendChild(d.cloneNode()),r.appendChild(s),r.appendChild(d.cloneNode()),r.appendChild(a),r.appendChild(d.cloneNode()),r.appendChild(c),r.appendChild(d.cloneNode()),r.appendChild(u),this.selectorDom.insertBefore(r,i)}},{key:"createStepDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-radio-button",{attribute:{label:"(Ctrl+Z)",value:"fallback",top:24,left:-24},attr:{onclick:function(t){e.fallbackSetSheet()}}},[t("e-sheet-icon-svg",{attribute:{category:"step",position:"fallback"}})]),n=t("e-sheet-radio-button",{attribute:{label:"(Ctrl+Y)",value:"forward",top:24,left:-24},attr:{onclick:function(t){e.forwardSetSheet()}}},[t("e-sheet-icon-svg",{attribute:{category:"step",position:"forward"}})]);document.addEventListener("keydown",(function(t){t.ctrlKey&&"z"===t.key&&e.fallbackSetSheet(),t.ctrlKey&&"y"===t.key&&e.forwardSetSheet()}));var l=t("div",{attr:{className:"font-position-layout"}});return l.appendChild(o),l.appendChild(n),l}},{key:"createCellSplitBtnDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-tip",{style:{display:"none"}},[t("div",{attr:{className:"e-sheet-font-style-layout e-sheet-cell-hover"},style:{cursor:"pointer",padding:"2px"}},[t("e-sheet-icon-svg",{attribute:{category:"cell",position:"split"}}),t("div",{attr:{innerText:"",className:"e-sheet-cell-font"}})])]);o.onclick=function(t){var n=e.contentComponent.clickCell,l={row:n.row,col:n.col,mergeRow:n.mergeRow,mergeCol:n.mergeCol,mergeStartLabel:n.mergeStartLabel,mergeEndLabel:n.mergeEndLabel,isMerge:!1};e.changeStepArr({type:10,label:n.label,pre:{row:n.row,col:n.col,mergeRow:n.mergeRow,mergeCol:n.mergeCol,mergeStartLabel:n.mergeStartLabel,mergeEndLabel:n.mergeEndLabel,isMerge:!0},next:l}),e.wsSendInfoByTypeAndData(10,l),e.core.plugins.ContextmenuPlugin.splitCell(n)&&(e.cellMergerBtnDom.style.display="flex",o.style.display="none")},this.cellSplitBtnDom=o}},{key:"createCellMergerBtnDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-tip",{attribute:{"tip-label":"",left:4,top:24}},[t("div",{attr:{className:"e-sheet-font-style-layout e-sheet-cell-hover"},style:{padding:"2px",userSelect:"none"}},[t("e-sheet-icon-svg",{attribute:{category:"cell",position:"merge"}}),t("div",{attr:{innerText:"",className:"e-sheet-cell-font"}})])]);o.onclick=function(t){var n=e.contentComponent,l=n.clickCell,i=n.mergeSelectedCell,r={type:9,label:l.label},s=[l].concat(p(i)).sort((function(e,t){return e.row-t.row+(e.col-t.col)}));r.pre=s[0].label,r.next=s.map((function(e){return e.label})),e.changeStepArr(r),e.wsSendInfoByTypeAndData(9,r.next),e.core.plugins.ContextmenuPlugin.mergeCell(s[0],s.slice(0))&&(o.style.display="none",e.cellSplitBtnDom.style.display="flex")},this.cellMergerBtnDom=o}},{key:"createBgColorSelectDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-tip",{attribute:{"tip-label":"",left:-10,top:22}}),n=t("e-sheet-icon-color-svg",{attribute:{category:"bg-color"}});return this.bgColorSelectDom=n,o.appendChild(n),n.addEventListener("e-sheet-icon-color-svg-onchange",(function(t){e.convenientChangeStepArr(8,"bgColor",t.detail),e.cellBgColorChange(t.detail),e.wsSendCellAttrByTypeAndData(8)})),o}},{key:"createFontColorSelectDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-icon-color-svg",{attribute:{category:"font-color"}});o.addEventListener("e-sheet-icon-color-svg-onchange",(function(t){e.convenientChangeStepArr(7,"fontColor",t.detail),e.cellFontColorChange(t.detail),e.wsSendCellAttrByTypeAndData(7)}));var n=t("e-sheet-tip",{attribute:{"tip-label":"",left:-10,top:22}});return n.appendChild(o),this.fontColorSelectDom=o,n}},{key:"createFontHorAddrGroup",value:function(){var e=this,t=this.core.h,o=t("e-sheet-radio-group",{},[t("e-sheet-radio-button",{attribute:{label:"",value:"left"}},[t("e-sheet-icon-svg",{attribute:{category:"hor",position:"left"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"",value:"center"}},[t("e-sheet-icon-svg",{attribute:{category:"hor",position:"center"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"",value:"right"}},[t("e-sheet-icon-svg",{attribute:{category:"hor",position:"right"}})])]);this.fontHorAddrGroup=o,o.addEventListener("e-sheet-radio-group-onchange",(function(t){e.convenientChangeStepArr(4,"textAlign",t.detail),e.cellFontTextAlignChange(t.detail),e.wsSendCellAttrByTypeAndData(4)}))}},{key:"createFontVerAddrGroup",value:function(){var e=this,t=this.core.h,o=t("e-sheet-radio-group",{},[t("e-sheet-radio-button",{attribute:{label:"",value:"top"}},[t("e-sheet-icon-svg",{attribute:{category:"ver",position:"top"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"",value:"middle"}},[t("e-sheet-icon-svg",{attribute:{category:"ver",position:"middle"}})]),t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"",value:"bottom"}},[t("e-sheet-icon-svg",{attribute:{category:"ver",position:"bottom"}})])]);this.fontVerAddrGroup=o,o.addEventListener("e-sheet-radio-group-onchange",(function(t){e.convenientChangeStepArr(3,"textBaseLine",t.detail),e.cellFontTextBaseLineChange(t.detail),e.wsSendCellAttrByTypeAndData(3)}))}},{key:"createFontSizeSelectDom",value:function(){var e=this,t=(0,this.core.h)("e-sheet-select",{});t.addEventListener("e-sheet-select-onchange",(function(t){e.convenientChangeStepArr(2,"fontSize",parseInt(t.detail)),e.cellFontSizeChange(t.detail),e.wsSendCellAttrByTypeAndData(2)})),t.setAttribute("label",""),this.fontSizeSelectDom=t}},{key:"createFontWeightBtnDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-radio-button",{attribute:{label:"",value:"bold"}},[t("e-sheet-icon-svg",{attribute:{category:"font",position:"weight"}})]);this.fontWeightBtnDom=o,o.addEventListener("e-sheet-radio-group-change",(function(t){""===o.getAttribute("current")?(o.setAttribute("current",t.detail),e.convenientChangeStepArr(5,"fontWeight",t.detail),e.cellFontWeightChange(t.detail)):(o.setAttribute("current",""),e.convenientChangeStepArr(5,"fontWeight",""),e.cellFontWeightChange("")),e.wsSendCellAttrByTypeAndData(5)}))}},{key:"createFontItalicBtnDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"",value:"italic"}},[t("e-sheet-icon-svg",{attribute:{category:"font",position:"italic"}})]);this.fontItalicBtnDom=o,o.addEventListener("e-sheet-radio-group-change",(function(t){""===o.getAttribute("current")?(o.setAttribute("current",t.detail),e.convenientChangeStepArr(6,"fontItalic",t.detail),e.cellFontItalicChange(t.detail)):(o.setAttribute("current",""),e.convenientChangeStepArr(6,"fontItalic",""),e.cellFontItalicChange("")),e.wsSendCellAttrByTypeAndData(6)}))}},{key:"createFontStrikethroughBtnDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"",value:"true"}},[t("e-sheet-icon-svg",{attribute:{category:"font",position:"strikethrough"}})]);this.fontStrikethroughBtnDom=o,o.addEventListener("e-sheet-radio-group-change",(function(t){""===o.getAttribute("current")?(o.setAttribute("current",t.detail),e.convenientChangeStepArr(18,"strikethrough",t.detail),e.cellStrikethroughChange("true")):(o.setAttribute("current",""),e.convenientChangeStepArr(18,"strikethrough",""),e.cellStrikethroughChange("")),e.wsSendCellAttrByTypeAndData(18)}))}},{key:"createFontUnderlineBtnDom",value:function(){var e=this,t=this.core.h,o=t("e-sheet-radio-button",{style:{marginLeft:"6px"},attribute:{label:"",value:"true"}},[t("e-sheet-icon-svg",{attribute:{category:"font",position:"underline"}})]);this.fontUnderlineBtnDom=o,o.addEventListener("e-sheet-radio-group-change",(function(t){""===o.getAttribute("current")?(o.setAttribute("current",t.detail),e.convenientChangeStepArr(19,"underline",t.detail),e.cellUnderlineChange("true")):(o.setAttribute("current",""),e.convenientChangeStepArr(19,"underline",""),e.cellUnderlineChange("")),e.wsSendCellAttrByTypeAndData(19)}))}}]),e}(),T=function(){function e(t,n){var l=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"contextmenuDom",null),i(this,"hideContextMenu",(function(){l.contextmenuDom.style.display="none"})),i(this,"sheetArrLayoutDom",null),this.contentComponent=s.ContentComponent,this.headerComponent=s.HeaderComponent,this.sideComponent=s.SideComponent,this.selectorDom=t,this.canvasDom=a.canvasDom,this.canvasWrapperDom=a.canvasWrapperDom,this.options=r,this.layer=n,this.core=a,this.registryDom(),this.registryContextmenuDom()}return l(e,[{key:"registryContextmenuDom",value:function(){var e=this,t=this.core.h;this.contextmenuDom=t("div",{style:{display:"none"},attr:{className:"e-sheet-contextmenu-layout"}},[t("div",{style:{cursor:"pointer"},attr:{innerText:"",className:"item-btn",onclick:function(t){if(1!==e.core.eSheetWorkBook.length){var o=parseInt(t.target.parentNode.dataset.select);e.core.eSheetWorkBook.splice(o,1),e.core.currentSheetIndex=e.core.eSheetWorkBook.length-1,e.core.switchSheet(e.core.currentSheetIndex),e.sheetArrLayoutDom.removeChild(e.sheetArrLayoutDom.childNodes[o]),e.sheetArrLayoutDom.childNodes.forEach((function(e,t){e.className="item-span",e.setAttribute("index",t)})),e.sheetArrLayoutDom.childNodes[o-1].className="item-span active-item-span",e.hideContextMenu()}else e.hideContextMenu()}}})]),this.selectorDom.appendChild(this.contextmenuDom)}},{key:"createNewSheet",value:function(){this.core.createNewSheet(),this.core.currentSheetIndex=this.core.eSheetWorkBook.length-1;var e=this.core.eSheetWorkBook[this.core.currentSheetIndex];this.core.switchSheet(this.core.currentSheetIndex),this.sheetArrLayoutDom.childNodes.forEach((function(e){e.className="item-span"})),this.sheetArrLayoutDom.appendChild(this.core.h("span",{attr:{innerText:e.label,className:"item-span active-item-span"},attribute:{index:this.core.currentSheetIndex}}))}},{key:"freshBookSheet",value:function(){var e=this;this.sheetArrLayoutDom.childNodes.forEach((function(e){return e.remove()})),this.core.eSheetWorkBook.forEach((function(t,o){e.sheetArrLayoutDom.appendChild(e.core.h("span",{attr:{innerText:t.label,className:"item-span"+(e.core.currentSheetIndex===o?" active-item-span":"")},attribute:{index:e.core.currentSheetIndex}}))}))}},{key:"switchSheet",value:function(e){this.core.switchSheet(e);var t=this.core.currentSheetIndex;this.sheetArrLayoutDom.childNodes.forEach((function(e,o){e.className=t===o?"item-span active-item-span":"item-span"}))}},{key:"setSheetName",value:function(e,t){return!(this.core.eSheetWorkBook.map((function(e){return e.label})).includes(t)||!t)&&(this.core.eSheetWorkBook[e].label=t,!0)}},{key:"setCanvasScale",value:function(e){var t=this,o=this.options,n=o.width,l=o.height,i=o.cellHeight;this.contentComponent.contentGroup.forEach((function(o){o.width/=t.core.scale,o.height/=t.core.scale,o.x/=t.core.scale,o.y/=t.core.scale,o.ltX=i+o.x,o.ltY=i+o.y,o.mergeWidth/=t.core.scale,o.mergeHeight/=t.core.scale,o.width*=e,o.height*=e,o.x*=e,o.y*=e,o.ltX=e*i+o.x,o.ltY=e*i+o.y,o.mergeWidth*=e,o.mergeHeight*=e})),this.core.scale=e;var r=this.contentComponent.contentGroup[this.contentComponent.contentGroup.length-1];this.core.sheetWidth=r.ltX+r.width,this.core.sheetHeight=r.ltY+r.height,this.layer.clearRect(0,0,n,l),this.core.fresh(),this.core.freshScrollBar()}},{key:"registryDom",value:function(){var e=this,t=this.core,o=t.h,n=t.eSheetWorkBook,l=t.currentSheetIndex,i=o("div",{attr:{className:"sheet-arr-layout",onclick:function(t){e.hideContextMenu();var o=t.target.getAttribute("index");o&&e.switchSheet(parseInt(o))},ondblclick:function(t){var n=t.target,l=parseInt(t.target.getAttribute("index")),i=n.innerText,r=o("input",{attr:{className:"item-input",onblur:function(t){n.contains(r)&&(e.setSheetName(l,n.innerText)?n.innerText=r.value:n.innerText=i,r.remove())},onkeydown:function(t){"Enter"===t.key&&(e.setSheetName(l,n.innerText)?n.innerText=r.value:n.innerText=i,r.remove())}}});r.value=n.innerText,r.style.width=n.getBoundingClientRect().width-24+"px",n.innerText="",n.appendChild(r),r.focus()},oncontextmenu:function(t){t.preventDefault();var o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;e.contextmenuDom.dataset.select=t.target.getAttribute("index"),e.contextmenuDom.style.display="block",e.contextmenuDom.style.left=n+t.x+"px",e.contextmenuDom.style.top=o+t.y-34+"px"}}},n.map((function(e,t){return o("div",{attr:{innerText:e.label,className:l===t?"item-span active-item-span":"item-span"},attribute:{index:t}})})));this.sheetArrLayoutDom=i;var r=o("div",{attr:{className:"e-sheet-book-layout"}},[o("div",{attr:{className:"e-sheet-book-con"}},[o("div",{attr:{className:"menu-layout"}},[o("div",{attr:{className:"e-sheet-cell-hover"}},[o("e-sheet-tip",{attribute:{"tip-label":"",left:-6,top:-36}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"menu"}})])]),o("div",{attr:{className:"e-sheet-cell-hover"}},[o("e-sheet-tip",{attribute:{"tip-label":"",left:-6,top:-36},attr:{onclick:function(t){e.createNewSheet()}}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"plus"}})])])]),i,o("div",{attr:{className:"scroll-handle-layout"}},[o("e-sheet-tip",{attribute:{"tip-label":"",left:-20,top:-36},style:{height:"100%"},attr:{onclick:function(e){i.scrollLeft-=300}}},[o("div",{attr:{className:"arrow"}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"arrow-left"}})])]),o("e-sheet-tip",{attribute:{"tip-label":"",left:-20,top:-36},style:{height:"100%"},attr:{onclick:function(e){i.scrollLeft+=300}}},[o("div",{attr:{className:"arrow"}},[o("e-sheet-icon-svg",{attribute:{category:"book",position:"arrow-right"}})])])])])]);this.selectorDom.appendChild(r)}}]),e}(),R=function(){function e(t,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;o(this,e),i(this,"ws",void 0),this.contentComponent=r.ContentComponent,this.headerComponent=r.HeaderComponent,this.sideComponent=r.SideComponent,this.selectorDom=t,this.canvasDom=s.canvasDom,this.canvasWrapperDom=s.canvasWrapperDom,this.mulPersonSelected=s.mulPersonSelected,this.options=l,this.layer=n,this.core=s}return l(e,[{key:"connect",value:function(e){this.ws=new WebSocket(e),this.wsOpenCallback(),this.wsCloseCallback(),this.wsMsgCallback()}},{key:"wsOpenCallback",value:function(){this.ws.onopen=function(e){}}},{key:"wsCloseCallback",value:function(){var e=this;this.ws.onclose=function(t){e.ws=null}}},{key:"wsMsgCallbackType1",value:function(e){this.contentComponent.changeRectTextByLabel(e.command)}},{key:"wsMsgCallbackType2",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontSize")}},{key:"wsMsgCallbackType3",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"textBaseline")}},{key:"wsMsgCallbackType4",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"textAlign")}},{key:"wsMsgCallbackType5",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontWeight")}},{key:"wsMsgCallbackType6",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontItalic")}},{key:"wsMsgCallbackType7",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"fontColor")}},{key:"wsMsgCallbackType8",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"bgColor")}},{key:"wsMsgCallbackType9",value:function(e){if(e.command.undo){var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.ContextmenuPlugin.splitCell(t,!1)}else{for(var o=[],n=1;n<e.command.length;n++)o.push(this.contentComponent.searchRectByLabel(e.command[n]));var l=this.contentComponent.searchRectByLabel(e.command[0]);this.core.plugins.ContextmenuPlugin.mergeCell(l,o,!1)}}},{key:"wsMsgCallbackType10",value:function(e){if(e.command.undo){for(var t=[],o=0;o<e.command.mergeRow;o++)for(var n=0;n<e.command.mergeCol;n++)0===o&&0===n||t.push(this.contentComponent.searchRectByColAndRow(e.command.col+n,e.command.row+o));var l=this.contentComponent.searchRectByLabel(e.command.mergeStartLabel);this.core.plugins.ContextmenuPlugin.mergeCell(l,t,!1)}else{var i=this.contentComponent.searchRectByColAndRow(e.command.col,e.command.row);this.core.plugins.ContextmenuPlugin.splitCell(i,!1)}}},{key:"wsMsgCallbackType11",value:function(e){var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.DragPlugin.expandWidthNoDrag(t.col,e.command.dis)}},{key:"wsMsgCallbackType12",value:function(e){var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.DragPlugin.expandHeightNoDrag(t.row,e.command.dis)}},{key:"wsMsgCallbackType13",value:function(e){var t=e.command;t.undo?this.core.plugins.ContextmenuPlugin.removeCol(t.col,t.num,t.isLeft):this.core.plugins.ContextmenuPlugin.insertCol(t.col,t.num,t.isLeft)}},{key:"wsMsgCallbackType14",value:function(e){var t=e.command;t.undo?this.core.plugins.ContextmenuPlugin.removeRow(t.row,t.num,t.isTop):this.core.plugins.ContextmenuPlugin.insertRow(t.row,t.num,t.isTop)}},{key:"wsMsgCallbackType15",value:function(e){if(e.command.undo)this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(e.command.pasteStr));else{var t=this.contentComponent.searchRectByLabel(e.command.label);this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(e.command.pasteStr,t,!1)}}},{key:"wsMsgCallbackType16",value:function(e){var t=e.command;this.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(t.pre));var o=this.contentComponent.searchRectByLabel(t.label);t.undo?this.core.plugins.SelectPlugin.forcePasteCellToNewCellByTargetCell(JSON.parse(t.next),o):this.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(t.next,o,!1),this.contentComponent.setSecondClickCell(null)}},{key:"wsMsgCallbackType17",value:function(e){var t=this,o=e.command;o.undo?o.pre.forEach((function(e){t.core.plugins.SelectPlugin.forcePasteCellToNewCell(JSON.parse(e))})):o.next.forEach((function(e){var o=t.contentComponent.searchRectByLabel(e.label);t.core.plugins.SelectPlugin.transformTableDomStrToCanvasCell(e.tableDomStr,o,!1)}))}},{key:"wsMsgCallbackType18",value:function(e){this.contentComponent.changeRectAttrByLabel(e.command,"strikethrough")}},{key:"changeUserShow",value:function(e){var t=this.mulPersonSelected.findIndex((function(t){return t.userId===e.userId}));e.command=this.contentComponent.searchRectByLabel(e.command.label),-1===t?this.mulPersonSelected.push(e):this.mulPersonSelected[t]=e}},{key:"wsMsgCallback",value:function(){var e=this;this.ws.onmessage=function(t){e.core.plugins.DragPlugin;var o=e.core.components.ContentComponent,n=o.clickCell;JSON.stringify(n);var l=JSON.parse(t.data);switch(l.type){case 999:o.contentGroup=l.command,e.mulPersonSelected.forEach((function(e){e.command=o.searchRectByLabel(e.command.label)}));break;case 0:e.changeUserShow(l);break;case 1:e.wsMsgCallbackType1(l);break;case 2:e.wsMsgCallbackType2(l);break;case 3:e.wsMsgCallbackType3(l);break;case 4:e.wsMsgCallbackType4(l);break;case 5:e.wsMsgCallbackType5(l);break;case 6:e.wsMsgCallbackType6(l);break;case 7:e.wsMsgCallbackType7(l);break;case 8:e.wsMsgCallbackType8(l);break;case 9:e.wsMsgCallbackType9(l);break;case 10:e.wsMsgCallbackType10(l);break;case 11:e.wsMsgCallbackType11(l);break;case 12:e.wsMsgCallbackType12(l);break;case 13:e.wsMsgCallbackType13(l);break;case 14:e.wsMsgCallbackType14(l);break;case 15:e.wsMsgCallbackType15(l);break;case 16:e.wsMsgCallbackType16(l);break;case 17:e.wsMsgCallbackType17(l);break;case 18:e.wsMsgCallbackType18(l)}e.core.fresh()}}},{key:"wsSend",value:function(e,t){this.ws&&this.ws.send(JSON.stringify({type:e,command:t,userId:this.core.userId,userName:this.core.userName,userColor:this.core.userColor}))}},{key:"syncData",value:function(){this.wsSend(0,this.core.components.ContentComponent.contentGroup)}}]),e}(),P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.attr,n=t.style,l=t.attribute,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=document.createElement(e);for(var s in o)r[s]=o[s];for(var a in l)r.setAttribute(a,l[a]);for(var c in n)r.style[c]=n[c];i&&("[object Array]"===N(i)?i.forEach((function(e){r.appendChild(e)})):r.appendChild(i));return r},N=function(e){return Object.prototype.toString.call(e)},Z=function(e){r(n,d(HTMLElement));var t=g(n);function n(){return o(this,n),t.apply(this,arguments)}return l(n,[{key:"connectedCallback",value:function(){this.className="e-sheet-loading-cup-layout";var e=P("div",{attr:{className:"cup"}},[P("div",{attr:{className:"handle"}})]);this.appendChild(e)}}]),n}();customElements.define("e-sheet-loading-cup",Z);var W=function(e){r(n,d(HTMLElement));var t=g(n);function n(){return o(this,n),t.apply(this,arguments)}return l(n,[{key:"connectedCallback",value:function(){var e=this;this.tipLabel=this.getAttribute("tip-label"),this.left=parseInt(this.getAttribute("left")),this.top=parseInt(this.getAttribute("top"));var t=document.createElement("div");t.className="e-sheet-radio-button-tip",t.innerText=this.tipLabel,this.className="e-sheet-tip",this.addEventListener("mouseover",(function(o){if(!document.body.contains(t)){var n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,l=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,i=e.getBoundingClientRect(),r=i.x,s=i.y;t.style.left=r+e.left+l+"px",t.style.top=s+e.top+n+"px",document.body.appendChild(t)}})),this.addEventListener("mouseleave",(function(e){t.remove()}))}}]),n}();customElements.define("e-sheet-tip",W);var H=function(e){r(n,d(HTMLElement));var t=g(n);function n(){var e;return o(this,n),i(u(e=t.call(this)),"optionLayoutDom",null),i(u(e),"isOpen",!1),i(u(e),"showTextDom",null),i(u(e),"arrowDom",null),e}return l(n,[{key:"close",value:function(){this.optionLayoutDom&&this.optionLayoutDom.remove(),this.optionLayoutDom=null,this.isOpen=!1,this.arrowDom.style.transform="rotate(0deg)"}},{key:"connectedCallback",value:function(){var e,t=this;this.value=null!==(e=this.getAttribute("value"))&&void 0!==e?e:12,this.label=this.getAttribute("label"),this.className="e-sheet-select";var o=document.createElement("div");o.className="e-sheet-radio-button-tip",o.innerText=this.label,this.addEventListener("mouseover",(function(e){o||((o=document.createElement("div")).className="e-sheet-radio-button-tip",o.innerText=t.label);var n=t.getBoundingClientRect(),l=n.x,i=n.y;o.style.left=l+12+"px",o.style.top=i+24+"px",document.body.appendChild(o)})),this.addEventListener("mouseleave",(function(e){o.remove()}));var n=document.createElement("div");n.innerText=this.value,n.className="select-text",this.showTextDom=n;var l=document.createElement("e-sheet-icon-svg");l.setAttribute("category","select"),l.setAttribute("position","down"),this.arrowDom=l,l.style.transition="transform .5s",this.appendChild(n),this.appendChild(l),document.addEventListener("click",(function(e){t.contains(e.target)||t.close()})),this.addEventListener("e-sheet-option-onchange",(function(e){n.innerText=t.value=e.detail,t.dispatchEvent(new CustomEvent("e-sheet-select-onchange",{bubbles:!1,composed:!0,detail:t.value})),o.remove(),t.close()})),this.addEventListener("click",(function(e){if(e.stopImmediatePropagation(),t.isOpen)t.close();else if(!t.optionLayoutDom||t.optionLayoutDom.contains(e.target)){t.isOpen=!0,l.style.transform="rotate(180deg)",t.optionLayoutDom=document.createElement("div"),t.optionLayoutDom.className="e-sheet-option-layout",new Array(10).fill(0).forEach((function(e,o){var n=document.createElement("e-sheet-option");n.setAttribute("label",(12+o).toString()),n.setAttribute("value",12+o),n.setAttribute("current",t.value),t.optionLayoutDom.appendChild(n)}));var o=t.getBoundingClientRect().height;t.optionLayoutDom.style.left="-1px",t.optionLayoutDom.style.top=o+"px",t.appendChild(t.optionLayoutDom)}}))}},{key:"attributeChangedCallback",value:function(e,t,o){this.value=o,this.showTextDom.innerText=this.value}}],[{key:"observedAttributes",get:function(){return["value"]}}]),n}();customElements.define("e-sheet-select",H);var j=function(e){r(n,d(HTMLElement));var t=g(n);function n(){return o(this,n),t.call(this)}return l(n,[{key:"connectedCallback",value:function(){var e=this;this.label=this.getAttribute("label"),this.value=this.getAttribute("value"),this.current=this.getAttribute("current"),this.className="e-sheet-option";var t=document.createElement("div");t.className="option-font",t.innerText=this.label;var o=document.createElement("e-sheet-icon-svg");this.value!==this.current&&(o.style.display="none"),o.setAttribute("category","bool"),o.setAttribute("position","true"),this.appendChild(t),this.appendChild(o),this.addEventListener("click",(function(t){t.stopImmediatePropagation(),e.dispatchEvent(new CustomEvent("e-sheet-option-onchange",{bubbles:!0,composed:!0,detail:e.value}))}))}}]),n}();customElements.define("e-sheet-option",j);var G=function(e){r(n,d(HTMLElement));var t=g(n);function n(){return o(this,n),t.call(this)}return l(n,[{key:"connectedCallback",value:function(){var e=this;this.value=this.getAttribute("value");var t=this.attachShadow({mode:"open"}),o=document.createElement("slot");this.className="e-sheet-radio-group",t.appendChild(o),t.addEventListener("e-sheet-radio-group-change",(function(o){e.value=o.detail,new Array(e.childElementCount).fill(void 0).forEach((function(t,o){e.children.item(o).setAttribute("current",e.value)})),t.dispatchEvent(new CustomEvent("e-sheet-radio-group-onchange",{bubbles:!1,composed:!0,detail:e.value}))}))}},{key:"attributeChangedCallback",value:function(e,t,o){var n=this;this.value=o,new Array(this.childElementCount).fill(void 0).forEach((function(e,t){n.children.item(t).setAttribute("current",n.value)}))}}],[{key:"observedAttributes",get:function(){return["value"]}}]),n}();customElements.define("e-sheet-radio-group",G);var E=function(e){r(n,d(HTMLElement));var t=g(n);function n(){return o(this,n),t.call(this)}return l(n,[{key:"connectedCallback",value:function(){var e=this;this.label=this.getAttribute("label"),this.value=this.getAttribute("value"),this.left=this.getAttribute("left"),this.top=this.getAttribute("top"),this.className="e-sheet-radio-button";var t=this.attachShadow({mode:"open"}),o=document.createElement("div");o.className="e-sheet-radio-button-tip",o.innerText=this.label;var n=document.createElement("slot");t.addEventListener("click",(function(o){t.dispatchEvent(new CustomEvent("e-sheet-radio-group-change",{bubbles:!0,composed:!0,detail:e.value}))})),this.addEventListener("mouseover",(function(t){if(!document.body.contains(o)){var n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,l=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,i=e.getBoundingClientRect(),r=i.x,s=i.y,a=e.left?parseInt(e.left):12*-e.label.length/2+4,c=e.top?parseInt(e.top):24;o.style.left=r+a+l+"px",o.style.top=s+n+c+"px",document.body.appendChild(o)}})),this.addEventListener("mouseleave",(function(e){o.remove()})),t.appendChild(n)}},{key:"attributeChangedCallback",value:function(e,t,o){this.value===o?this.className="e-sheet-radio-button e-sheet-radio-button-selected":this.className="e-sheet-radio-button"}}],[{key:"observedAttributes",get:function(){return["current"]}}]),n}();customElements.define("e-sheet-radio-button",E);var Y=function(e){r(n,d(HTMLElement));var t=g(n);function n(){return o(this,n),t.call(this)}return l(n,[{key:"connectedCallback",value:function(){if(this.category=this.getAttribute("category"),this.position=this.getAttribute("position"),"hor"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"left":case"start":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00059"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00059)"><path fill="currentColor" fill-opacity="0.94" d="M17 5H3V4h14v1Zm-7 4H3V8h7v1Zm0 8H3v-1h7v1Zm7-4v-1H3v1h14Z"></path></g></svg>');case"center":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00035"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00035)"><path fill="currentColor" fill-opacity="0.94" d="M17 5H3V4h14v1ZM7 9h6V8H7v1Zm10 4H3v-1h14v1Zm-4 4H7v-1h6v1Z"></path></g></svg>');case"right":case"end":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00066"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00066)"><path fill="currentColor" fill-opacity="0.94" d="M17 5H3V4h14v1Zm-7 4h7V8h-7v1Zm7 3v1H3v-1h14Zm0 5h-7v-1h7v1Z"></path></g></svg>')}if("ver"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"top":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_7600_00213"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_00213)"><path fill="currentColor" d="M17 4H3V3h14v1Z"></path><path fill="#0089FF" d="m10.013 6 3.487 4h-7l3.513-4Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 9v8h-1V9h1Z"></path></g></svg>');case"middle":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_7600_00207"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_00207)"><path fill="currentColor" d="M17 10H3V9h14v1Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 1v5h-1V1h1Z"></path><path fill="#0089FF" d="m10.01 8 2.49-3h-5l2.51 3ZM10.01 11l2.49 3h-5l2.51-3Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 14v4h-1v-4h1Z"></path></g></svg>');case"bottom":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_7600_00217"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_00217)"><path fill="currentColor" d="M17 17H3v-1h14v1Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M10.5 3v8h-1V3h1Z"></path><path fill="#0089FF" d="m10.013 14 3.487-4h-7l3.513 4Z"></path></g></svg>')}if("bool"!==this.category||(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20","true"!==this.position))if("select"!==this.category||(this.className="e-sheet-cell-svg-layout e-sheet-svg-12-12","down"!==this.position)){if("font"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"weight":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="master_svg0_6926_00081"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_6926_00081)"><path fill="currentColor" d="M5.8 3.05a.75.75 0 0 0-.75.75v12.5c0 .414.336.75.75.75h5.5c2.297 0 3.75-1.862 3.75-4 0-1.415-.637-2.71-1.734-3.423.734-.635 1.234-1.588 1.234-2.827 0-2.424-1.91-3.75-3.75-3.75h-5Zm5 6H6.55v-4.5h4.25c1.16 0 2.25.796 2.25 2.25s-1.09 2.25-2.25 2.25Zm-4.25 1.5h4.75c1.314 0 2.25 1.027 2.25 2.5s-.936 2.5-2.25 2.5H6.55v-5Z" data-spm-anchor-id=""></path></g></svg>');case"italic":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20" data-spm-anchor-id=""><defs><clipPath id="master_svg0_7600_9375"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_7600_9375)"><path fill="currentColor" d="M12 4h3V3H8v1h2.769l-2.77 12H5v1h7v-1H9.231l2.77-12Z"></path></g></svg>');case"strikethrough":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="b33801_0"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#b33801_0)"><path fill="currentColor" d="M11.276 11h2.133c.222.192.42.419.584.694.672 1.125.684 2.469-.01 3.535-.697 1.07-2.04 1.771-3.91 1.771-1.935 0-3.102-.915-3.765-1.934-.642-.986-.808-2.058-.808-2.466h1c0 .242.125 1.12.646 1.921.501.77 1.37 1.479 2.927 1.479 1.621 0 2.604-.598 3.072-1.316.47-.722.481-1.653-.01-2.478-.244-.408-.62-.68-1.18-.934a10.414 10.414 0 0 0-.679-.272ZM3 10h14V9H3v1Zm4.115-6.016C7.87 3.329 8.92 3 10.073 3c2.058 0 3.631 1.518 3.984 3.669l-.987.162C12.783 5.082 11.564 4 10.073 4c-.972 0-1.77.278-2.304.74-.523.452-.832 1.113-.788 1.985.014.275.07.513.156.721.083.204.198.387.339.554H6.29a3.168 3.168 0 0 1-.307-1.225c-.06-1.163.364-2.127 1.132-2.791Z"></path></g></svg>');case"underline":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="9fa4b3_0"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#9fa4b3_0)"><path fill="currentColor" d="M3 17v1h13v-1H3Zm3-6.5V3H5v7.5a4.5 4.5 0 1 0 9 0V3h-1v7.5a3.5 3.5 0 1 1-7 0Z"></path></g></svg>')}if("cell"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"merge":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_31608_94416"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_31608_94416)"><path fill="#0089FF" d="M15 10.5H5v-1h10v1Z"></path><path fill="currentColor" d="M6.5 3A1.5 1.5 0 0 1 8 4.5V6H7V4.5a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0-.5.5v11a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5V14h1v1.5A1.5 1.5 0 0 1 6.5 17h-2A1.5 1.5 0 0 1 3 15.5v-11A1.5 1.5 0 0 1 4.5 3h2Zm7 0A1.5 1.5 0 0 0 12 4.5V6h1V4.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5V14h-1v1.5a1.5 1.5 0 0 0 1.5 1.5h2a1.5 1.5 0 0 0 1.5-1.5v-11A1.5 1.5 0 0 0 15.5 3h-2Z"></path></g></svg>');case"split":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_31608_94446"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_31608_94446)"><path fill="currentColor" fill-rule="evenodd" d="M4 4.5A1.5 1.5 0 0 1 5.5 3h2A1.5 1.5 0 0 1 9 4.5v11A1.5 1.5 0 0 1 7.5 17h-2A1.5 1.5 0 0 1 4 15.5V14h1v1.5a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5v-11a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0-.5.5V6H4V4.5ZM16 4.5A1.5 1.5 0 0 0 14.5 3h-2A1.5 1.5 0 0 0 11 4.5v11a1.5 1.5 0 0 0 1.5 1.5h2a1.5 1.5 0 0 0 1.5-1.5V14h-1v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5V6h1V4.5Z"></path><path fill="#0089FF" fill-rule="evenodd" d="M7 10.5H4v-1h3v1ZM16 10.5h-3v-1h3v1Z"></path><path fill="#0089FF" d="m18 10-3-2.5v5l3-2.5ZM2 10l3-2.5v5L2 10Z"></path></g></svg>')}if("book"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"menu":return void(this.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" data-spm-anchor-id=""><path d="M6 5H18V4H6V5ZM18 10H6V9H18V10ZM18 15H6V14H18V15ZM2 5H4V4H2V5ZM4 10H2V9H4V10ZM4 15H2V14H4V15Z" fill="rgba(40,50,72,1)"></path></svg>');case"plus":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_30306_58308"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_30306_58308)"><path fill="currentColor" fill-opacity="0.94" d="M9.5 4.5v5h-5a.5.5 0 0 0 0 1h5v5a.5.5 0 0 0 1 0v-5h5a.5.5 0 0 0 0-1h-5v-5a.5.5 0 0 0-1 0Z"></path></g></svg>');case"arrow-left":return void(this.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="wdn-icon" data-spm-anchor-id=""><path d="m12.646 3.646.708.708L7.707 10l5.647 5.646-.707.708L6.292 10l6.353-6.354Z" fill="currentColor"></path></svg>');case"arrow-right":return void(this.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="wdn-icon"><path d="m7.353 3.646-.707.708L12.293 10l-5.647 5.646.707.708L13.707 10 7.353 3.646Z" fill="currentColor"></path></svg>')}if("step"===this.category)switch(this.className="e-sheet-cell-svg-layout e-sheet-svg-20-20",this.position){case"forward":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20" data-spm-anchor-id=""><defs><clipPath id="___SVG_ID__50__0___"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#___SVG_ID__50__0___)"><path fill="currentColor" fill-opacity="0.94" d="M16.3 6H7.988C4.975 6 3 8.22 3 11s1.975 5 4.988 5h4.168v1H7.988C4.388 17 2 14.296 2 11s2.387-6 5.988-6h8.298l-2.14-2.147.708-.706 3.353 3.364-3.354 3.343-.706-.708L16.3 6Z"></path></g></svg>');case"fallback":return void(this.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" size="20"><defs><clipPath id="___SVG_ID__49__0___"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#___SVG_ID__49__0___)"><path fill="currentColor" fill-opacity="0.94" d="M6.354 2.353 3.714 5h8.298C15.612 5 18 7.704 18 11s-2.387 6-5.988 6H8v-1h4.012C15.025 16 17 13.78 17 11s-1.975-5-4.988-5H3.7l2.653 2.646-.706.708-3.854-3.843 3.853-3.864.708.706Z"></path></g></svg>')}}else this.innerHTML='<svg width="12" height="12" viewBox="0 0 12 12" stroke="none" data-spm-anchor-id="" style=""><path d="M6.00004 7.79293L1.85359 3.64648L1.14648 4.35359L6.00004 9.20714L10.8536 4.35359L10.1465 3.64648L6.00004 7.79293Z" fill="currentColor" data-spm-anchor-id=""></path></svg>';else this.innerHTML='<svg fill="none" width="20" height="20" viewBox="0 0 20 20" class="wdn-icon"><path d="M16.354 6.854a.5.5 0 0 0-.708-.708L8.5 13.293 4.854 9.647a.5.5 0 1 0-.708.707l4 4a.5.5 0 0 0 .708 0l7.5-7.5Z" fill="currentColor"></path></svg>'}}]),n}();customElements.define("e-sheet-icon-svg",Y);var z=function(e){r(n,d(HTMLElement));var t=g(n);function n(){return o(this,n),t.call(this)}return l(n,[{key:"connectedCallback",value:function(){var e=this;this.category=this.getAttribute("category"),this.color=this.getAttribute("color"),this.className="e-sheet-icon-color-svg";var t=document.createElement("div");t.onclick=function(t){e.querySelector("svg").querySelectorAll("path").forEach((function(t){"currentColor"!==t.getAttribute("fill")&&e.dispatchEvent(new CustomEvent("e-sheet-icon-color-svg-onchange",{bubbles:!1,composed:!0,detail:t.getAttribute("fill")}))}))};var o=document.createElement("div"),n=document.createElement("e-sheet-icon-svg");n.setAttribute("category","select"),n.setAttribute("position","down"),n.style.transition="transform .5s",o.appendChild(n);var l=document.createElement("input");l.className="no-draw-input",l.type="color",l.oninput=function(t){e.setAttribute("color",t.target.value),e.dispatchEvent(new CustomEvent("e-sheet-icon-color-svg-onchange",{bubbles:!1,composed:!0,detail:t.target.value}))},o.appendChild(l),o.className="arrow-layout",o.onclick=function(e){n.style.transform="rotate(180deg)",l.click()},document.addEventListener("click",(function(t){e.contains(t.target)||(n.style.transform="rotate(0deg)")})),t.className="e-sheet-cell-svg-layout e-sheet-svg-20-20","font-color"===this.category?t.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20" data-spm-anchor-id=""><defs><clipPath id="master_svg0_23880_31533"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_23880_31533)"><path fill="#000000" d="M17 19H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path><path fill="currentColor" fill-opacity="0.14" d="M17 19.5q.621 0 1.06-.44.44-.439.44-1.06t-.44-1.06q-.439-.44-1.06-.44H3q-.621 0-1.06.44-.44.439-.44 1.06t.44 1.06q.439.44 1.06.44h14Zm0-.5H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path><path fill="currentColor" fill-opacity="0.94" d="m12.456 11 1.584 3.697a.5.5 0 0 0 .92-.394l-1.715-4-2.785-6.5a.5.5 0 0 0-.92 0l-2.785 6.5-1.714 4a.5.5 0 0 0 .919.394L7.544 11h4.912Zm-.429-1H7.973L10 5.27 12.027 10Z"></path></g></svg>':"bg-color"===this.category&&(t.innerHTML='<svg width="20" height="20" fill="none" viewBox="0 0 20 20"><defs><clipPath id="master_svg0_31391_75878"><rect width="20" height="20" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_31391_75878)"><path fill="currentColor" fill-opacity="0.94" fill-rule="evenodd" d="M9.718 1.843 5.857 5.704h-3.87v1h2.87L3.354 8.207q-.44.44-.44 1.061t.44 1.06l4.95 4.95q.439.44 1.06.44t1.06-.44l6.365-6.364q.44-.439.44-1.06 0-.622-.44-1.061l-4.95-4.95q-.44-.44-1.06-.44-.622 0-1.061.44ZM11.5 6.704H6.271l-2.21 2.21q-.147.147-.147.354t.147.354l.531.531 10.315-.771 1.175-1.175q.146-.146.146-.353t-.146-.354l-4.95-4.95q-.147-.146-.354-.146t-.353.146L7.27 5.704H11.5v1Zm5.088 8.442c.78 0 1.412-.632 1.412-1.411q0-.78-1.412-2.353-1.412 1.573-1.412 2.353c0 .78.633 1.411 1.412 1.411Z"></path><path fill="#F2C150" d="M17 19H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path><path fill="currentColor" fill-opacity="0.14" d="M17 19.5q.621 0 1.06-.44.44-.439.44-1.06t-.44-1.06q-.439-.44-1.06-.44H3q-.621 0-1.06.44-.44.439-.44 1.06t.44 1.06q.439.44 1.06.44h14Zm0-.5H3a1 1 0 0 1 0-2h14a1 1 0 1 1 0 2Z"></path></g></svg>'),this.appendChild(t),this.appendChild(o)}},{key:"attributeChangedCallback",value:function(e,t,o){this.color=o,this.querySelector("svg").querySelectorAll("path").forEach((function(e){"currentColor"!==e.getAttribute("fill")&&e.setAttribute("fill",o)}))}}],[{key:"observedAttributes",get:function(){return["color"]}}]),n}();customElements.define("e-sheet-icon-color-svg",z);var X=function(e){r(n,d(HTMLElement));var t=g(n);function n(){var e;o(this,n);for(var l=arguments.length,r=new Array(l),s=0;s<l;s++)r[s]=arguments[s];return i(u(e=t.call.apply(t,[this].concat(r))),"show",!1),i(u(e),"title",""),i(u(e),"content",""),i(u(e),"wrapperDom",void 0),i(u(e),"titleDom",void 0),i(u(e),"contentDom",void 0),i(u(e),"mounted",!1),e}return l(n,[{key:"connectedCallback",value:function(){var e=this;this.show=this.getAttribute("show"),this.title=this.getAttribute("t"),this.content=this.getAttribute("content"),this.className="e-sheet-warn-dialog-tip",this.wrapperDom=document.createElement("div"),this.wrapperDom.className="e-sheet-warn-dialog-wrapper",this.titleDom=document.createElement("div"),this.titleDom.className="e-sheet-warn-dialog-wrapper-title",this.contentDom=document.createElement("div"),this.contentDom.className="e-sheet-warn-dialog-wrapper-content";var t=document.createElement("div");t.className="e-sheet-warn-dialog-tip-close-btn",t.addEventListener("click",(function(t){e.setAttribute("show",!1)})),this.titleDom.innerText=this.title,this.contentDom.innerText=this.content,this.wrapperDom.append(this.titleDom),this.wrapperDom.append(this.contentDom),this.wrapperDom.append(t),this.append(this.wrapperDom),this.mounted=!0}},{key:"showDialog",value:function(){this.style.display="flex"}},{key:"closeDialog",value:function(){this.style.display="none"}},{key:"attributeChangedCallback",value:function(e,t,o){var n=JSON.parse(o);this.show=n,n&&this.mounted?(this.title=this.getAttribute("t"),this.content=this.getAttribute("content"),this.titleDom.innerText=this.title,this.contentDom.innerText=this.content,this.showDialog()):this.closeDialog()}}],[{key:"observedAttributes",get:function(){return["show"]}}]),n}();customElements.define("e-sheet-warn-dialog-tip",X);var F=function(){function e(n){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(o(this,e),i(this,"excelDom",null),i(this,"AppExcel",null),"[object HTMLDivElement]"===Object.prototype.toString.call(n)?this.excelDom=n:this.excelDom=document.querySelector(n),!this.excelDom)throw new Error("the selector is error");return this.excelDom.style.position="relative",l=t({init:!0,width:1200,height:800},l),this.init(l,r)}return l(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.AppExcel=new w(this.excelDom,e,{ContentComponent:x,HeaderComponent:S,SideComponent:k,WholeComponent:b},t({SettingPlugin:L,ScrollPlugin:D,InputPlugin:M,DragPlugin:A,SelectPlugin:I,ContextmenuPlugin:B,BookPlugin:T,WebsocketPlugin:R},o)),this.AppExcel}},{key:"installXlsxData",value:function(e){this.AppExcel.installXlsxData(e)}}]),e}();export{F as default};
